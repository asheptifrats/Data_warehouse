[0m20:11:37.212637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C67EEEE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6A948550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6A948410>]}


============================== 20:11:37.221183 | 8510c5ba-f5cf-44f9-b466-01d020eb9128 ==============================
[0m20:11:37.221183 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:11:37.222989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:11:37.224320 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\acer\PycharmProjects\pythonProject3\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m20:11:37.226387 [debug] [MainThread]: Command `dbt run` failed at 20:11:37.226102 after 0.26 seconds
[0m20:11:37.227012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6AA91A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6A8BB1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6A8F6BE0>]}
[0m20:11:37.227650 [debug] [MainThread]: Flushing usage events
[0m20:12:14.626773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3DD7B6E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E0218550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E0218410>]}


============================== 20:12:14.634699 | b1d42315-7f79-40ea-a838-774b7432b513 ==============================
[0m20:12:14.634699 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:12:14.635855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'log_path': 'logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:12:14.636718 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\acer\PycharmProjects\pythonProject3\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m20:12:14.638378 [debug] [MainThread]: Command `dbt seed` failed at 20:12:14.638086 after 0.20 seconds
[0m20:12:14.639268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E0361A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E018B1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E01C6BE0>]}
[0m20:12:14.639882 [debug] [MainThread]: Flushing usage events
[0m20:19:49.160205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008192EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020084388550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020084388410>]}


============================== 20:19:49.167273 | dc9aa175-86b3-4353-8e37-25a451307c64 ==============================
[0m20:19:49.167273 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:19:49.168964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:19:49.715443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc9aa175-86b3-4353-8e37-25a451307c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020084700510>]}
[0m20:19:49.792956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc9aa175-86b3-4353-8e37-25a451307c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020084337F00>]}
[0m20:19:49.805848 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:19:49.821148 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:19:49.822921 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:19:49.823641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dc9aa175-86b3-4353-8e37-25a451307c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200843AB850>]}
[0m20:19:51.479533 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.assignment_4
- models.assignment_4.staging
[0m20:19:51.486890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc9aa175-86b3-4353-8e37-25a451307c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008452FB60>]}
[0m20:19:51.647628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc9aa175-86b3-4353-8e37-25a451307c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020085952C10>]}
[0m20:19:51.648342 [info ] [MainThread]: Found 5 seeds, 421 macros
[0m20:19:51.648992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc9aa175-86b3-4353-8e37-25a451307c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200857DD980>]}
[0m20:19:51.652794 [info ] [MainThread]: 
[0m20:19:51.654004 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:19:51.655167 [debug] [MainThread]: Command end result
[0m20:19:51.763712 [debug] [MainThread]: Command `dbt run` succeeded at 20:19:51.763442 after 2.84 seconds
[0m20:19:51.764309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200842EB290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020084376E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200859FDB20>]}
[0m20:19:51.764817 [debug] [MainThread]: Flushing usage events
[0m20:20:12.524350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F393F56E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3969C8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3969C8410>]}


============================== 20:20:12.530882 | 39097d6d-06dc-4242-957e-79d9f73be0ce ==============================
[0m20:20:12.530882 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:20:12.532184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:20:12.855181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39097d6d-06dc-4242-957e-79d9f73be0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F397D6C510>]}
[0m20:20:12.929500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39097d6d-06dc-4242-957e-79d9f73be0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F396973F00>]}
[0m20:20:12.936485 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:20:12.948908 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:20:13.115925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:20:13.116466 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:20:13.125663 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.assignment_4
- models.assignment_4.staging
[0m20:20:13.151883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39097d6d-06dc-4242-957e-79d9f73be0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3969EB150>]}
[0m20:20:13.259954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39097d6d-06dc-4242-957e-79d9f73be0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F397EB0320>]}
[0m20:20:13.260674 [info ] [MainThread]: Found 5 seeds, 421 macros
[0m20:20:13.261357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39097d6d-06dc-4242-957e-79d9f73be0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F397E1B5B0>]}
[0m20:20:13.264718 [info ] [MainThread]: 
[0m20:20:13.266576 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:20:13.274823 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:20:13.871475 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:20:13.872031 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:20:13.872435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:13.941366 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m20:20:13.945018 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:20:13.949803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:20:13.950976 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:20:13.960233 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:20:13.960784 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:20:13.961189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:13.975796 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:20:13.977732 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:20:13.978183 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:20:13.978854 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:20:13.979259 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:20:13.979634 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:20:13.984117 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:20:13.985517 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:20:13.985941 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:20:13.986327 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:20:13.986995 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:20:13.987415 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:20:13.993014 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:20:14.000368 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:20:14.000893 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:20:14.001267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:14.014728 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:20:14.015296 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:20:14.015741 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:20:14.092654 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m20:20:14.094473 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:20:14.102911 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:20:14.103554 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:20:14.108083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39097d6d-06dc-4242-957e-79d9f73be0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3981529C0>]}
[0m20:20:14.109183 [debug] [MainThread]: Using duckdb connection "master"
[0m20:20:14.109726 [debug] [MainThread]: On master: BEGIN
[0m20:20:14.110113 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:14.121569 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m20:20:14.122120 [debug] [MainThread]: On master: COMMIT
[0m20:20:14.122504 [debug] [MainThread]: Using duckdb connection "master"
[0m20:20:14.122878 [debug] [MainThread]: On master: COMMIT
[0m20:20:14.123502 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:20:14.123925 [debug] [MainThread]: On master: Close
[0m20:20:14.127101 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:20:14.127941 [info ] [MainThread]: 
[0m20:20:14.135149 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m20:20:14.135942 [info ] [Thread-1 (]: 1 of 5 START seed file main.customers .......................................... [RUN]
[0m20:20:14.136934 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m20:20:14.137589 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m20:20:14.138356 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m20:20:14.524242 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:20:14.524877 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m20:20:14.525338 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:20:14.537269 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m20:20:14.537888 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:20:14.538366 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */

    create table "assignment_4"."main"."customers" ("Customer.ID" text,"Customer.Name" text,"Segment" text)
  
[0m20:20:14.547483 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:20:14.565901 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:20:14.566538 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:20:14.649232 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m20:20:14.657491 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m20:20:14.688110 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:20:14.688735 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:20:14.689252 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:20:14.708079 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m20:20:14.711061 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m20:20:14.772810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39097d6d-06dc-4242-957e-79d9f73be0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3982BCE90>]}
[0m20:20:14.773589 [info ] [Thread-1 (]: 1 of 5 OK loaded seed file main.customers ...................................... [[32mINSERT 51290[0m in 0.63s]
[0m20:20:14.774653 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m20:20:14.775289 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m20:20:14.776156 [info ] [Thread-1 (]: 2 of 5 START seed file main.locations .......................................... [RUN]
[0m20:20:14.777176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m20:20:14.777717 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m20:20:14.778174 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m20:20:15.260733 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:20:15.261390 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m20:20:15.261866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:15.312656 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m20:20:15.313280 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:20:15.313761 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */

    create table "assignment_4"."main"."locations" ("City" text,"State" text,"Region" text,"Country" text,"Order.ID" text)
  
[0m20:20:15.314748 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:20:15.316567 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:20:15.317210 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:20:15.411332 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m20:20:15.412347 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m20:20:15.416710 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:20:15.417424 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:20:15.417900 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:20:15.444930 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m20:20:15.446445 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m20:20:15.541884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39097d6d-06dc-4242-957e-79d9f73be0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F397F75860>]}
[0m20:20:15.542716 [info ] [Thread-1 (]: 2 of 5 OK loaded seed file main.locations ...................................... [[32mINSERT 51290[0m in 0.76s]
[0m20:20:15.544215 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m20:20:15.544920 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m20:20:15.546060 [info ] [Thread-1 (]: 3 of 5 START seed file main.orders ............................................. [RUN]
[0m20:20:15.547273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m20:20:15.548192 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m20:20:15.549118 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m20:20:19.497093 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:20:19.497739 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m20:20:19.498237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:19.511155 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:20:19.511779 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:20:19.512342 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */

    create table "assignment_4"."main"."orders" ("Order.ID" text,"Customer.ID" text,"Product.ID" text,"Order.Date" text,"Order.Priority" text,"Quantity" integer,"Discount" float8,"Sales" integer,"Profit" float8,"Market" text,"Market2" text,"weeknum" integer,"Year" integer)
  
[0m20:20:19.514759 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:20:19.517052 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:20:19.517662 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:20:19.958433 [debug] [Thread-1 (]: SQL status: OK in 0.440 seconds
[0m20:20:19.959433 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m20:20:19.962808 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:20:19.963444 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:20:19.963915 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:20:20.036780 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m20:20:20.038732 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m20:20:20.173343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39097d6d-06dc-4242-957e-79d9f73be0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3982107D0>]}
[0m20:20:20.174162 [info ] [Thread-1 (]: 3 of 5 OK loaded seed file main.orders ......................................... [[32mINSERT 51290[0m in 4.63s]
[0m20:20:20.175767 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m20:20:20.176793 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m20:20:20.177866 [info ] [Thread-1 (]: 4 of 5 START seed file main.products ........................................... [RUN]
[0m20:20:20.179120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m20:20:20.179755 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m20:20:20.180235 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m20:20:20.752323 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:20:20.753315 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m20:20:20.754246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:20.767730 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:20:20.768750 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:20:20.769431 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */

    create table "assignment_4"."main"."products" ("Product.ID" text,"Product.Name" text,"Category" text,"Sub.Category" text)
  
[0m20:20:20.770464 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:20:20.772291 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:20:20.772879 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:20:20.857701 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m20:20:20.858691 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m20:20:20.862312 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:20:20.862912 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:20:20.863375 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:20:20.925741 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m20:20:20.927746 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m20:20:21.014066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39097d6d-06dc-4242-957e-79d9f73be0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F397DF7550>]}
[0m20:20:21.014891 [info ] [Thread-1 (]: 4 of 5 OK loaded seed file main.products ....................................... [[32mINSERT 51290[0m in 0.84s]
[0m20:20:21.016307 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m20:20:21.016958 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m20:20:21.017744 [info ] [Thread-1 (]: 5 of 5 START seed file main.shipping ........................................... [RUN]
[0m20:20:21.018925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m20:20:21.019749 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m20:20:21.020237 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m20:20:22.050621 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:20:22.051258 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m20:20:22.051724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:22.064959 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:20:22.065582 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:20:22.066056 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */

    create table "assignment_4"."main"."shipping" ("Order.ID" text,"Ship.Date" text,"Ship.Mode" text,"Shipping.Cost" float8)
  
[0m20:20:22.066997 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.068704 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:20:22.069257 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:20:22.404025 [debug] [Thread-1 (]: SQL status: OK in 0.334 seconds
[0m20:20:22.405021 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m20:20:22.444929 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:20:22.445538 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:20:22.445984 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:20:22.463714 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m20:20:22.465128 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m20:20:22.537147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39097d6d-06dc-4242-957e-79d9f73be0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F396A2FE00>]}
[0m20:20:22.538360 [info ] [Thread-1 (]: 5 of 5 OK loaded seed file main.shipping ....................................... [[32mINSERT 51290[0m in 1.52s]
[0m20:20:22.539561 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m20:20:22.541739 [debug] [MainThread]: Using duckdb connection "master"
[0m20:20:22.542273 [debug] [MainThread]: On master: BEGIN
[0m20:20:22.542649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:20:22.557602 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m20:20:22.558173 [debug] [MainThread]: On master: COMMIT
[0m20:20:22.558703 [debug] [MainThread]: Using duckdb connection "master"
[0m20:20:22.559089 [debug] [MainThread]: On master: COMMIT
[0m20:20:22.559799 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:20:22.560372 [debug] [MainThread]: On master: Close
[0m20:20:22.564041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:22.564702 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:20:22.565133 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:20:22.566305 [debug] [MainThread]: Connection 'seed.assignment_4.shipping' was properly closed.
[0m20:20:22.567439 [info ] [MainThread]: 
[0m20:20:22.568288 [info ] [MainThread]: Finished running 5 seeds in 0 hours 0 minutes and 9.30 seconds (9.30s).
[0m20:20:22.571226 [debug] [MainThread]: Command end result
[0m20:20:22.616805 [info ] [MainThread]: 
[0m20:20:22.618393 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:20:22.619237 [info ] [MainThread]: 
[0m20:20:22.620260 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:20:22.621928 [debug] [MainThread]: Command `dbt seed` succeeded at 20:20:22.621692 after 10.26 seconds
[0m20:20:22.622518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3944AB9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F397CCB650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F397CCB2F0>]}
[0m20:20:22.623028 [debug] [MainThread]: Flushing usage events
[0m20:20:48.475158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022463E0EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022466868550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022466868410>]}


============================== 20:20:48.481439 | f4b0eaf6-c22b-4083-9e1f-211c5c4e19cf ==============================
[0m20:20:48.481439 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:20:48.482663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:20:48.791936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4b0eaf6-c22b-4083-9e1f-211c5c4e19cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022467BC0510>]}
[0m20:20:48.864330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4b0eaf6-c22b-4083-9e1f-211c5c4e19cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022466817F00>]}
[0m20:20:48.870277 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:20:48.884791 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:20:49.043367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:20:49.043898 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:20:49.052297 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.assignment_4.staging
- models.assignment_4
[0m20:20:49.080764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4b0eaf6-c22b-4083-9e1f-211c5c4e19cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002246688B150>]}
[0m20:20:49.285549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4b0eaf6-c22b-4083-9e1f-211c5c4e19cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022467E16990>]}
[0m20:20:49.286306 [info ] [MainThread]: Found 5 seeds, 421 macros
[0m20:20:49.286967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4b0eaf6-c22b-4083-9e1f-211c5c4e19cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022467E0BA10>]}
[0m20:20:49.289563 [info ] [MainThread]: 
[0m20:20:49.291484 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:20:49.294564 [debug] [MainThread]: Command end result
[0m20:20:49.331336 [debug] [MainThread]: Command `dbt test` succeeded at 20:20:49.331070 after 1.02 seconds
[0m20:20:49.331936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022467F0FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224667CB290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022467DFEB10>]}
[0m20:20:49.332444 [debug] [MainThread]: Flushing usage events
[0m20:34:14.179204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE48466E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4AED8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4AED8410>]}


============================== 20:34:14.184504 | 8eadeca3-8515-4bec-bb80-8c5039d378f9 ==============================
[0m20:34:14.184504 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:34:14.185360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_orders', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:34:14.498560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8eadeca3-8515-4bec-bb80-8c5039d378f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4B250510>]}
[0m20:34:14.575067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8eadeca3-8515-4bec-bb80-8c5039d378f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4AE87F00>]}
[0m20:34:14.605163 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:34:14.617634 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:34:14.783212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:34:14.783924 [debug] [MainThread]: Partial parsing: added file: assignment_4://models\staging\stg_orders.sql
[0m20:34:15.184613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8eadeca3-8515-4bec-bb80-8c5039d378f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4B0BCD50>]}
[0m20:34:15.311352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8eadeca3-8515-4bec-bb80-8c5039d378f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE49C6DB80>]}
[0m20:34:15.312159 [info ] [MainThread]: Found 5 seeds, 1 model, 421 macros
[0m20:34:15.312775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eadeca3-8515-4bec-bb80-8c5039d378f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4C56A7B0>]}
[0m20:34:15.315513 [info ] [MainThread]: 
[0m20:34:15.316582 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:34:15.318138 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:34:15.452469 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:34:15.453109 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:34:15.453671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:15.472480 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m20:34:15.474692 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:34:15.478422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:34:15.479186 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:34:15.489789 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:34:15.490354 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:34:15.490759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:15.505970 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m20:34:15.507998 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:34:15.508654 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:34:15.509835 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:34:15.510347 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:34:15.510743 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:34:15.511516 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:34:15.512747 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:34:15.513201 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:34:15.513586 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:34:15.514260 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:34:15.514714 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:34:15.526526 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:34:15.535566 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:34:15.536209 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:34:15.536682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:15.553437 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:34:15.553983 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:34:15.554399 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:34:15.658266 [debug] [ThreadPool]: SQL status: OK in 0.103 seconds
[0m20:34:15.660839 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:34:15.663167 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:34:15.663670 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:34:15.671308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eadeca3-8515-4bec-bb80-8c5039d378f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4C80A9C0>]}
[0m20:34:15.672255 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:15.672869 [debug] [MainThread]: On master: BEGIN
[0m20:34:15.673307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:34:15.687829 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m20:34:15.688533 [debug] [MainThread]: On master: COMMIT
[0m20:34:15.688996 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:15.689378 [debug] [MainThread]: On master: COMMIT
[0m20:34:15.690093 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:34:15.690507 [debug] [MainThread]: On master: Close
[0m20:34:15.694022 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:34:15.694861 [info ] [MainThread]: 
[0m20:34:15.699575 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m20:34:15.700561 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_orders .................................... [RUN]
[0m20:34:15.702752 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.stg_orders'
[0m20:34:15.703392 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m20:34:15.715793 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m20:34:15.719372 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m20:34:15.782826 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m20:34:15.786887 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:34:15.787610 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m20:34:15.788161 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:34:15.802268 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:34:15.802891 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:34:15.803408 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    WITH raw_orders AS (
    SELECT
        "Order.ID" AS order_id,
        "Customer.ID" AS customer_id,
        "Product.ID" AS product_id,
        CAST("Order.Date" AS DATE) AS order_date,
        "Order.Priority" AS order_priority,
        CAST("Quantity" AS INTEGER) AS quantity,
        CAST("Discount" AS FLOAT) AS discount,
        CAST("Sales" AS FLOAT) AS sales,
        CAST("Profit" AS FLOAT) AS profit,
        "Market" AS market,
        "Market2" AS region,
        CAST("weeknum" AS INTEGER) AS weeknum,
        CAST("Year" AS INTEGER) AS year
    FROM "assignment_4"."main"."orders"
)

SELECT * FROM raw_orders;
  );

[0m20:34:15.815307 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    WITH raw_orders AS (
    SELECT
        "Order.ID" AS order_id,
        "Customer.ID" AS customer_id,
        "Product.ID" AS product_id,
        CAST("Order.Date" AS DATE) AS order_date,
        "Order.Priority" AS order_priority,
        CAST("Quantity" AS INTEGER) AS quantity,
        CAST("Discount" AS FLOAT) AS discount,
        CAST("Sales" AS FLOAT) AS sales,
        CAST("Profit" AS FLOAT) AS profit,
        "Market" AS market,
        "Market2" AS region,
        CAST("weeknum" AS INTEGER) AS weeknum,
        CAST("Year" AS INTEGER) AS year
    FROM "assignment_4"."main"."orders"
)

SELECT * FROM raw_orders;
  );

[0m20:34:15.816159 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:34:15.816835 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: ROLLBACK
[0m20:34:15.863964 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.stg_orders'
[0m20:34:15.864635 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m20:34:15.874091 [debug] [Thread-1 (]: Runtime Error in model stg_orders (models\staging\stg_orders.sql)
  Parser Error: syntax error at or near ";"
[0m20:34:15.876245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eadeca3-8515-4bec-bb80-8c5039d378f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4C636150>]}
[0m20:34:15.877220 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_orders ........................... [[31mERROR[0m in 0.17s]
[0m20:34:15.879028 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m20:34:15.881823 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:15.882361 [debug] [MainThread]: On master: BEGIN
[0m20:34:15.882742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:34:15.895185 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m20:34:15.895743 [debug] [MainThread]: On master: COMMIT
[0m20:34:15.896134 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:15.896515 [debug] [MainThread]: On master: COMMIT
[0m20:34:15.897169 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:34:15.897603 [debug] [MainThread]: On master: Close
[0m20:34:15.900907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:15.901454 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:34:15.901819 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:34:15.902165 [debug] [MainThread]: Connection 'model.assignment_4.stg_orders' was properly closed.
[0m20:34:15.902934 [info ] [MainThread]: 
[0m20:34:15.903513 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m20:34:15.904593 [debug] [MainThread]: Command end result
[0m20:34:15.944990 [info ] [MainThread]: 
[0m20:34:15.946087 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:34:15.947296 [info ] [MainThread]: 
[0m20:34:15.948533 [error] [MainThread]:   Runtime Error in model stg_orders (models\staging\stg_orders.sql)
  Parser Error: syntax error at or near ";"
[0m20:34:15.949493 [info ] [MainThread]: 
[0m20:34:15.950207 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:34:15.951865 [debug] [MainThread]: Command `dbt run` failed at 20:34:15.951622 after 2.04 seconds
[0m20:34:15.952432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4C56FAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4C996DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4C996E90>]}
[0m20:34:15.952924 [debug] [MainThread]: Flushing usage events
[0m20:35:47.425486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A42B6E2E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A42E148550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A42E148410>]}


============================== 20:35:47.431672 | 5d871d46-092a-428a-b7d6-e826473d5845 ==============================
[0m20:35:47.431672 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:35:47.432544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select str_orders', 'send_anonymous_usage_stats': 'True'}
[0m20:35:47.738580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d871d46-092a-428a-b7d6-e826473d5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A42F4C0510>]}
[0m20:35:47.814428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d871d46-092a-428a-b7d6-e826473d5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A42E0F7F00>]}
[0m20:35:47.820302 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:35:47.832444 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:35:48.065719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:35:48.066717 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\staging\stg_orders.sql
[0m20:35:48.385726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d871d46-092a-428a-b7d6-e826473d5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A42E330750>]}
[0m20:35:48.508693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d871d46-092a-428a-b7d6-e826473d5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A42E2EFF20>]}
[0m20:35:48.509460 [info ] [MainThread]: Found 5 seeds, 1 model, 421 macros
[0m20:35:48.510062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d871d46-092a-428a-b7d6-e826473d5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A42F80DEF0>]}
[0m20:35:48.510846 [warn ] [MainThread]: The selection criterion 'str_orders' does not match any enabled nodes
[0m20:35:48.513820 [info ] [MainThread]: 
[0m20:35:48.514493 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:35:48.515272 [debug] [MainThread]: Command end result
[0m20:35:48.555037 [debug] [MainThread]: Command `dbt run` succeeded at 20:35:48.554679 after 1.39 seconds
[0m20:35:48.555830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A42F7AFEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A42E0AB290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A42F82C410>]}
[0m20:35:48.556617 [debug] [MainThread]: Flushing usage events
[0m20:36:24.092383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B963ACEE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B966538550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B966538410>]}


============================== 20:36:24.099823 | efc1cc09-94c3-446e-b732-8c5b5aed1af6 ==============================
[0m20:36:24.099823 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:36:24.101143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_orders', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:36:24.412889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efc1cc09-94c3-446e-b732-8c5b5aed1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B967890510>]}
[0m20:36:24.488339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efc1cc09-94c3-446e-b732-8c5b5aed1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9664E7F00>]}
[0m20:36:24.494184 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:36:24.506366 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:36:24.699643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:36:24.700452 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:36:24.751531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efc1cc09-94c3-446e-b732-8c5b5aed1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96671CF50>]}
[0m20:36:24.881641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efc1cc09-94c3-446e-b732-8c5b5aed1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9666DFD40>]}
[0m20:36:24.882407 [info ] [MainThread]: Found 5 seeds, 1 model, 421 macros
[0m20:36:24.883004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efc1cc09-94c3-446e-b732-8c5b5aed1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96677CE50>]}
[0m20:36:24.884997 [info ] [MainThread]: 
[0m20:36:24.885864 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:36:24.887138 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:36:25.020318 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:36:25.021323 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:36:25.022113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:25.038685 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:36:25.040603 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:36:25.044385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:36:25.045142 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:36:25.054070 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:36:25.054634 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:36:25.055033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:25.068397 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:36:25.070291 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:36:25.070776 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:36:25.071479 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:36:25.071888 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:36:25.072273 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:36:25.072987 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:36:25.074182 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:36:25.074598 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:36:25.074979 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:36:25.075631 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:36:25.076058 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:36:25.086504 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:36:25.095088 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:36:25.096440 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:36:25.097598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:25.112093 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:36:25.112644 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:36:25.113071 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:36:25.193342 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m20:36:25.195362 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:36:25.197418 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:36:25.197905 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:36:25.204430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efc1cc09-94c3-446e-b732-8c5b5aed1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B967C47930>]}
[0m20:36:25.205072 [debug] [MainThread]: Using duckdb connection "master"
[0m20:36:25.205521 [debug] [MainThread]: On master: BEGIN
[0m20:36:25.206149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:36:25.219230 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:36:25.219782 [debug] [MainThread]: On master: COMMIT
[0m20:36:25.220276 [debug] [MainThread]: Using duckdb connection "master"
[0m20:36:25.220659 [debug] [MainThread]: On master: COMMIT
[0m20:36:25.221296 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:36:25.221718 [debug] [MainThread]: On master: Close
[0m20:36:25.225012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:25.225744 [info ] [MainThread]: 
[0m20:36:25.229701 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m20:36:25.231706 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_orders .................................... [RUN]
[0m20:36:25.232887 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.stg_orders'
[0m20:36:25.233618 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m20:36:25.244007 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m20:36:25.245464 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m20:36:25.293129 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m20:36:25.294897 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:36:25.295547 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m20:36:25.296008 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:36:25.309258 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:36:25.309864 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:36:25.310364 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m20:36:25.350700 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m20:36:25.359462 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:36:25.360068 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:36:25.365729 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:36:25.386917 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:36:25.387533 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:36:25.388019 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:36:25.395052 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:36:25.402664 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:36:25.403274 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m20:36:25.407151 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:36:25.410545 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m20:36:25.434520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efc1cc09-94c3-446e-b732-8c5b5aed1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B967CCD9D0>]}
[0m20:36:25.435479 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.20s]
[0m20:36:25.436607 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m20:36:25.438497 [debug] [MainThread]: Using duckdb connection "master"
[0m20:36:25.439009 [debug] [MainThread]: On master: BEGIN
[0m20:36:25.439393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:36:25.453822 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m20:36:25.454392 [debug] [MainThread]: On master: COMMIT
[0m20:36:25.454784 [debug] [MainThread]: Using duckdb connection "master"
[0m20:36:25.455161 [debug] [MainThread]: On master: COMMIT
[0m20:36:25.455790 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:36:25.456465 [debug] [MainThread]: On master: Close
[0m20:36:25.460349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:25.460893 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:36:25.461242 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:36:25.461576 [debug] [MainThread]: Connection 'model.assignment_4.stg_orders' was properly closed.
[0m20:36:25.462023 [info ] [MainThread]: 
[0m20:36:25.462685 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m20:36:25.463815 [debug] [MainThread]: Command end result
[0m20:36:25.504060 [info ] [MainThread]: 
[0m20:36:25.505369 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:25.506495 [info ] [MainThread]: 
[0m20:36:25.507275 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:36:25.508634 [debug] [MainThread]: Command `dbt run` succeeded at 20:36:25.508459 after 1.57 seconds
[0m20:36:25.509123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B967A8EDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B967E72F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B967E72B70>]}
[0m20:36:25.509593 [debug] [MainThread]: Flushing usage events
[0m20:40:12.343838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297D716F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297D6E1F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297D9BC07D0>]}


============================== 20:40:12.349164 | b48ee5b5-8f27-43d5-9249-ebd021158a2f ==============================
[0m20:40:12.349164 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:40:12.349938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m20:40:12.688387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b48ee5b5-8f27-43d5-9249-ebd021158a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297DAFC8510>]}
[0m20:40:12.776738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b48ee5b5-8f27-43d5-9249-ebd021158a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297D9B97F00>]}
[0m20:40:12.783791 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:40:12.798359 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:40:13.022422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:40:13.023176 [debug] [MainThread]: Partial parsing: added file: assignment_4://models\staging\stg_products.sql
[0m20:40:13.347498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b48ee5b5-8f27-43d5-9249-ebd021158a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297D9DCC750>]}
[0m20:40:13.537019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b48ee5b5-8f27-43d5-9249-ebd021158a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297D9D8FD40>]}
[0m20:40:13.537775 [info ] [MainThread]: Found 5 seeds, 2 models, 421 macros
[0m20:40:13.541366 [info ] [MainThread]: 
[0m20:40:13.542213 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:40:13.549668 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:40:13.703130 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:40:13.703718 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:40:13.704200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:13.720867 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:40:13.722763 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:40:13.726618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:40:13.727364 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:40:13.736398 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:40:13.736955 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:40:13.737353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:13.751253 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:40:13.753216 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:40:13.753711 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:40:13.754408 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:40:13.754817 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:40:13.755198 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:40:13.755917 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:40:13.757183 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:40:13.757615 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:40:13.758024 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:40:13.758866 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:40:13.759323 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:40:13.764423 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:40:13.773613 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:40:13.774246 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:40:13.774672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:13.789825 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m20:40:13.790370 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:40:13.790787 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:40:13.886827 [debug] [ThreadPool]: SQL status: OK in 0.096 seconds
[0m20:40:13.888901 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:40:13.890948 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:40:13.891448 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:40:13.899182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b48ee5b5-8f27-43d5-9249-ebd021158a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297DB46F850>]}
[0m20:40:13.900177 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:13.900872 [debug] [MainThread]: On master: BEGIN
[0m20:40:13.901375 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:13.914513 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:40:13.915322 [debug] [MainThread]: On master: COMMIT
[0m20:40:13.915718 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:13.916091 [debug] [MainThread]: On master: COMMIT
[0m20:40:13.916717 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:40:13.917131 [debug] [MainThread]: On master: Close
[0m20:40:13.920511 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:40:13.921105 [info ] [MainThread]: 
[0m20:40:13.925352 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m20:40:13.926472 [info ] [Thread-1 (]: 1 of 7 START seed file main.customers .......................................... [RUN]
[0m20:40:13.927223 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m20:40:13.927699 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m20:40:13.928161 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m20:40:14.316429 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:40:14.317035 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m20:40:14.317485 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:40:14.330977 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:40:14.331690 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:40:14.332165 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m20:40:14.381765 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m20:40:14.403520 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:40:14.404150 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:40:14.482740 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m20:40:14.491159 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m20:40:14.514122 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:40:14.514748 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:40:14.515217 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:40:14.551783 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m20:40:14.565661 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m20:40:14.662923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48ee5b5-8f27-43d5-9249-ebd021158a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297DB815300>]}
[0m20:40:14.663773 [info ] [Thread-1 (]: 1 of 7 OK loaded seed file main.customers ...................................... [[32mINSERT 51290[0m in 0.73s]
[0m20:40:14.665377 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m20:40:14.666038 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m20:40:14.666832 [info ] [Thread-1 (]: 2 of 7 START seed file main.locations .......................................... [RUN]
[0m20:40:14.667551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m20:40:14.668042 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m20:40:14.668631 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m20:40:15.186653 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:40:15.187254 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m20:40:15.187714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:15.200922 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:40:15.201545 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:40:15.202019 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m20:40:15.203806 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:40:15.205637 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:40:15.206170 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:40:15.305593 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m20:40:15.306650 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m20:40:15.310617 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:40:15.311246 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:40:15.311717 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:40:15.402173 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m20:40:15.404068 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m20:40:15.563807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48ee5b5-8f27-43d5-9249-ebd021158a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297DB16D3D0>]}
[0m20:40:15.564614 [info ] [Thread-1 (]: 2 of 7 OK loaded seed file main.locations ...................................... [[32mINSERT 51290[0m in 0.90s]
[0m20:40:15.565494 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m20:40:15.566044 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m20:40:15.566831 [info ] [Thread-1 (]: 3 of 7 START seed file main.orders ............................................. [RUN]
[0m20:40:15.567492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m20:40:15.567975 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m20:40:15.568445 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m20:40:18.766845 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:40:18.767459 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m20:40:18.767915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:18.780890 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:40:18.781498 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:40:18.781981 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m20:40:18.784383 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:40:18.786353 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:40:18.787002 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:40:19.259704 [debug] [Thread-1 (]: SQL status: OK in 0.472 seconds
[0m20:40:19.260784 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m20:40:19.263757 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:40:19.264426 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:40:19.264894 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:40:19.385099 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m20:40:19.386532 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m20:40:19.640120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48ee5b5-8f27-43d5-9249-ebd021158a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297DB385A70>]}
[0m20:40:19.641026 [info ] [Thread-1 (]: 3 of 7 OK loaded seed file main.orders ......................................... [[32mINSERT 51290[0m in 4.07s]
[0m20:40:19.642049 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m20:40:19.642620 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m20:40:19.643491 [info ] [Thread-1 (]: 4 of 7 START seed file main.products ........................................... [RUN]
[0m20:40:19.644607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m20:40:19.645137 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m20:40:19.645709 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m20:40:20.224660 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:40:20.225276 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m20:40:20.225731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:20.240210 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:40:20.240965 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:40:20.241482 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m20:40:20.243384 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:40:20.245586 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:40:20.246214 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:40:20.330067 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m20:40:20.331082 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m20:40:20.334659 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:40:20.335322 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:40:20.335797 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:40:20.419658 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m20:40:20.421302 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m20:40:20.607635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48ee5b5-8f27-43d5-9249-ebd021158a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297DAF95630>]}
[0m20:40:20.608620 [info ] [Thread-1 (]: 4 of 7 OK loaded seed file main.products ....................................... [[32mINSERT 51290[0m in 0.96s]
[0m20:40:20.609614 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m20:40:20.610175 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m20:40:20.610921 [info ] [Thread-1 (]: 5 of 7 START seed file main.shipping ........................................... [RUN]
[0m20:40:20.611861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m20:40:20.612383 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m20:40:20.612857 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m20:40:21.538469 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:40:21.539091 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m20:40:21.539555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:21.552579 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:40:21.553217 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:40:21.553693 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m20:40:21.555472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:40:21.557391 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:40:21.557941 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:40:21.809809 [debug] [Thread-1 (]: SQL status: OK in 0.251 seconds
[0m20:40:21.810938 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m20:40:21.815284 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:40:21.816143 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:40:21.817565 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:40:21.896349 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m20:40:21.898001 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m20:40:22.013924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48ee5b5-8f27-43d5-9249-ebd021158a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297E1AEE450>]}
[0m20:40:22.014726 [info ] [Thread-1 (]: 5 of 7 OK loaded seed file main.shipping ....................................... [[32mINSERT 51290[0m in 1.40s]
[0m20:40:22.015600 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m20:40:22.016166 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m20:40:22.017174 [info ] [Thread-1 (]: 6 of 7 START sql view model main.stg_orders .................................... [RUN]
[0m20:40:22.018300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_orders)
[0m20:40:22.019141 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m20:40:22.029739 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m20:40:22.031210 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m20:40:22.074469 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m20:40:22.075972 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:40:22.076588 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m20:40:22.077052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:22.091719 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m20:40:22.092376 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:40:22.092900 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m20:40:22.094159 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:40:22.106455 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:40:22.107069 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:40:22.108039 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:40:22.111749 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:40:22.112308 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:40:22.113237 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:40:22.118815 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:40:22.119414 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:40:22.119885 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:40:22.135890 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m20:40:22.142757 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:40:22.143366 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m20:40:22.147083 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:40:22.149172 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m20:40:22.167243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48ee5b5-8f27-43d5-9249-ebd021158a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297DB1B4590>]}
[0m20:40:22.168208 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.15s]
[0m20:40:22.169090 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m20:40:22.169652 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m20:40:22.170414 [info ] [Thread-1 (]: 7 of 7 START sql view model main.stg_products .................................. [RUN]
[0m20:40:22.171096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m20:40:22.171598 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m20:40:22.175521 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m20:40:22.177199 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m20:40:22.181898 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m20:40:22.183500 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:40:22.184130 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m20:40:22.184603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:22.198557 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:40:22.199172 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:40:22.199666 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,                -- Renaming column for clarity
    TRIM("Product.Name") AS product_name,      -- Removes extra spaces from product names
    "Category" AS category,                    -- Keeps category as is
    "Sub.Category" AS sub_category             -- Renames subcategory for consistency
FROM "assignment_4"."main"."products"
  );

[0m20:40:22.200812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:40:22.204599 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:40:22.205153 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:40:22.206129 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:40:22.208673 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:40:22.209657 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:40:22.210197 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:40:22.216678 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:40:22.220984 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:40:22.221742 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m20:40:22.222990 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:40:22.225495 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m20:40:22.248176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48ee5b5-8f27-43d5-9249-ebd021158a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297E0AFE030>]}
[0m20:40:22.249316 [info ] [Thread-1 (]: 7 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.08s]
[0m20:40:22.250435 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m20:40:22.252971 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:22.253568 [debug] [MainThread]: On master: BEGIN
[0m20:40:22.254016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:22.268136 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m20:40:22.268798 [debug] [MainThread]: On master: COMMIT
[0m20:40:22.269211 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:22.269611 [debug] [MainThread]: On master: COMMIT
[0m20:40:22.270298 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:40:22.270715 [debug] [MainThread]: On master: Close
[0m20:40:22.274107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:22.274717 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:40:22.275093 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:40:22.275435 [debug] [MainThread]: Connection 'model.assignment_4.stg_products' was properly closed.
[0m20:40:22.275982 [info ] [MainThread]: 
[0m20:40:22.276449 [info ] [MainThread]: Finished running 5 seeds, 2 view models in 0 hours 0 minutes and 8.73 seconds (8.73s).
[0m20:40:22.279053 [debug] [MainThread]: Command end result
[0m20:40:22.335749 [info ] [MainThread]: 
[0m20:40:22.336842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:40:22.337445 [info ] [MainThread]: 
[0m20:40:22.337940 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:40:22.339277 [debug] [MainThread]: Command `dbt build` succeeded at 20:40:22.339089 after 10.26 seconds
[0m20:40:22.339771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297DB796450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297D8940D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297E2B87D10>]}
[0m20:40:22.340371 [debug] [MainThread]: Flushing usage events
[0m20:41:22.444129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A99EFDF0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A99EC7F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A1A207D0>]}


============================== 20:41:22.449348 | 1c1e3b7b-825c-43c1-b79c-ea7a13d11bcf ==============================
[0m20:41:22.449348 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:41:22.450116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:41:22.769508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c1e3b7b-825c-43c1-b79c-ea7a13d11bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A2DFC510>]}
[0m20:41:22.845649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c1e3b7b-825c-43c1-b79c-ea7a13d11bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A19F7F00>]}
[0m20:41:22.851636 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:41:22.864051 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:41:23.055896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:41:23.056689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:41:23.115890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c1e3b7b-825c-43c1-b79c-ea7a13d11bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A1C30F50>]}
[0m20:41:23.270249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c1e3b7b-825c-43c1-b79c-ea7a13d11bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A1983B60>]}
[0m20:41:23.271018 [info ] [MainThread]: Found 5 seeds, 2 models, 421 macros
[0m20:41:23.274190 [info ] [MainThread]: 
[0m20:41:23.275083 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:41:23.282608 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:41:23.410284 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:41:23.410852 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:41:23.411271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:23.427882 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:41:23.430105 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:41:23.433867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:41:23.434656 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:41:23.444289 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:41:23.444848 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:41:23.445340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:23.459101 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:41:23.461007 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:41:23.461511 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:41:23.462243 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:41:23.462652 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:41:23.463041 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:41:23.463771 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:41:23.465042 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:41:23.465477 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:41:23.465859 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:41:23.466651 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:41:23.467110 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:41:23.472299 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:41:23.483962 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:41:23.484587 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:41:23.484970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:23.498425 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:41:23.499154 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:41:23.499948 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:41:23.561874 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m20:41:23.563951 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:41:23.566005 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:41:23.566499 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:41:23.573979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c1e3b7b-825c-43c1-b79c-ea7a13d11bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A316DB70>]}
[0m20:41:23.574660 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:23.575373 [debug] [MainThread]: On master: BEGIN
[0m20:41:23.575857 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:23.588619 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:41:23.589185 [debug] [MainThread]: On master: COMMIT
[0m20:41:23.589578 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:23.589953 [debug] [MainThread]: On master: COMMIT
[0m20:41:23.590591 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:41:23.591016 [debug] [MainThread]: On master: Close
[0m20:41:23.594304 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:41:23.594898 [info ] [MainThread]: 
[0m20:41:23.600111 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m20:41:23.600930 [info ] [Thread-1 (]: 1 of 7 START seed file main.customers .......................................... [RUN]
[0m20:41:23.601691 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m20:41:23.602208 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m20:41:23.602710 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m20:41:23.949735 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:41:23.950358 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m20:41:23.950822 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:41:23.964945 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:41:23.965572 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:41:23.966051 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m20:41:23.967986 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:23.986555 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:41:23.987201 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:41:24.051967 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m20:41:24.060490 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m20:41:24.084177 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:41:24.084832 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:41:24.085303 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:41:24.154626 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m20:41:24.157160 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m20:41:24.236578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c1e3b7b-825c-43c1-b79c-ea7a13d11bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A341E340>]}
[0m20:41:24.237430 [info ] [Thread-1 (]: 1 of 7 OK loaded seed file main.customers ...................................... [[32mINSERT 51290[0m in 0.63s]
[0m20:41:24.238637 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m20:41:24.239675 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m20:41:24.240901 [info ] [Thread-1 (]: 2 of 7 START seed file main.locations .......................................... [RUN]
[0m20:41:24.241588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m20:41:24.242076 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m20:41:24.242619 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m20:41:24.697205 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:41:24.697819 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m20:41:24.698269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:24.711698 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:41:24.712334 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:41:24.712817 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m20:41:24.714491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:24.716326 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:41:24.716932 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:41:24.810707 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m20:41:24.811703 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m20:41:24.814687 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:41:24.815361 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:41:24.815833 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:41:24.905450 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m20:41:24.906732 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m20:41:25.037125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c1e3b7b-825c-43c1-b79c-ea7a13d11bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A3221310>]}
[0m20:41:25.038021 [info ] [Thread-1 (]: 2 of 7 OK loaded seed file main.locations ...................................... [[32mINSERT 51290[0m in 0.80s]
[0m20:41:25.039006 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m20:41:25.039588 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m20:41:25.040341 [info ] [Thread-1 (]: 3 of 7 START seed file main.orders ............................................. [RUN]
[0m20:41:25.041028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m20:41:25.041521 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m20:41:25.041994 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m20:41:28.058365 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:41:28.058986 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m20:41:28.059440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:28.072180 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:41:28.072788 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:41:28.073274 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m20:41:28.075269 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:28.077065 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:41:28.077579 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:41:28.459934 [debug] [Thread-1 (]: SQL status: OK in 0.382 seconds
[0m20:41:28.460931 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m20:41:28.464636 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:41:28.465400 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:41:28.466118 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:41:28.583669 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m20:41:28.585519 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m20:41:28.791821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c1e3b7b-825c-43c1-b79c-ea7a13d11bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A30A0F70>]}
[0m20:41:28.792642 [info ] [Thread-1 (]: 3 of 7 OK loaded seed file main.orders ......................................... [[32mINSERT 51290[0m in 3.75s]
[0m20:41:28.793599 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m20:41:28.794169 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m20:41:28.795125 [info ] [Thread-1 (]: 4 of 7 START seed file main.products ........................................... [RUN]
[0m20:41:28.796227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m20:41:28.796770 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m20:41:28.797248 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m20:41:29.347093 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:41:29.347952 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m20:41:29.348632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:29.362043 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:41:29.362670 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:41:29.363143 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m20:41:29.364936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:29.366698 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:41:29.367229 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:41:29.449004 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m20:41:29.450007 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m20:41:29.453400 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:41:29.453998 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:41:29.454464 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:41:29.537810 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m20:41:29.539546 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m20:41:29.643335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c1e3b7b-825c-43c1-b79c-ea7a13d11bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A1B33930>]}
[0m20:41:29.644161 [info ] [Thread-1 (]: 4 of 7 OK loaded seed file main.products ....................................... [[32mINSERT 51290[0m in 0.85s]
[0m20:41:29.645030 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m20:41:29.645586 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m20:41:29.646368 [info ] [Thread-1 (]: 5 of 7 START seed file main.shipping ........................................... [RUN]
[0m20:41:29.647318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m20:41:29.648197 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m20:41:29.648750 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m20:41:30.542777 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:41:30.543687 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m20:41:30.544209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:30.557247 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:41:30.557858 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:41:30.558490 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m20:41:30.560575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:30.562389 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:41:30.562939 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:41:30.856407 [debug] [Thread-1 (]: SQL status: OK in 0.293 seconds
[0m20:41:30.857405 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m20:41:30.860816 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:41:30.861417 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:41:30.861881 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:41:30.935756 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m20:41:30.937126 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m20:41:31.020339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c1e3b7b-825c-43c1-b79c-ea7a13d11bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A9E166D0>]}
[0m20:41:31.021286 [info ] [Thread-1 (]: 5 of 7 OK loaded seed file main.shipping ....................................... [[32mINSERT 51290[0m in 1.37s]
[0m20:41:31.022270 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m20:41:31.022922 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m20:41:31.023663 [info ] [Thread-1 (]: 6 of 7 START sql view model main.stg_orders .................................... [RUN]
[0m20:41:31.025894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_orders)
[0m20:41:31.026482 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m20:41:31.037112 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m20:41:31.038930 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m20:41:31.082506 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m20:41:31.084170 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:41:31.085121 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m20:41:31.086172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:31.101223 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m20:41:31.102104 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:41:31.102621 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m20:41:31.103883 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:31.113218 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:41:31.113858 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:41:31.114861 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:31.118715 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:41:31.119287 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:41:31.120265 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:31.125468 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:41:31.126061 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:41:31.126535 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:41:31.168174 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m20:41:31.175965 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:41:31.176575 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m20:41:31.180259 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:41:31.182540 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m20:41:31.202146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c1e3b7b-825c-43c1-b79c-ea7a13d11bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A35972A0>]}
[0m20:41:31.203145 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.18s]
[0m20:41:31.204164 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m20:41:31.204734 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m20:41:31.205508 [info ] [Thread-1 (]: 7 of 7 START sql view model main.stg_products .................................. [RUN]
[0m20:41:31.206188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m20:41:31.206677 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m20:41:31.210948 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m20:41:31.212721 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m20:41:31.217362 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m20:41:31.218946 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:41:31.219890 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m20:41:31.220385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:31.237419 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m20:41:31.238095 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:41:31.238765 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,                -- Renaming column for clarity
    TRIM("Product.Name") AS product_name,      -- Removes extra spaces from product names
    "Category" AS category,                    -- Keeps category as is
    "Sub.Category" AS sub_category             -- Renames subcategory for consistency
FROM "assignment_4"."main"."products"
  );

[0m20:41:31.240093 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:31.244829 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:41:31.245502 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:41:31.246778 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:31.252766 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:41:31.253484 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:41:31.254596 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:31.256778 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:41:31.257505 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:41:31.258117 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:41:31.262981 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:41:31.268050 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:41:31.268667 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m20:41:31.272634 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:41:31.275407 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m20:41:31.293267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c1e3b7b-825c-43c1-b79c-ea7a13d11bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A55AA4B0>]}
[0m20:41:31.294220 [info ] [Thread-1 (]: 7 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.09s]
[0m20:41:31.295173 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m20:41:31.297062 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:31.297589 [debug] [MainThread]: On master: BEGIN
[0m20:41:31.298108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:41:31.311005 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:41:31.311582 [debug] [MainThread]: On master: COMMIT
[0m20:41:31.312023 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:31.312421 [debug] [MainThread]: On master: COMMIT
[0m20:41:31.313111 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:41:31.313539 [debug] [MainThread]: On master: Close
[0m20:41:31.317060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:31.317592 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:41:31.317967 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:41:31.318310 [debug] [MainThread]: Connection 'model.assignment_4.stg_products' was properly closed.
[0m20:41:31.318848 [info ] [MainThread]: 
[0m20:41:31.319321 [info ] [MainThread]: Finished running 5 seeds, 2 view models in 0 hours 0 minutes and 8.04 seconds (8.04s).
[0m20:41:31.321880 [debug] [MainThread]: Command end result
[0m20:41:31.370253 [info ] [MainThread]: 
[0m20:41:31.371399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:31.371993 [info ] [MainThread]: 
[0m20:41:31.372480 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:41:31.373771 [debug] [MainThread]: Command `dbt build` succeeded at 20:41:31.373587 after 9.13 seconds
[0m20:41:31.374321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A31BAD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A0936390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9A55AB230>]}
[0m20:41:31.374820 [debug] [MainThread]: Flushing usage events
[0m20:42:30.218842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D792EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DA398550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DA398410>]}


============================== 20:42:30.224093 | e62b8206-97aa-46d2-98c1-90a24f5f563f ==============================
[0m20:42:30.224093 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:42:30.225310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_products', 'send_anonymous_usage_stats': 'True'}
[0m20:42:30.527868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e62b8206-97aa-46d2-98c1-90a24f5f563f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DB780510>]}
[0m20:42:30.603962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e62b8206-97aa-46d2-98c1-90a24f5f563f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DA343F00>]}
[0m20:42:30.611052 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:42:30.622853 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:42:30.813953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:42:30.814487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:42:30.864969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e62b8206-97aa-46d2-98c1-90a24f5f563f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DA57CF50>]}
[0m20:42:30.994354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e62b8206-97aa-46d2-98c1-90a24f5f563f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DA53FD40>]}
[0m20:42:30.995130 [info ] [MainThread]: Found 5 seeds, 2 models, 421 macros
[0m20:42:30.995723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e62b8206-97aa-46d2-98c1-90a24f5f563f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DA5DCE50>]}
[0m20:42:30.997782 [info ] [MainThread]: 
[0m20:42:30.998738 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:42:31.000005 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:42:31.136904 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:42:31.137470 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:42:31.137974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:31.154304 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:42:31.156278 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:42:31.160450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:42:31.161190 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:42:31.170130 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:42:31.170680 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:42:31.171079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:31.184651 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:42:31.186539 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:42:31.186986 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:42:31.187688 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:42:31.188097 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:42:31.188484 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:42:31.189204 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:42:31.191307 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:42:31.192070 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:42:31.192465 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:42:31.193167 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:42:31.193603 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:42:31.205162 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:42:31.213341 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:42:31.213871 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:42:31.214250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:31.227494 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:42:31.228080 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:42:31.228518 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:42:31.300299 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m20:42:31.302534 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:42:31.304805 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:42:31.305312 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:42:31.312357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e62b8206-97aa-46d2-98c1-90a24f5f563f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DBB3B930>]}
[0m20:42:31.313021 [debug] [MainThread]: Using duckdb connection "master"
[0m20:42:31.313527 [debug] [MainThread]: On master: BEGIN
[0m20:42:31.314152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:42:31.327291 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:42:31.327848 [debug] [MainThread]: On master: COMMIT
[0m20:42:31.328240 [debug] [MainThread]: Using duckdb connection "master"
[0m20:42:31.328613 [debug] [MainThread]: On master: COMMIT
[0m20:42:31.329220 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:42:31.329641 [debug] [MainThread]: On master: Close
[0m20:42:31.333156 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:42:31.334200 [info ] [MainThread]: 
[0m20:42:31.339549 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m20:42:31.340416 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_products .................................. [RUN]
[0m20:42:31.341384 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.stg_products'
[0m20:42:31.341892 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m20:42:31.352361 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m20:42:31.353813 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m20:42:31.401805 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m20:42:31.403311 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:42:31.403929 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m20:42:31.404420 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:42:31.417553 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:42:31.418169 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:42:31.418678 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,                -- Renaming column for clarity
    TRIM("Product.Name") AS product_name,      -- Removes extra spaces from product names
    "Category" AS category,                    -- Keeps category as is
    "Sub.Category" AS sub_category             -- Renames subcategory for consistency
FROM "assignment_4"."main"."products"
  );

[0m20:42:31.419766 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:31.428299 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:42:31.428984 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:42:31.429976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:31.434138 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:42:31.434711 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:42:31.435637 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:31.459804 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:42:31.460435 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:42:31.460944 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:42:31.502596 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m20:42:31.509880 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:42:31.510484 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m20:42:31.514348 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:42:31.517927 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m20:42:31.537398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62b8206-97aa-46d2-98c1-90a24f5f563f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DBBBDA90>]}
[0m20:42:31.538376 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.19s]
[0m20:42:31.539508 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m20:42:31.541476 [debug] [MainThread]: Using duckdb connection "master"
[0m20:42:31.541991 [debug] [MainThread]: On master: BEGIN
[0m20:42:31.542376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:42:31.555057 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:42:31.555602 [debug] [MainThread]: On master: COMMIT
[0m20:42:31.555997 [debug] [MainThread]: Using duckdb connection "master"
[0m20:42:31.556381 [debug] [MainThread]: On master: COMMIT
[0m20:42:31.557016 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:42:31.557440 [debug] [MainThread]: On master: Close
[0m20:42:31.561047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:31.561577 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:42:31.561932 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:42:31.562281 [debug] [MainThread]: Connection 'model.assignment_4.stg_products' was properly closed.
[0m20:42:31.562742 [info ] [MainThread]: 
[0m20:42:31.563553 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m20:42:31.565474 [debug] [MainThread]: Command end result
[0m20:42:31.606431 [info ] [MainThread]: 
[0m20:42:31.607918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:42:31.609376 [info ] [MainThread]: 
[0m20:42:31.610560 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:42:31.612214 [debug] [MainThread]: Command `dbt run` succeeded at 20:42:31.611995 after 1.56 seconds
[0m20:42:31.612738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DB992AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DBD5FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DBD5F9D0>]}
[0m20:42:31.613219 [debug] [MainThread]: Flushing usage events
[0m20:45:26.429333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97AFB30E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97AC5F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97DA007D0>]}


============================== 20:45:26.435217 | 6a17b4ac-198d-4071-9e94-16e69295034c ==============================
[0m20:45:26.435217 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:45:26.436330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:45:26.751751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a17b4ac-198d-4071-9e94-16e69295034c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97DD9C510>]}
[0m20:45:26.831624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a17b4ac-198d-4071-9e94-16e69295034c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97D9D7F00>]}
[0m20:45:26.837547 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:45:26.849379 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:45:27.050686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:45:27.051574 [debug] [MainThread]: Partial parsing: added file: assignment_4://models\staging\stg_shipping.sql
[0m20:45:27.052168 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\staging\stg_products.sql
[0m20:45:27.433610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a17b4ac-198d-4071-9e94-16e69295034c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97DC0D050>]}
[0m20:45:27.574431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a17b4ac-198d-4071-9e94-16e69295034c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97D963B60>]}
[0m20:45:27.575219 [info ] [MainThread]: Found 5 seeds, 3 models, 421 macros
[0m20:45:27.578364 [info ] [MainThread]: 
[0m20:45:27.579172 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:45:27.586623 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:45:27.716931 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:45:27.717563 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:45:27.717999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:27.735842 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:45:27.737826 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:45:27.741724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:45:27.742466 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:45:27.751630 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:45:27.752191 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:45:27.752593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:27.767079 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:45:27.769019 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:45:27.769500 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:45:27.770277 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:45:27.770737 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:45:27.771204 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:45:27.772082 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:45:27.773333 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:45:27.773749 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:45:27.774199 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:45:27.774873 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:45:27.775385 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:45:27.780745 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:45:27.789464 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:45:27.789999 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:45:27.790384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:27.804379 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:45:27.804995 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:45:27.805417 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:45:27.870475 [debug] [ThreadPool]: SQL status: OK in 0.064 seconds
[0m20:45:27.873213 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:45:27.875337 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:45:27.875835 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:45:27.884029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a17b4ac-198d-4071-9e94-16e69295034c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97F28B770>]}
[0m20:45:27.884697 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:27.885246 [debug] [MainThread]: On master: BEGIN
[0m20:45:27.885803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:27.899793 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m20:45:27.900370 [debug] [MainThread]: On master: COMMIT
[0m20:45:27.900832 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:27.901213 [debug] [MainThread]: On master: COMMIT
[0m20:45:27.901861 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:45:27.902285 [debug] [MainThread]: On master: Close
[0m20:45:27.905186 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:45:27.905869 [info ] [MainThread]: 
[0m20:45:27.909598 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m20:45:27.910404 [info ] [Thread-1 (]: 1 of 8 START seed file main.customers .......................................... [RUN]
[0m20:45:27.911173 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m20:45:27.911654 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m20:45:27.913408 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m20:45:28.272168 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:45:28.272794 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m20:45:28.273264 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:45:28.285928 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:45:28.286552 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:45:28.287032 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m20:45:28.289013 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:28.306216 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:45:28.306886 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:45:28.369702 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m20:45:28.378273 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m20:45:28.400725 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:45:28.401438 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:45:28.401924 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:45:28.470595 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m20:45:28.473404 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m20:45:28.566696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a17b4ac-198d-4071-9e94-16e69295034c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97F333790>]}
[0m20:45:28.567661 [info ] [Thread-1 (]: 1 of 8 OK loaded seed file main.customers ...................................... [[32mINSERT 51290[0m in 0.65s]
[0m20:45:28.568585 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m20:45:28.569279 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m20:45:28.570112 [info ] [Thread-1 (]: 2 of 8 START seed file main.locations .......................................... [RUN]
[0m20:45:28.570838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m20:45:28.571337 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m20:45:28.571990 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m20:45:29.040360 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:45:29.041038 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m20:45:29.041502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:29.054092 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m20:45:29.054703 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:45:29.055178 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m20:45:29.056966 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:29.058825 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:45:29.059494 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:45:29.155717 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m20:45:29.156756 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m20:45:29.159723 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:45:29.160325 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:45:29.160790 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:45:29.249183 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m20:45:29.250735 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m20:45:29.440207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a17b4ac-198d-4071-9e94-16e69295034c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97EF913D0>]}
[0m20:45:29.441080 [info ] [Thread-1 (]: 2 of 8 OK loaded seed file main.locations ...................................... [[32mINSERT 51290[0m in 0.87s]
[0m20:45:29.442012 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m20:45:29.442569 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m20:45:29.443390 [info ] [Thread-1 (]: 3 of 8 START seed file main.orders ............................................. [RUN]
[0m20:45:29.444070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m20:45:29.444554 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m20:45:29.445021 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m20:45:32.520636 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:45:32.521350 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m20:45:32.521840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:32.535117 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:45:32.535735 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:45:32.536203 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m20:45:32.538614 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:45:32.540453 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:45:32.540982 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:45:32.886977 [debug] [Thread-1 (]: SQL status: OK in 0.345 seconds
[0m20:45:32.888511 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m20:45:32.891958 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:45:32.892596 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:45:32.893087 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:45:33.005232 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m20:45:33.006877 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m20:45:33.253883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a17b4ac-198d-4071-9e94-16e69295034c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97F19D9C0>]}
[0m20:45:33.254700 [info ] [Thread-1 (]: 3 of 8 OK loaded seed file main.orders ......................................... [[32mINSERT 51290[0m in 3.81s]
[0m20:45:33.255572 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m20:45:33.256127 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m20:45:33.256906 [info ] [Thread-1 (]: 4 of 8 START seed file main.products ........................................... [RUN]
[0m20:45:33.257911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m20:45:33.258807 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m20:45:33.259615 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m20:45:33.813115 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:45:33.813754 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m20:45:33.814217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:33.827350 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:45:33.827966 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:45:33.828440 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m20:45:33.830469 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:33.832772 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:45:33.833306 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:45:33.915802 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m20:45:33.916828 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m20:45:33.919973 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:45:33.920976 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:45:33.921446 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:45:34.004632 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m20:45:34.006584 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m20:45:34.179802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a17b4ac-198d-4071-9e94-16e69295034c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97DD95630>]}
[0m20:45:34.180638 [info ] [Thread-1 (]: 4 of 8 OK loaded seed file main.products ....................................... [[32mINSERT 51290[0m in 0.92s]
[0m20:45:34.181612 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m20:45:34.182213 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m20:45:34.182976 [info ] [Thread-1 (]: 5 of 8 START seed file main.shipping ........................................... [RUN]
[0m20:45:34.183766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m20:45:34.184375 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m20:45:34.184869 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m20:45:35.080586 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:45:35.081207 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m20:45:35.081664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:35.099408 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m20:45:35.100038 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:45:35.100519 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m20:45:35.102475 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:35.104385 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:45:35.105133 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:45:35.351637 [debug] [Thread-1 (]: SQL status: OK in 0.246 seconds
[0m20:45:35.352618 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m20:45:35.356017 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:45:35.356640 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:45:35.357127 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:45:35.431846 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m20:45:35.433392 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m20:45:35.552487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a17b4ac-198d-4071-9e94-16e69295034c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B905CEEAD0>]}
[0m20:45:35.553297 [info ] [Thread-1 (]: 5 of 8 OK loaded seed file main.shipping ....................................... [[32mINSERT 51290[0m in 1.37s]
[0m20:45:35.554164 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m20:45:35.554788 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m20:45:35.555573 [info ] [Thread-1 (]: 6 of 8 START sql view model main.stg_orders .................................... [RUN]
[0m20:45:35.556276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_orders)
[0m20:45:35.556788 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m20:45:35.567236 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m20:45:35.569065 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m20:45:35.614564 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m20:45:35.616246 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:45:35.616865 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m20:45:35.617328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:35.630482 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:45:35.631114 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:45:35.631644 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m20:45:35.633195 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:35.642388 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:45:35.642995 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:45:35.644035 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:35.647820 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:45:35.648381 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:45:35.649356 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:45:35.654453 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:45:35.655044 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:45:35.655530 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:45:35.661501 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:45:35.668681 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:45:35.669305 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m20:45:35.673492 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:45:35.675583 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m20:45:35.693336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a17b4ac-198d-4071-9e94-16e69295034c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97F314750>]}
[0m20:45:35.694356 [info ] [Thread-1 (]: 6 of 8 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.14s]
[0m20:45:35.695351 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m20:45:35.695921 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m20:45:35.696660 [info ] [Thread-1 (]: 7 of 8 START sql view model main.stg_products .................................. [RUN]
[0m20:45:35.697343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m20:45:35.697860 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m20:45:35.701794 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m20:45:35.703308 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m20:45:35.707704 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m20:45:35.709250 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:45:35.710174 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m20:45:35.710806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:35.725296 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:45:35.725930 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:45:35.726426 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:45:35.727485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:35.731299 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:45:35.731861 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:45:35.732831 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:45:35.737127 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:45:35.737744 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:45:35.738703 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:45:35.740794 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:45:35.741301 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:45:35.741758 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:45:35.745827 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:45:35.749636 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:45:35.750161 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m20:45:35.754270 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:45:35.756730 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m20:45:35.777465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a17b4ac-198d-4071-9e94-16e69295034c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9049CB110>]}
[0m20:45:35.778663 [info ] [Thread-1 (]: 7 of 8 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.08s]
[0m20:45:35.779734 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m20:45:35.780451 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m20:45:35.781302 [info ] [Thread-1 (]: 8 of 8 START sql view model main.stg_shipping .................................. [RUN]
[0m20:45:35.782531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m20:45:35.783362 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m20:45:35.787859 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m20:45:35.789915 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m20:45:35.795526 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m20:45:35.797696 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:45:35.798704 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m20:45:35.799547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:35.813387 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:45:35.814020 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:45:35.814512 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category            
FROM "assignment_4"."main"."products"
  );

[0m20:45:35.815597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:35.820072 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:45:35.820761 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m20:45:35.821859 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:45:35.823970 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:45:35.824588 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:45:35.825192 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:45:35.830034 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:45:35.834094 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:45:35.834756 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m20:45:35.835771 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:45:35.837868 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m20:45:35.855765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a17b4ac-198d-4071-9e94-16e69295034c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B906514650>]}
[0m20:45:35.857112 [info ] [Thread-1 (]: 8 of 8 OK created sql view model main.stg_shipping ............................. [[32mOK[0m in 0.07s]
[0m20:45:35.858259 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m20:45:35.860711 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:35.861479 [debug] [MainThread]: On master: BEGIN
[0m20:45:35.862099 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:45:35.876165 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m20:45:35.876739 [debug] [MainThread]: On master: COMMIT
[0m20:45:35.877149 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:35.877526 [debug] [MainThread]: On master: COMMIT
[0m20:45:35.878174 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:45:35.878605 [debug] [MainThread]: On master: Close
[0m20:45:35.881546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:35.882062 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:45:35.882415 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:45:35.882758 [debug] [MainThread]: Connection 'model.assignment_4.stg_shipping' was properly closed.
[0m20:45:35.883311 [info ] [MainThread]: 
[0m20:45:35.883791 [info ] [MainThread]: Finished running 5 seeds, 3 view models in 0 hours 0 minutes and 8.30 seconds (8.30s).
[0m20:45:35.886631 [debug] [MainThread]: Command end result
[0m20:45:35.929027 [info ] [MainThread]: 
[0m20:45:35.929717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:45:35.930219 [info ] [MainThread]: 
[0m20:45:35.930696 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m20:45:35.932058 [debug] [MainThread]: Command `dbt build` succeeded at 20:45:35.931831 after 9.77 seconds
[0m20:45:35.932597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97DC4FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97C919430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9065156D0>]}
[0m20:45:35.933084 [debug] [MainThread]: Flushing usage events
[0m20:45:49.212471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A4A10F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A49DBF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A4CB607D0>]}


============================== 20:45:49.218181 | db8809bf-c7be-41a6-96b1-1e2e99e1268e ==============================
[0m20:45:49.218181 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:45:49.219109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:45:49.566259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db8809bf-c7be-41a6-96b1-1e2e99e1268e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A4CF18510>]}
[0m20:45:49.645050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db8809bf-c7be-41a6-96b1-1e2e99e1268e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A4CB37F00>]}
[0m20:45:49.652302 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:45:49.664827 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:45:49.886301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:45:49.887178 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\staging\stg_shipping.sql
[0m20:45:50.229550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db8809bf-c7be-41a6-96b1-1e2e99e1268e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A4CD6D050>]}
[0m20:45:50.371081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db8809bf-c7be-41a6-96b1-1e2e99e1268e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A4CAC3B60>]}
[0m20:45:50.371793 [info ] [MainThread]: Found 5 seeds, 3 models, 421 macros
[0m20:45:50.375730 [info ] [MainThread]: 
[0m20:45:50.377048 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:45:50.384830 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:45:50.514161 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:45:50.514733 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:45:50.515158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:50.531169 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:45:50.533154 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:45:50.536956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:45:50.537751 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:45:50.546896 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:45:50.547469 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:45:50.547884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:50.561300 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:45:50.563287 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:45:50.563901 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:45:50.564664 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:45:50.565088 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:45:50.565485 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:45:50.566231 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:45:50.567593 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:45:50.568029 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:45:50.568427 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:45:50.569109 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:45:50.569551 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:45:50.574641 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:45:50.583093 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:45:50.583687 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:45:50.584076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:50.597067 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:45:50.597686 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:45:50.598316 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:45:50.655556 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m20:45:50.657690 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:45:50.659820 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:45:50.660910 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:45:50.669549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db8809bf-c7be-41a6-96b1-1e2e99e1268e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A4E3C7850>]}
[0m20:45:50.670229 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:50.670646 [debug] [MainThread]: On master: BEGIN
[0m20:45:50.671032 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:50.684449 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:45:50.685041 [debug] [MainThread]: On master: COMMIT
[0m20:45:50.685518 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:50.685907 [debug] [MainThread]: On master: COMMIT
[0m20:45:50.686559 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:45:50.686988 [debug] [MainThread]: On master: Close
[0m20:45:50.690410 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:45:50.691015 [info ] [MainThread]: 
[0m20:45:50.695750 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m20:45:50.696647 [info ] [Thread-1 (]: 1 of 8 START seed file main.customers .......................................... [RUN]
[0m20:45:50.697415 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m20:45:50.698939 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m20:45:50.699460 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m20:45:51.040103 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:45:51.040717 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m20:45:51.041176 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:45:51.054068 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:45:51.054696 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:45:51.055175 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m20:45:51.056821 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:51.073646 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:45:51.074276 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:45:51.137193 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m20:45:51.145382 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m20:45:51.167813 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:45:51.168440 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:45:51.168913 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:45:51.245703 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m20:45:51.249400 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m20:45:51.332248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db8809bf-c7be-41a6-96b1-1e2e99e1268e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A4E483C70>]}
[0m20:45:51.333050 [info ] [Thread-1 (]: 1 of 8 OK loaded seed file main.customers ...................................... [[32mINSERT 51290[0m in 0.63s]
[0m20:45:51.333956 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m20:45:51.334563 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m20:45:51.335441 [info ] [Thread-1 (]: 2 of 8 START seed file main.locations .......................................... [RUN]
[0m20:45:51.336180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m20:45:51.336695 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m20:45:51.337204 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m20:45:51.789830 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:45:51.790439 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m20:45:51.790929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:51.803773 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:45:51.804392 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:45:51.804871 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m20:45:51.806668 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:51.808490 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:45:51.809020 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:45:51.902398 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m20:45:51.903414 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m20:45:51.906305 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:45:51.906912 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:45:51.907373 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:45:51.998859 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m20:45:52.000707 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m20:45:52.119901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db8809bf-c7be-41a6-96b1-1e2e99e1268e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A4E0D50D0>]}
[0m20:45:52.120702 [info ] [Thread-1 (]: 2 of 8 OK loaded seed file main.locations ...................................... [[32mINSERT 51290[0m in 0.78s]
[0m20:45:52.121584 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m20:45:52.122136 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m20:45:52.122910 [info ] [Thread-1 (]: 3 of 8 START seed file main.orders ............................................. [RUN]
[0m20:45:52.123571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m20:45:52.124057 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m20:45:52.124519 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m20:45:55.148787 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:45:55.149397 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m20:45:55.149852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:55.162661 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:45:55.163277 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:45:55.163742 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m20:45:55.165759 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:55.168247 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:45:55.169331 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:45:55.527396 [debug] [Thread-1 (]: SQL status: OK in 0.357 seconds
[0m20:45:55.528393 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m20:45:55.532728 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:45:55.533334 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:45:55.533800 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:45:55.611877 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m20:45:55.613302 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m20:45:55.817095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db8809bf-c7be-41a6-96b1-1e2e99e1268e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A4E2DDA70>]}
[0m20:45:55.818075 [info ] [Thread-1 (]: 3 of 8 OK loaded seed file main.orders ......................................... [[32mINSERT 51290[0m in 3.69s]
[0m20:45:55.819014 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m20:45:55.820704 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m20:45:55.822128 [info ] [Thread-1 (]: 4 of 8 START seed file main.products ........................................... [RUN]
[0m20:45:55.823141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m20:45:55.823689 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m20:45:55.824161 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m20:45:56.394874 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:45:56.395452 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m20:45:56.395984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:56.408295 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m20:45:56.408917 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:45:56.409366 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m20:45:56.411068 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:56.412962 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:45:56.413674 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:45:56.495222 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m20:45:56.496149 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m20:45:56.498870 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:45:56.499509 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:45:56.499944 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:45:56.579019 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m20:45:56.580684 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m20:45:56.677504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db8809bf-c7be-41a6-96b1-1e2e99e1268e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A4CEE5630>]}
[0m20:45:56.678229 [info ] [Thread-1 (]: 4 of 8 OK loaded seed file main.products ....................................... [[32mINSERT 51290[0m in 0.85s]
[0m20:45:56.679045 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m20:45:56.679619 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m20:45:56.680487 [info ] [Thread-1 (]: 5 of 8 START seed file main.shipping ........................................... [RUN]
[0m20:45:56.682336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m20:45:56.683069 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m20:45:56.683526 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m20:45:57.479084 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:45:57.479856 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m20:45:57.480799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:57.491495 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:45:57.492631 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:45:57.493190 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m20:45:57.494512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:57.495987 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:45:57.496563 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:45:57.746378 [debug] [Thread-1 (]: SQL status: OK in 0.249 seconds
[0m20:45:57.747144 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m20:45:57.749389 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:45:57.749863 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:45:57.750209 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:45:57.814815 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m20:45:57.816690 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m20:45:57.881054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db8809bf-c7be-41a6-96b1-1e2e99e1268e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5334EB50>]}
[0m20:45:57.881708 [info ] [Thread-1 (]: 5 of 8 OK loaded seed file main.shipping ....................................... [[32mINSERT 51290[0m in 1.20s]
[0m20:45:57.882340 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m20:45:57.882866 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m20:45:57.883461 [info ] [Thread-1 (]: 6 of 8 START sql view model main.stg_orders .................................... [RUN]
[0m20:45:57.883942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_orders)
[0m20:45:57.884280 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m20:45:57.891814 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m20:45:57.893069 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m20:45:57.924823 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m20:45:57.926110 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:45:57.926594 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m20:45:57.926914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:57.937296 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:45:57.937782 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:45:57.938135 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m20:45:57.939091 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:57.949090 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:45:57.949559 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:45:57.950339 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:45:57.953134 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:45:57.953550 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:45:57.954277 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:45:57.958038 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:45:57.958487 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:45:57.958816 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:45:57.963417 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:45:57.968530 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:45:57.969031 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m20:45:57.972427 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:45:57.974659 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m20:45:57.991339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db8809bf-c7be-41a6-96b1-1e2e99e1268e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54C9BEE0>]}
[0m20:45:57.992167 [info ] [Thread-1 (]: 6 of 8 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.11s]
[0m20:45:57.992826 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m20:45:57.993228 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m20:45:57.993748 [info ] [Thread-1 (]: 7 of 8 START sql view model main.stg_products .................................. [RUN]
[0m20:45:57.994216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m20:45:57.994573 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m20:45:57.997606 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m20:45:57.999059 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m20:45:58.003139 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m20:45:58.004357 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:45:58.004968 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m20:45:58.005462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:58.015167 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:45:58.015693 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:45:58.016046 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:45:58.016853 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:45:58.019676 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:45:58.020098 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:45:58.020833 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:45:58.023943 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:45:58.024375 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:45:58.025088 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:45:58.026778 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:45:58.027206 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:45:58.027522 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:45:58.031175 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:45:58.034553 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:45:58.034989 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m20:45:58.038581 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:45:58.040305 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m20:45:58.057957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db8809bf-c7be-41a6-96b1-1e2e99e1268e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A50968E30>]}
[0m20:45:58.058713 [info ] [Thread-1 (]: 7 of 8 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.06s]
[0m20:45:58.059348 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m20:45:58.059747 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m20:45:58.060274 [info ] [Thread-1 (]: 8 of 8 START sql view model main.stg_shipping .................................. [RUN]
[0m20:45:58.060766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m20:45:58.061113 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m20:45:58.063593 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m20:45:58.064771 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m20:45:58.068727 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m20:45:58.069942 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:45:58.070411 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m20:45:58.070749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:58.080223 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:45:58.080696 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:45:58.081031 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:45:58.081822 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:45:58.084626 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:45:58.085038 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m20:45:58.085772 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:45:58.089651 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:45:58.090467 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m20:45:58.091846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:58.094352 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:45:58.095070 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:45:58.095692 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:45:58.100996 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:45:58.103580 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:45:58.104181 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m20:45:58.107922 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:45:58.110470 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m20:45:58.129075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db8809bf-c7be-41a6-96b1-1e2e99e1268e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A53A5FE90>]}
[0m20:45:58.131053 [info ] [Thread-1 (]: 8 of 8 OK created sql view model main.stg_shipping ............................. [[32mOK[0m in 0.07s]
[0m20:45:58.132291 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m20:45:58.134471 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:58.135059 [debug] [MainThread]: On master: BEGIN
[0m20:45:58.135735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:45:58.150647 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m20:45:58.151145 [debug] [MainThread]: On master: COMMIT
[0m20:45:58.151483 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:58.151782 [debug] [MainThread]: On master: COMMIT
[0m20:45:58.152850 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:45:58.153293 [debug] [MainThread]: On master: Close
[0m20:45:58.155931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:58.156408 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:45:58.156689 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:45:58.156932 [debug] [MainThread]: Connection 'model.assignment_4.stg_shipping' was properly closed.
[0m20:45:58.157400 [info ] [MainThread]: 
[0m20:45:58.157799 [info ] [MainThread]: Finished running 5 seeds, 3 view models in 0 hours 0 minutes and 7.78 seconds (7.78s).
[0m20:45:58.159838 [debug] [MainThread]: Command end result
[0m20:45:58.190555 [info ] [MainThread]: 
[0m20:45:58.191076 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:45:58.191416 [info ] [MainThread]: 
[0m20:45:58.191748 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m20:45:58.192730 [debug] [MainThread]: Command `dbt build` succeeded at 20:45:58.192564 after 9.14 seconds
[0m20:45:58.193126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A4E41BFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A4BA78D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A552899D0>]}
[0m20:45:58.193476 [debug] [MainThread]: Flushing usage events
[0m20:46:43.139037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06A4FEE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06CF58550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06CF58410>]}


============================== 20:46:43.144214 | 7effd46e-3341-4d09-9e3e-df3586265856 ==============================
[0m20:46:43.144214 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:46:43.145309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_shipping', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:46:43.451156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7effd46e-3341-4d09-9e3e-df3586265856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06E300510>]}
[0m20:46:43.527430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7effd46e-3341-4d09-9e3e-df3586265856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06CF03F00>]}
[0m20:46:43.533403 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:46:43.547598 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:46:43.741076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:46:43.741611 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:46:43.791317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7effd46e-3341-4d09-9e3e-df3586265856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06D13CF50>]}
[0m20:46:43.919517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7effd46e-3341-4d09-9e3e-df3586265856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06D0FFD40>]}
[0m20:46:43.920373 [info ] [MainThread]: Found 5 seeds, 3 models, 421 macros
[0m20:46:43.921113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7effd46e-3341-4d09-9e3e-df3586265856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06D19CE50>]}
[0m20:46:43.923219 [info ] [MainThread]: 
[0m20:46:43.924296 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:46:43.925747 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:46:44.057527 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:46:44.058086 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:46:44.058506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:44.074762 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:46:44.076674 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:46:44.080434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:46:44.081180 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:46:44.093165 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:46:44.093731 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:46:44.094130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:44.107635 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:46:44.109539 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:46:44.109989 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:46:44.110679 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:46:44.111091 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:46:44.111478 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:46:44.112190 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:46:44.113398 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:46:44.113813 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:46:44.114191 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:46:44.114846 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:46:44.115272 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:46:44.127089 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:46:44.135609 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:46:44.136154 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:46:44.136542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:44.149147 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:46:44.149699 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:46:44.150113 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:46:44.209969 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m20:46:44.212085 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:46:44.214148 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:46:44.214683 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:46:44.221917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7effd46e-3341-4d09-9e3e-df3586265856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06E6BF930>]}
[0m20:46:44.222598 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:44.223007 [debug] [MainThread]: On master: BEGIN
[0m20:46:44.223378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:44.236348 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:46:44.237095 [debug] [MainThread]: On master: COMMIT
[0m20:46:44.237578 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:44.237961 [debug] [MainThread]: On master: COMMIT
[0m20:46:44.238691 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:46:44.239116 [debug] [MainThread]: On master: Close
[0m20:46:44.242771 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:46:44.243751 [info ] [MainThread]: 
[0m20:46:44.248754 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m20:46:44.249574 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_shipping .................................. [RUN]
[0m20:46:44.250915 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.stg_shipping'
[0m20:46:44.251687 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m20:46:44.262004 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m20:46:44.263586 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m20:46:44.311354 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m20:46:44.313155 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:46:44.314171 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m20:46:44.314883 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:46:44.327770 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:46:44.328403 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:46:44.328896 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:46:44.330022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:44.338560 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:46:44.339172 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m20:46:44.340185 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:44.344311 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:46:44.344940 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m20:46:44.345907 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:44.369577 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:46:44.370185 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:46:44.370650 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:46:44.375238 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:46:44.382585 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:46:44.383161 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m20:46:44.386886 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:46:44.390803 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m20:46:44.409366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7effd46e-3341-4d09-9e3e-df3586265856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06E73DA90>]}
[0m20:46:44.410296 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_shipping ............................. [[32mOK[0m in 0.16s]
[0m20:46:44.411891 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m20:46:44.414020 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:44.414809 [debug] [MainThread]: On master: BEGIN
[0m20:46:44.415269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:46:44.428441 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:46:44.428993 [debug] [MainThread]: On master: COMMIT
[0m20:46:44.429383 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:44.429763 [debug] [MainThread]: On master: COMMIT
[0m20:46:44.430396 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:46:44.430819 [debug] [MainThread]: On master: Close
[0m20:46:44.435165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:44.435698 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:46:44.436061 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:46:44.436406 [debug] [MainThread]: Connection 'model.assignment_4.stg_shipping' was properly closed.
[0m20:46:44.436850 [info ] [MainThread]: 
[0m20:46:44.437497 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m20:46:44.438690 [debug] [MainThread]: Command end result
[0m20:46:44.479443 [info ] [MainThread]: 
[0m20:46:44.481022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:46:44.481918 [info ] [MainThread]: 
[0m20:46:44.482772 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:46:44.484561 [debug] [MainThread]: Command `dbt run` succeeded at 20:46:44.484319 after 1.51 seconds
[0m20:46:44.485114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06E512BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06E8E7E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06E8E7ED0>]}
[0m20:46:44.485728 [debug] [MainThread]: Flushing usage events
[0m20:49:38.897792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B07F04F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B07ECEF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B001B307D0>]}


============================== 20:49:38.903041 | 1ddf894e-7934-4062-9179-c24b83d7e44e ==============================
[0m20:49:38.903041 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:49:38.903818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:49:39.217260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ddf894e-7934-4062-9179-c24b83d7e44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B001EF8510>]}
[0m20:49:39.294206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ddf894e-7934-4062-9179-c24b83d7e44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B001B0BF00>]}
[0m20:49:39.300501 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:49:39.312624 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:49:39.510653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:49:39.511410 [debug] [MainThread]: Partial parsing: added file: assignment_4://models\staging\stg_customers.sql
[0m20:49:39.828618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ddf894e-7934-4062-9179-c24b83d7e44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B001D40550>]}
[0m20:49:39.979800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ddf894e-7934-4062-9179-c24b83d7e44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B001CFFD40>]}
[0m20:49:39.980557 [info ] [MainThread]: Found 5 seeds, 4 models, 421 macros
[0m20:49:39.983751 [info ] [MainThread]: 
[0m20:49:39.984635 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:49:39.992229 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:49:40.129123 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:49:40.129688 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:49:40.130101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:40.146018 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:49:40.147906 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:49:40.152094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:49:40.152849 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:49:40.161971 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:49:40.162528 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:49:40.163069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:40.176807 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:49:40.178717 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:49:40.179181 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:49:40.179919 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:49:40.180344 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:49:40.180735 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:49:40.181465 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:49:40.182659 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:49:40.183084 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:49:40.183465 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:49:40.184178 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:49:40.184664 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:49:40.191097 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:49:40.199138 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:49:40.199675 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:49:40.200140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:40.214237 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:49:40.214796 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:49:40.215217 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:49:40.271326 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m20:49:40.273413 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:49:40.275523 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:49:40.276023 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:49:40.284416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ddf894e-7934-4062-9179-c24b83d7e44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0033DFBD0>]}
[0m20:49:40.285078 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:40.285488 [debug] [MainThread]: On master: BEGIN
[0m20:49:40.285934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:40.298761 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:49:40.299317 [debug] [MainThread]: On master: COMMIT
[0m20:49:40.299751 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:40.300139 [debug] [MainThread]: On master: COMMIT
[0m20:49:40.300782 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:49:40.301203 [debug] [MainThread]: On master: Close
[0m20:49:40.304747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:49:40.305365 [info ] [MainThread]: 
[0m20:49:40.310230 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m20:49:40.311616 [info ] [Thread-1 (]: 1 of 9 START seed file main.customers .......................................... [RUN]
[0m20:49:40.314197 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m20:49:40.315108 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m20:49:40.315861 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m20:49:40.668505 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:49:40.669117 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m20:49:40.669574 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:49:40.683473 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:49:40.684115 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:49:40.684590 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m20:49:40.686499 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:40.703599 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:49:40.704268 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:49:40.766178 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m20:49:40.774967 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m20:49:40.797996 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:49:40.798618 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:49:40.799086 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:49:40.870257 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m20:49:40.873410 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m20:49:40.964655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddf894e-7934-4062-9179-c24b83d7e44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B00348FC70>]}
[0m20:49:40.965478 [info ] [Thread-1 (]: 1 of 9 OK loaded seed file main.customers ...................................... [[32mINSERT 51290[0m in 0.65s]
[0m20:49:40.966386 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m20:49:40.966975 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m20:49:40.967869 [info ] [Thread-1 (]: 2 of 9 START seed file main.locations .......................................... [RUN]
[0m20:49:40.968888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m20:49:40.969427 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m20:49:40.969936 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m20:49:41.438881 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:49:41.439532 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m20:49:41.439997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:41.453228 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:49:41.453853 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:49:41.454334 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m20:49:41.456556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:41.458384 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:49:41.458953 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:49:41.562485 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m20:49:41.563515 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m20:49:41.566408 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:49:41.567087 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:49:41.567707 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:49:41.660955 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m20:49:41.662723 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m20:49:41.859924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddf894e-7934-4062-9179-c24b83d7e44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0030E10D0>]}
[0m20:49:41.860732 [info ] [Thread-1 (]: 2 of 9 OK loaded seed file main.locations ...................................... [[32mINSERT 51290[0m in 0.89s]
[0m20:49:41.861614 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m20:49:41.862170 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m20:49:41.862999 [info ] [Thread-1 (]: 3 of 9 START seed file main.orders ............................................. [RUN]
[0m20:49:41.863682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m20:49:41.864351 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m20:49:41.864843 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m20:49:44.952687 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:49:44.953295 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m20:49:44.953758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:44.966684 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:49:44.967300 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:49:44.967786 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m20:49:44.969768 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:44.971552 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:49:44.972071 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:49:45.330103 [debug] [Thread-1 (]: SQL status: OK in 0.357 seconds
[0m20:49:45.331118 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m20:49:45.334054 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:49:45.334663 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:49:45.335141 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:49:45.452054 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m20:49:45.453843 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m20:49:45.690107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddf894e-7934-4062-9179-c24b83d7e44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0032F5B20>]}
[0m20:49:45.691068 [info ] [Thread-1 (]: 3 of 9 OK loaded seed file main.orders ......................................... [[32mINSERT 51290[0m in 3.83s]
[0m20:49:45.691947 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m20:49:45.692498 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m20:49:45.693274 [info ] [Thread-1 (]: 4 of 9 START seed file main.products ........................................... [RUN]
[0m20:49:45.694237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m20:49:45.695122 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m20:49:45.695975 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m20:49:46.253946 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:49:46.254554 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m20:49:46.255018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:46.268225 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:49:46.268886 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:49:46.269384 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m20:49:46.271213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:46.273028 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:49:46.273556 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:49:46.371976 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m20:49:46.373005 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m20:49:46.375878 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:49:46.376662 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:49:46.377206 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:49:46.461190 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m20:49:46.462474 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m20:49:46.640197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddf894e-7934-4062-9179-c24b83d7e44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B001EC5630>]}
[0m20:49:46.641013 [info ] [Thread-1 (]: 4 of 9 OK loaded seed file main.products ....................................... [[32mINSERT 51290[0m in 0.95s]
[0m20:49:46.641894 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m20:49:46.642445 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m20:49:46.643367 [info ] [Thread-1 (]: 5 of 9 START seed file main.shipping ........................................... [RUN]
[0m20:49:46.644360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m20:49:46.644937 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m20:49:46.645425 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m20:49:47.545095 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:49:47.545721 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m20:49:47.546179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:47.558999 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:49:47.559663 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:49:47.560139 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m20:49:47.561920 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:47.563736 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:49:47.564358 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:49:47.919076 [debug] [Thread-1 (]: SQL status: OK in 0.354 seconds
[0m20:49:47.920114 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m20:49:47.923497 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:49:47.924090 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:49:47.924563 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:49:47.998081 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m20:49:47.999845 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m20:49:48.119616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddf894e-7934-4062-9179-c24b83d7e44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B008383350>]}
[0m20:49:48.120430 [info ] [Thread-1 (]: 5 of 9 OK loaded seed file main.shipping ....................................... [[32mINSERT 51290[0m in 1.48s]
[0m20:49:48.121300 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m20:49:48.121856 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m20:49:48.122856 [info ] [Thread-1 (]: 6 of 9 START sql view model main.stg_customers ................................. [RUN]
[0m20:49:48.124129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m20:49:48.124824 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m20:49:48.135098 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m20:49:48.136635 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m20:49:48.182065 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m20:49:48.183623 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:49:48.184248 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m20:49:48.184710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:48.197802 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:49:48.198425 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:49:48.198917 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    WITH cleaned_customers AS (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment                  
FROM "assignment_4"."main"."customers"
  );

[0m20:49:48.199883 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    WITH cleaned_customers AS (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment                  
FROM "assignment_4"."main"."customers"
  );

[0m20:49:48.200425 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:49:48.201033 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: ROLLBACK
[0m20:49:48.211267 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.stg_customers'
[0m20:49:48.211873 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m20:49:48.220931 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near ";"
[0m20:49:48.221650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddf894e-7934-4062-9179-c24b83d7e44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B00311FCB0>]}
[0m20:49:48.222531 [error] [Thread-1 (]: 6 of 9 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.10s]
[0m20:49:48.223439 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m20:49:48.224000 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m20:49:48.225352 [info ] [Thread-1 (]: 7 of 9 START sql view model main.stg_orders .................................... [RUN]
[0m20:49:48.226479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_orders)
[0m20:49:48.227087 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m20:49:48.231194 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m20:49:48.232690 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m20:49:48.237003 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m20:49:48.238503 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:49:48.239127 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m20:49:48.239581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:48.252121 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m20:49:48.252734 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:49:48.253246 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m20:49:48.254410 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:48.262981 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:49:48.263581 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:49:48.264554 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:48.268891 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:49:48.269481 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:49:48.270430 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:48.275426 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:49:48.276032 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:49:48.276496 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:49:48.319228 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m20:49:48.327150 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:49:48.327827 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m20:49:48.331923 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:48.334110 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m20:49:48.353363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddf894e-7934-4062-9179-c24b83d7e44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0059853D0>]}
[0m20:49:48.354662 [info ] [Thread-1 (]: 7 of 9 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.13s]
[0m20:49:48.356323 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m20:49:48.357080 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m20:49:48.357979 [info ] [Thread-1 (]: 8 of 9 START sql view model main.stg_products .................................. [RUN]
[0m20:49:48.359227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m20:49:48.359831 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m20:49:48.363191 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m20:49:48.364568 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m20:49:48.369878 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m20:49:48.371361 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:49:48.372006 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m20:49:48.372506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:48.385776 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:49:48.386404 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:49:48.386893 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:49:48.388102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:48.392057 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:49:48.392686 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:49:48.393648 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:48.397846 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:49:48.398422 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:49:48.399458 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:48.401657 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:49:48.402181 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:49:48.402645 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:49:48.406932 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:49:48.410574 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:49:48.411093 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m20:49:48.414673 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:48.417064 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m20:49:48.433497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddf894e-7934-4062-9179-c24b83d7e44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B008A8AC90>]}
[0m20:49:48.434449 [info ] [Thread-1 (]: 8 of 9 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.07s]
[0m20:49:48.435354 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m20:49:48.435920 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m20:49:48.436653 [info ] [Thread-1 (]: 9 of 9 START sql view model main.stg_shipping .................................. [RUN]
[0m20:49:48.437280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m20:49:48.437852 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m20:49:48.441135 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m20:49:48.442545 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m20:49:48.447462 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m20:49:48.449010 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:49:48.449856 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m20:49:48.450552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:48.462853 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m20:49:48.463456 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:49:48.463947 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:49:48.464987 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:48.468796 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:49:48.469363 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m20:49:48.470447 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:48.474103 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:49:48.474660 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m20:49:48.475612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:48.477734 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:49:48.478255 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:49:48.478826 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:49:48.482799 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:48.486805 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:49:48.487376 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m20:49:48.490983 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:48.493290 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m20:49:48.509682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddf894e-7934-4062-9179-c24b83d7e44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B003707950>]}
[0m20:49:48.510593 [info ] [Thread-1 (]: 9 of 9 OK created sql view model main.stg_shipping ............................. [[32mOK[0m in 0.07s]
[0m20:49:48.511546 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m20:49:48.513881 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:48.514404 [debug] [MainThread]: On master: BEGIN
[0m20:49:48.514782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:48.528647 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m20:49:48.529221 [debug] [MainThread]: On master: COMMIT
[0m20:49:48.529611 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:48.529985 [debug] [MainThread]: On master: COMMIT
[0m20:49:48.530642 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:49:48.531065 [debug] [MainThread]: On master: Close
[0m20:49:48.534317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:48.534847 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:49:48.535207 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:49:48.535547 [debug] [MainThread]: Connection 'model.assignment_4.stg_shipping' was properly closed.
[0m20:49:48.536072 [info ] [MainThread]: 
[0m20:49:48.536547 [info ] [MainThread]: Finished running 5 seeds, 4 view models in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m20:49:48.539643 [debug] [MainThread]: Command end result
[0m20:49:48.586156 [info ] [MainThread]: 
[0m20:49:48.587302 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:49:48.588104 [info ] [MainThread]: 
[0m20:49:48.588999 [error] [MainThread]:   Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near ";"
[0m20:49:48.589901 [info ] [MainThread]: 
[0m20:49:48.590712 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m20:49:48.592712 [debug] [MainThread]: Command `dbt build` failed at 20:49:48.592397 after 9.95 seconds
[0m20:49:48.593469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B008A8BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B07F79B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0089297F0>]}
[0m20:49:48.594271 [debug] [MainThread]: Flushing usage events
[0m20:51:16.242089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D67AF0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D645F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D91F07D0>]}


============================== 20:51:16.247476 | 39051173-91db-47d7-a50c-a184e19d0721 ==============================
[0m20:51:16.247476 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:51:16.248336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:51:16.563914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39051173-91db-47d7-a50c-a184e19d0721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205DA56C510>]}
[0m20:51:16.640389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39051173-91db-47d7-a50c-a184e19d0721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D91C7F00>]}
[0m20:51:16.646500 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:51:16.658341 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:51:16.891367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:16.891896 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:16.943628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39051173-91db-47d7-a50c-a184e19d0721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D93FC150>]}
[0m20:51:17.100232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39051173-91db-47d7-a50c-a184e19d0721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D9153B60>]}
[0m20:51:17.100976 [info ] [MainThread]: Found 5 seeds, 4 models, 421 macros
[0m20:51:17.104455 [info ] [MainThread]: 
[0m20:51:17.105331 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:51:17.112801 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:51:17.242338 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:51:17.242895 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:51:17.243312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:17.260707 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:51:17.262752 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:51:17.266741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:51:17.267790 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:51:17.277448 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:51:17.278007 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:51:17.278413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:17.292469 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:51:17.294722 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:51:17.295200 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:51:17.295955 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:51:17.296366 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:51:17.296747 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:51:17.297539 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:51:17.298773 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:51:17.299187 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:51:17.299630 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:51:17.300339 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:51:17.300771 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:51:17.306331 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:51:17.314301 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:51:17.314816 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:51:17.315182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:17.328993 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:51:17.329535 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:51:17.329966 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:51:17.387049 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m20:51:17.389284 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:51:17.391322 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:51:17.391827 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:51:17.398943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39051173-91db-47d7-a50c-a184e19d0721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205DA8AEA50>]}
[0m20:51:17.399598 [debug] [MainThread]: Using duckdb connection "master"
[0m20:51:17.400007 [debug] [MainThread]: On master: BEGIN
[0m20:51:17.400381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:17.415320 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m20:51:17.415892 [debug] [MainThread]: On master: COMMIT
[0m20:51:17.416287 [debug] [MainThread]: Using duckdb connection "master"
[0m20:51:17.416672 [debug] [MainThread]: On master: COMMIT
[0m20:51:17.417288 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:51:17.417801 [debug] [MainThread]: On master: Close
[0m20:51:17.421246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:17.421846 [info ] [MainThread]: 
[0m20:51:17.426899 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m20:51:17.427734 [info ] [Thread-1 (]: 1 of 9 START seed file main.customers .......................................... [RUN]
[0m20:51:17.428496 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m20:51:17.428984 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m20:51:17.429471 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m20:51:17.768971 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:51:17.769591 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m20:51:17.770046 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:51:17.783155 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:51:17.783787 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:51:17.784262 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m20:51:17.786240 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:51:17.803426 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:51:17.804064 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:51:17.866457 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m20:51:17.874665 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m20:51:17.898522 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:51:17.899128 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:51:17.899601 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:51:17.938144 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m20:51:17.940756 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m20:51:18.016834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39051173-91db-47d7-a50c-a184e19d0721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205DAB8E340>]}
[0m20:51:18.017677 [info ] [Thread-1 (]: 1 of 9 OK loaded seed file main.customers ...................................... [[32mINSERT 51290[0m in 0.59s]
[0m20:51:18.018585 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m20:51:18.019159 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m20:51:18.019995 [info ] [Thread-1 (]: 2 of 9 START seed file main.locations .......................................... [RUN]
[0m20:51:18.020934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m20:51:18.021715 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m20:51:18.022316 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m20:51:18.475065 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:51:18.475665 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m20:51:18.476120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:18.488899 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:51:18.489511 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:51:18.489984 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m20:51:18.491751 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:51:18.493575 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:51:18.494111 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:51:18.587661 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m20:51:18.588771 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m20:51:18.592201 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:51:18.592818 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:51:18.593281 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:51:18.683022 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m20:51:18.684231 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m20:51:18.814827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39051173-91db-47d7-a50c-a184e19d0721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205DA99D250>]}
[0m20:51:18.815644 [info ] [Thread-1 (]: 2 of 9 OK loaded seed file main.locations ...................................... [[32mINSERT 51290[0m in 0.79s]
[0m20:51:18.816588 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m20:51:18.817176 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m20:51:18.817926 [info ] [Thread-1 (]: 3 of 9 START seed file main.orders ............................................. [RUN]
[0m20:51:18.818821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m20:51:18.819403 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m20:51:18.819883 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m20:51:21.867458 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:51:21.868070 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m20:51:21.868525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:21.881169 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:51:21.881781 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:51:21.882249 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m20:51:21.884315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:51:21.887254 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:51:21.887827 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:51:22.272077 [debug] [Thread-1 (]: SQL status: OK in 0.384 seconds
[0m20:51:22.273072 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m20:51:22.276898 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:51:22.277491 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:51:22.277953 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:51:22.396872 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m20:51:22.398601 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m20:51:22.608913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39051173-91db-47d7-a50c-a184e19d0721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205DA81CF70>]}
[0m20:51:22.609722 [info ] [Thread-1 (]: 3 of 9 OK loaded seed file main.orders ......................................... [[32mINSERT 51290[0m in 3.79s]
[0m20:51:22.610590 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m20:51:22.611132 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m20:51:22.611957 [info ] [Thread-1 (]: 4 of 9 START seed file main.products ........................................... [RUN]
[0m20:51:22.613074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m20:51:22.614067 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m20:51:22.614721 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m20:51:23.172928 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:51:23.173573 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m20:51:23.174044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:23.186920 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:51:23.187526 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:51:23.188001 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m20:51:23.189856 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:51:23.191651 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:51:23.192169 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:51:23.275694 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m20:51:23.276721 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m20:51:23.280175 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:51:23.280767 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:51:23.281275 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:51:23.365678 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m20:51:23.367408 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m20:51:23.472628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39051173-91db-47d7-a50c-a184e19d0721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D9303930>]}
[0m20:51:23.473563 [info ] [Thread-1 (]: 4 of 9 OK loaded seed file main.products ....................................... [[32mINSERT 51290[0m in 0.86s]
[0m20:51:23.474465 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m20:51:23.475093 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m20:51:23.475887 [info ] [Thread-1 (]: 5 of 9 START seed file main.shipping ........................................... [RUN]
[0m20:51:23.476761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m20:51:23.477296 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m20:51:23.477766 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m20:51:24.412300 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:51:24.412911 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m20:51:24.413365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:24.427484 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:51:24.428174 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:51:24.428663 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m20:51:24.430421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:51:24.432232 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:51:24.432750 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:51:24.807834 [debug] [Thread-1 (]: SQL status: OK in 0.374 seconds
[0m20:51:24.808873 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m20:51:24.812508 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:51:24.813129 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:51:24.813598 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:51:24.887319 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m20:51:24.888546 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m20:51:24.974930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39051173-91db-47d7-a50c-a184e19d0721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E7C5F5D0>]}
[0m20:51:24.975744 [info ] [Thread-1 (]: 5 of 9 OK loaded seed file main.shipping ....................................... [[32mINSERT 51290[0m in 1.50s]
[0m20:51:24.976606 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m20:51:24.977172 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m20:51:24.977992 [info ] [Thread-1 (]: 6 of 9 START sql view model main.stg_customers ................................. [RUN]
[0m20:51:24.978649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m20:51:24.979135 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m20:51:24.989611 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m20:51:24.991152 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m20:51:25.038513 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m20:51:25.040284 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:51:25.040925 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m20:51:25.041384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:25.055068 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:51:25.055674 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:51:25.056167 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    WITH cleaned_customers AS (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment                  
FROM "assignment_4"."main"."customers"
  );

[0m20:51:25.057156 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    WITH cleaned_customers AS (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment                  
FROM "assignment_4"."main"."customers"
  );

[0m20:51:25.057669 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:51:25.058270 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: ROLLBACK
[0m20:51:25.070506 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.stg_customers'
[0m20:51:25.071270 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m20:51:25.080219 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near ";"
[0m20:51:25.081036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39051173-91db-47d7-a50c-a184e19d0721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D8EF6350>]}
[0m20:51:25.081894 [error] [Thread-1 (]: 6 of 9 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.10s]
[0m20:51:25.082796 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m20:51:25.083367 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m20:51:25.084684 [info ] [Thread-1 (]: 7 of 9 START sql view model main.stg_orders .................................... [RUN]
[0m20:51:25.085373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_orders)
[0m20:51:25.085862 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m20:51:25.090379 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m20:51:25.093065 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m20:51:25.099256 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m20:51:25.100860 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:51:25.101503 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m20:51:25.101964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:25.114640 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:51:25.115246 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:51:25.115751 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m20:51:25.116965 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:51:25.125928 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:51:25.126571 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:51:25.127655 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:51:25.131945 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:51:25.132532 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:51:25.133491 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:51:25.138639 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:51:25.139256 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:51:25.139723 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:51:25.180639 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m20:51:25.188836 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:51:25.189527 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m20:51:25.193506 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:51:25.195924 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m20:51:25.214051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39051173-91db-47d7-a50c-a184e19d0721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D9447230>]}
[0m20:51:25.215274 [info ] [Thread-1 (]: 7 of 9 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.13s]
[0m20:51:25.216270 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m20:51:25.216842 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m20:51:25.217601 [info ] [Thread-1 (]: 8 of 9 START sql view model main.stg_products .................................. [RUN]
[0m20:51:25.218304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m20:51:25.218804 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m20:51:25.222441 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m20:51:25.223811 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m20:51:25.228765 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m20:51:25.230241 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:51:25.230874 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m20:51:25.231372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:25.245092 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:51:25.245727 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:51:25.246216 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:51:25.247268 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:51:25.251310 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:51:25.251914 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:51:25.252845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:51:25.257133 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:51:25.257720 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:51:25.258695 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:51:25.260799 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:51:25.261321 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:51:25.261779 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:51:25.266136 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:51:25.269367 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:51:25.269940 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m20:51:25.273969 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:51:25.276386 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m20:51:25.294393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39051173-91db-47d7-a50c-a184e19d0721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205DAC0B6B0>]}
[0m20:51:25.295341 [info ] [Thread-1 (]: 8 of 9 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.08s]
[0m20:51:25.296249 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m20:51:25.296833 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m20:51:25.297710 [info ] [Thread-1 (]: 9 of 9 START sql view model main.stg_shipping .................................. [RUN]
[0m20:51:25.298435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m20:51:25.298931 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m20:51:25.302267 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m20:51:25.303687 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m20:51:25.308671 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m20:51:25.310101 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:51:25.310723 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m20:51:25.311214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:25.324518 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:51:25.325137 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:51:25.325636 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:51:25.326725 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:51:25.330852 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:51:25.331489 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m20:51:25.332677 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:51:25.336559 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:51:25.337163 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m20:51:25.338119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:51:25.340200 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:51:25.340723 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:51:25.341181 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:51:25.345134 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:51:25.352829 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:51:25.353553 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m20:51:25.356922 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:51:25.359280 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m20:51:25.375075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39051173-91db-47d7-a50c-a184e19d0721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205DAC0B6B0>]}
[0m20:51:25.376144 [info ] [Thread-1 (]: 9 of 9 OK created sql view model main.stg_shipping ............................. [[32mOK[0m in 0.08s]
[0m20:51:25.377057 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m20:51:25.378882 [debug] [MainThread]: Using duckdb connection "master"
[0m20:51:25.379391 [debug] [MainThread]: On master: BEGIN
[0m20:51:25.379770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:51:25.392891 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:51:25.393451 [debug] [MainThread]: On master: COMMIT
[0m20:51:25.393842 [debug] [MainThread]: Using duckdb connection "master"
[0m20:51:25.394219 [debug] [MainThread]: On master: COMMIT
[0m20:51:25.394854 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:51:25.395282 [debug] [MainThread]: On master: Close
[0m20:51:25.398758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:25.399295 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:51:25.399649 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:51:25.399991 [debug] [MainThread]: Connection 'model.assignment_4.stg_shipping' was properly closed.
[0m20:51:25.400837 [info ] [MainThread]: 
[0m20:51:25.401323 [info ] [MainThread]: Finished running 5 seeds, 4 view models in 0 hours 0 minutes and 8.30 seconds (8.30s).
[0m20:51:25.404262 [debug] [MainThread]: Command end result
[0m20:51:25.454335 [info ] [MainThread]: 
[0m20:51:25.455440 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:51:25.456557 [info ] [MainThread]: 
[0m20:51:25.457523 [error] [MainThread]:   Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near ";"
[0m20:51:25.458243 [info ] [MainThread]: 
[0m20:51:25.458896 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m20:51:25.460869 [debug] [MainThread]: Command `dbt build` failed at 20:51:25.460514 after 9.44 seconds
[0m20:51:25.461661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D9447590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D8A0A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E0763FB0>]}
[0m20:51:25.462387 [debug] [MainThread]: Flushing usage events
[0m20:52:49.406533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D03D76EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0401C8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0401C8410>]}


============================== 20:52:49.412439 | 0d711e2d-9dbd-4a62-b677-531d4adfbbff ==============================
[0m20:52:49.412439 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:52:49.413740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:52:49.720719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d711e2d-9dbd-4a62-b677-531d4adfbbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D040540510>]}
[0m20:52:49.795017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d711e2d-9dbd-4a62-b677-531d4adfbbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D040177F00>]}
[0m20:52:49.801259 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:52:49.813191 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:52:50.008195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:52:50.009029 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\staging\stg_customers.sql
[0m20:52:50.322777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d711e2d-9dbd-4a62-b677-531d4adfbbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0403ACE50>]}
[0m20:52:50.447397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d711e2d-9dbd-4a62-b677-531d4adfbbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D04036FF20>]}
[0m20:52:50.448123 [info ] [MainThread]: Found 5 seeds, 4 models, 421 macros
[0m20:52:50.448866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d711e2d-9dbd-4a62-b677-531d4adfbbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D04181E270>]}
[0m20:52:50.450979 [info ] [MainThread]: 
[0m20:52:50.452114 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:52:50.453927 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:52:50.582173 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:52:50.582732 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:52:50.583144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:50.599015 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:52:50.600879 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:52:50.604556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:52:50.605308 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:52:50.614348 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:52:50.614901 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:52:50.615297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:50.629172 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:52:50.631087 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:52:50.631542 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:52:50.632224 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:52:50.632633 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:52:50.633025 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:52:50.633728 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:52:50.634932 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:52:50.635341 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:52:50.635720 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:52:50.636357 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:52:50.636787 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:52:50.647690 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:52:50.655353 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:52:50.655895 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:52:50.656274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:50.668975 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:52:50.669548 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:52:50.669987 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:52:50.726298 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m20:52:50.728407 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:52:50.730479 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:52:50.730964 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:52:50.737943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d711e2d-9dbd-4a62-b677-531d4adfbbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D041A8E8F0>]}
[0m20:52:50.738615 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:50.739028 [debug] [MainThread]: On master: BEGIN
[0m20:52:50.739398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:50.752411 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:52:50.752971 [debug] [MainThread]: On master: COMMIT
[0m20:52:50.753365 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:50.753751 [debug] [MainThread]: On master: COMMIT
[0m20:52:50.754392 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:52:50.754822 [debug] [MainThread]: On master: Close
[0m20:52:50.758850 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:50.759665 [info ] [MainThread]: 
[0m20:52:50.763896 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m20:52:50.765613 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_customers ................................. [RUN]
[0m20:52:50.766806 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.stg_customers'
[0m20:52:50.767410 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m20:52:50.777703 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m20:52:50.779107 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m20:52:50.832130 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m20:52:50.833759 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:52:50.834391 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m20:52:50.834855 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:52:50.848803 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:52:50.849431 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:52:50.849933 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    WITH cleaned_customers AS (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m20:52:50.850903 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    WITH cleaned_customers AS (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m20:52:50.851415 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:52:50.852017 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: ROLLBACK
[0m20:52:50.862184 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.stg_customers'
[0m20:52:50.862776 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m20:52:50.871780 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near ";"
[0m20:52:50.873967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d711e2d-9dbd-4a62-b677-531d4adfbbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0418BA090>]}
[0m20:52:50.874950 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.11s]
[0m20:52:50.876142 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m20:52:50.878840 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:50.879378 [debug] [MainThread]: On master: BEGIN
[0m20:52:50.879761 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:50.892778 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:52:50.893361 [debug] [MainThread]: On master: COMMIT
[0m20:52:50.893769 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:50.894149 [debug] [MainThread]: On master: COMMIT
[0m20:52:50.894773 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:52:50.895197 [debug] [MainThread]: On master: Close
[0m20:52:50.898082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:50.898592 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:52:50.898942 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:52:50.899286 [debug] [MainThread]: Connection 'model.assignment_4.stg_customers' was properly closed.
[0m20:52:50.899720 [info ] [MainThread]: 
[0m20:52:50.900578 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m20:52:50.902080 [debug] [MainThread]: Command end result
[0m20:52:50.945180 [info ] [MainThread]: 
[0m20:52:50.946180 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:52:50.947005 [info ] [MainThread]: 
[0m20:52:50.947936 [error] [MainThread]:   Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near ";"
[0m20:52:50.948741 [info ] [MainThread]: 
[0m20:52:50.949566 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:52:50.951926 [debug] [MainThread]: Command `dbt run` failed at 20:52:50.951569 after 1.80 seconds
[0m20:52:50.952839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D04184BB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D041B46670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D041B46CB0>]}
[0m20:52:50.953646 [debug] [MainThread]: Flushing usage events
[0m20:53:42.429255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3BBAF0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3B84F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3E5E07D0>]}


============================== 20:53:42.434584 | a71396ed-f340-4bb6-96ff-ddabadc91299 ==============================
[0m20:53:42.434584 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:53:42.435359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:53:42.750111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a71396ed-f340-4bb6-96ff-ddabadc91299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3F9AC510>]}
[0m20:53:42.829712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a71396ed-f340-4bb6-96ff-ddabadc91299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3E5BBF00>]}
[0m20:53:42.836250 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:53:42.849005 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:53:43.059617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:53:43.060804 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\staging\stg_customers.sql
[0m20:53:43.391448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a71396ed-f340-4bb6-96ff-ddabadc91299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3E7ECE50>]}
[0m20:53:43.554517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a71396ed-f340-4bb6-96ff-ddabadc91299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3E7AFD40>]}
[0m20:53:43.555282 [info ] [MainThread]: Found 5 seeds, 4 models, 421 macros
[0m20:53:43.558515 [info ] [MainThread]: 
[0m20:53:43.559443 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:53:43.567119 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:53:43.697464 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:53:43.698031 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:53:43.698450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:43.716512 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:53:43.718595 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:53:43.722556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:53:43.723296 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:53:43.732195 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:53:43.732755 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:53:43.733155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:43.747489 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:53:43.749402 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:53:43.749873 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:53:43.750572 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:53:43.750983 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:53:43.751557 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:53:43.752946 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:53:43.754731 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:53:43.755198 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:53:43.755587 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:53:43.756291 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:53:43.756736 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:53:43.762606 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:53:43.770718 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:53:43.771251 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:53:43.771626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:43.784756 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:53:43.785314 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:53:43.785841 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:53:43.842045 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m20:53:43.844126 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:53:43.846276 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:53:43.846774 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:53:43.853703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a71396ed-f340-4bb6-96ff-ddabadc91299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3FE6FCB0>]}
[0m20:53:43.854358 [debug] [MainThread]: Using duckdb connection "master"
[0m20:53:43.854773 [debug] [MainThread]: On master: BEGIN
[0m20:53:43.855139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:43.868354 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:53:43.868931 [debug] [MainThread]: On master: COMMIT
[0m20:53:43.869331 [debug] [MainThread]: Using duckdb connection "master"
[0m20:53:43.869714 [debug] [MainThread]: On master: COMMIT
[0m20:53:43.870438 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:53:43.870901 [debug] [MainThread]: On master: Close
[0m20:53:43.873812 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:53:43.874403 [info ] [MainThread]: 
[0m20:53:43.878093 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m20:53:43.878891 [info ] [Thread-1 (]: 1 of 9 START seed file main.customers .......................................... [RUN]
[0m20:53:43.885102 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m20:53:43.887035 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m20:53:43.887543 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m20:53:44.235933 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:53:44.236601 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m20:53:44.237198 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:53:44.250008 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:53:44.250630 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:53:44.251104 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m20:53:44.253001 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:53:44.271572 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:53:44.272200 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:53:44.335207 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m20:53:44.343373 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m20:53:44.369714 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:53:44.370386 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:53:44.370899 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:53:44.405741 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m20:53:44.408354 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m20:53:44.500153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71396ed-f340-4bb6-96ff-ddabadc91299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3FF27C70>]}
[0m20:53:44.500964 [info ] [Thread-1 (]: 1 of 9 OK loaded seed file main.customers ...................................... [[32mINSERT 51290[0m in 0.62s]
[0m20:53:44.502048 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m20:53:44.502803 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m20:53:44.503751 [info ] [Thread-1 (]: 2 of 9 START seed file main.locations .......................................... [RUN]
[0m20:53:44.504613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m20:53:44.505153 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m20:53:44.505715 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m20:53:44.960006 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:53:44.960611 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m20:53:44.961126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:44.973938 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:53:44.974553 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:53:44.975034 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m20:53:44.976744 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:53:44.978858 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:53:44.979595 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:53:45.084525 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m20:53:45.085583 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m20:53:45.088477 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:53:45.089072 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:53:45.089530 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:53:45.185060 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m20:53:45.186910 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m20:53:45.382148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71396ed-f340-4bb6-96ff-ddabadc91299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3FB713D0>]}
[0m20:53:45.382960 [info ] [Thread-1 (]: 2 of 9 OK loaded seed file main.locations ...................................... [[32mINSERT 51290[0m in 0.88s]
[0m20:53:45.383869 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m20:53:45.384429 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m20:53:45.385201 [info ] [Thread-1 (]: 3 of 9 START seed file main.orders ............................................. [RUN]
[0m20:53:45.385905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m20:53:45.386431 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m20:53:45.386980 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m20:53:48.428015 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:53:48.428619 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m20:53:48.429077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:48.442496 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:53:48.443117 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:53:48.443628 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m20:53:48.445600 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:53:48.447439 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:53:48.448088 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:53:48.787466 [debug] [Thread-1 (]: SQL status: OK in 0.339 seconds
[0m20:53:48.788461 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m20:53:48.791872 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:53:48.792478 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:53:48.792940 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:53:48.900875 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:53:48.902581 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m20:53:49.182586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71396ed-f340-4bb6-96ff-ddabadc91299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3FD85A70>]}
[0m20:53:49.183392 [info ] [Thread-1 (]: 3 of 9 OK loaded seed file main.orders ......................................... [[32mINSERT 51290[0m in 3.80s]
[0m20:53:49.184272 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m20:53:49.184852 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m20:53:49.185606 [info ] [Thread-1 (]: 4 of 9 START seed file main.products ........................................... [RUN]
[0m20:53:49.186393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m20:53:49.186947 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m20:53:49.187447 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m20:53:49.757961 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:53:49.758572 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m20:53:49.759024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:49.772597 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:53:49.773217 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:53:49.773699 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m20:53:49.775619 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:53:49.778379 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:53:49.778902 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:53:49.870672 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m20:53:49.871676 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m20:53:49.874518 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:53:49.875151 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:53:49.875626 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:53:49.958644 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m20:53:49.960134 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m20:53:50.140929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71396ed-f340-4bb6-96ff-ddabadc91299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3F995630>]}
[0m20:53:50.141737 [info ] [Thread-1 (]: 4 of 9 OK loaded seed file main.products ....................................... [[32mINSERT 51290[0m in 0.95s]
[0m20:53:50.142901 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m20:53:50.143785 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m20:53:50.144606 [info ] [Thread-1 (]: 5 of 9 START seed file main.shipping ........................................... [RUN]
[0m20:53:50.145443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m20:53:50.145934 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m20:53:50.146404 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m20:53:51.062477 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:53:51.063161 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m20:53:51.063627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:51.077233 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:53:51.077844 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:53:51.078670 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m20:53:51.080977 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:53:51.082796 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:53:51.083341 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:53:51.409193 [debug] [Thread-1 (]: SQL status: OK in 0.325 seconds
[0m20:53:51.410181 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m20:53:51.413163 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:53:51.413873 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:53:51.414368 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:53:51.490899 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m20:53:51.492752 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m20:53:51.615287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71396ed-f340-4bb6-96ff-ddabadc91299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F44E0F3D0>]}
[0m20:53:51.616092 [info ] [Thread-1 (]: 5 of 9 OK loaded seed file main.shipping ....................................... [[32mINSERT 51290[0m in 1.47s]
[0m20:53:51.616974 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m20:53:51.617552 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m20:53:51.618357 [info ] [Thread-1 (]: 6 of 9 START sql view model main.stg_customers ................................. [RUN]
[0m20:53:51.619203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m20:53:51.619723 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m20:53:51.630431 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m20:53:51.631960 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m20:53:51.676033 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m20:53:51.677576 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:53:51.678234 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m20:53:51.678714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:51.691919 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:53:51.692539 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:53:51.693028 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m20:53:51.694368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:53:51.706551 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:53:51.707159 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:53:51.708219 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:53:51.710241 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m20:53:51.710891 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:53:51.711386 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m20:53:51.715907 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:53:51.722747 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:53:51.723358 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m20:53:51.724300 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:53:51.726751 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m20:53:51.745922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71396ed-f340-4bb6-96ff-ddabadc91299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3FBC2B30>]}
[0m20:53:51.746916 [info ] [Thread-1 (]: 6 of 9 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.13s]
[0m20:53:51.747939 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m20:53:51.748746 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m20:53:51.749869 [info ] [Thread-1 (]: 7 of 9 START sql view model main.stg_orders .................................... [RUN]
[0m20:53:51.750745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_orders)
[0m20:53:51.751420 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m20:53:51.755248 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m20:53:51.756822 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m20:53:51.761743 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m20:53:51.763338 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:53:51.763946 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m20:53:51.764402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:51.777959 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:53:51.778572 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:53:51.779073 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m20:53:51.780286 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:53:51.784117 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:53:51.784699 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:53:51.785664 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:53:51.789784 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:53:51.790407 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:53:51.791410 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:53:51.796649 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:53:51.797235 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:53:51.797697 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:53:51.801880 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:53:51.805684 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:53:51.806261 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m20:53:51.809887 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:53:51.812312 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m20:53:51.830869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71396ed-f340-4bb6-96ff-ddabadc91299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F45516ED0>]}
[0m20:53:51.832119 [info ] [Thread-1 (]: 7 of 9 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.08s]
[0m20:53:51.833218 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m20:53:51.834334 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m20:53:51.836132 [info ] [Thread-1 (]: 8 of 9 START sql view model main.stg_products .................................. [RUN]
[0m20:53:51.837266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m20:53:51.838163 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m20:53:51.842368 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m20:53:51.844286 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m20:53:51.850151 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m20:53:51.852941 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:53:51.853832 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m20:53:51.854574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:51.868688 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:53:51.869602 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:53:51.870109 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:53:51.871541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:53:51.875485 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:53:51.876048 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:53:51.877045 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:53:51.880790 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:53:51.881365 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:53:51.882334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:53:51.890272 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:53:51.890939 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:53:51.891400 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:53:51.896204 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:53:51.900472 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:53:51.901108 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m20:53:51.904893 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:53:51.907397 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m20:53:51.924720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71396ed-f340-4bb6-96ff-ddabadc91299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4019BD10>]}
[0m20:53:51.925671 [info ] [Thread-1 (]: 8 of 9 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.09s]
[0m20:53:51.926544 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m20:53:51.927108 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m20:53:51.927864 [info ] [Thread-1 (]: 9 of 9 START sql view model main.stg_shipping .................................. [RUN]
[0m20:53:51.928530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m20:53:51.929027 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m20:53:51.933008 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m20:53:51.934886 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m20:53:51.939206 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m20:53:51.940746 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:53:51.941558 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m20:53:51.942257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:51.954927 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:53:51.955535 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:53:51.956038 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:53:51.957078 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:53:51.961442 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:53:51.962027 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m20:53:51.963059 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:53:51.966819 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:53:51.967430 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m20:53:51.968449 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:53:51.970539 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:53:51.971050 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:53:51.971505 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:53:51.976676 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:53:51.979880 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:53:51.980464 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m20:53:51.984476 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:53:51.986507 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m20:53:52.003761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71396ed-f340-4bb6-96ff-ddabadc91299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4019BE30>]}
[0m20:53:52.004723 [info ] [Thread-1 (]: 9 of 9 OK created sql view model main.stg_shipping ............................. [[32mOK[0m in 0.08s]
[0m20:53:52.005607 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m20:53:52.008269 [debug] [MainThread]: Using duckdb connection "master"
[0m20:53:52.008897 [debug] [MainThread]: On master: BEGIN
[0m20:53:52.009302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:53:52.022508 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:53:52.023063 [debug] [MainThread]: On master: COMMIT
[0m20:53:52.023458 [debug] [MainThread]: Using duckdb connection "master"
[0m20:53:52.023836 [debug] [MainThread]: On master: COMMIT
[0m20:53:52.024480 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:53:52.024907 [debug] [MainThread]: On master: Close
[0m20:53:52.028170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:52.028853 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:53:52.029230 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:53:52.029575 [debug] [MainThread]: Connection 'model.assignment_4.stg_shipping' was properly closed.
[0m20:53:52.030126 [info ] [MainThread]: 
[0m20:53:52.030612 [info ] [MainThread]: Finished running 5 seeds, 4 view models in 0 hours 0 minutes and 8.47 seconds (8.47s).
[0m20:53:52.033539 [debug] [MainThread]: Command end result
[0m20:53:52.086685 [info ] [MainThread]: 
[0m20:53:52.087698 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:53:52.088636 [info ] [MainThread]: 
[0m20:53:52.089477 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:53:52.091754 [debug] [MainThread]: Command `dbt build` succeeded at 20:53:52.091342 after 9.82 seconds
[0m20:53:52.092852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3FEE4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3E5B4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F45516ED0>]}
[0m20:53:52.094336 [debug] [MainThread]: Flushing usage events
[0m20:54:04.574486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C942B4F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9427FF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9455A07D0>]}


============================== 20:54:04.579890 | e612d982-1b67-4f4e-b966-f30c105248e9 ==============================
[0m20:54:04.579890 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:54:04.580663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:54:04.925748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e612d982-1b67-4f4e-b966-f30c105248e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C945958510>]}
[0m20:54:05.000677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e612d982-1b67-4f4e-b966-f30c105248e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C945577F00>]}
[0m20:54:05.008295 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:54:05.020088 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:54:05.213015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:54:05.213591 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:54:05.268046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e612d982-1b67-4f4e-b966-f30c105248e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9457AC150>]}
[0m20:54:05.421536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e612d982-1b67-4f4e-b966-f30c105248e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C945503B60>]}
[0m20:54:05.422284 [info ] [MainThread]: Found 5 seeds, 4 models, 421 macros
[0m20:54:05.425523 [info ] [MainThread]: 
[0m20:54:05.426360 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:54:05.433845 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:54:05.561287 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:54:05.561861 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:54:05.562268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:05.579266 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:54:05.581248 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:54:05.585298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:54:05.586373 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:54:05.595956 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:54:05.596515 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:54:05.596917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:05.610201 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:54:05.612144 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:54:05.612617 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:54:05.613323 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:54:05.613740 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:54:05.614120 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:54:05.614860 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:54:05.616080 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:54:05.616505 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:54:05.616885 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:54:05.617543 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:54:05.617971 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:54:05.623964 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:54:05.633039 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:54:05.633640 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:54:05.634274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:05.647232 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:54:05.647807 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:54:05.648224 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:54:05.711360 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m20:54:05.713564 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:54:05.715716 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:54:05.716317 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:54:05.724643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e612d982-1b67-4f4e-b966-f30c105248e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C946C5AB30>]}
[0m20:54:05.725304 [debug] [MainThread]: Using duckdb connection "master"
[0m20:54:05.725714 [debug] [MainThread]: On master: BEGIN
[0m20:54:05.726088 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:05.739635 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:54:05.740186 [debug] [MainThread]: On master: COMMIT
[0m20:54:05.740582 [debug] [MainThread]: Using duckdb connection "master"
[0m20:54:05.740957 [debug] [MainThread]: On master: COMMIT
[0m20:54:05.741573 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:54:05.742000 [debug] [MainThread]: On master: Close
[0m20:54:05.745253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:05.745848 [info ] [MainThread]: 
[0m20:54:05.750780 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m20:54:05.751658 [info ] [Thread-1 (]: 1 of 9 START seed file main.customers .......................................... [RUN]
[0m20:54:05.752503 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m20:54:05.752993 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m20:54:05.753510 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m20:54:06.095206 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:54:06.095825 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m20:54:06.096280 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:54:06.109184 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:54:06.109799 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:54:06.110272 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m20:54:06.112312 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:54:06.129549 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:54:06.130180 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:54:06.190584 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m20:54:06.200071 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m20:54:06.223066 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:54:06.223687 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:54:06.224154 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:54:06.275003 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m20:54:06.279358 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m20:54:06.370280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e612d982-1b67-4f4e-b966-f30c105248e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C946F9E340>]}
[0m20:54:06.371097 [info ] [Thread-1 (]: 1 of 9 OK loaded seed file main.customers ...................................... [[32mINSERT 51290[0m in 0.62s]
[0m20:54:06.372003 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m20:54:06.372582 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m20:54:06.373416 [info ] [Thread-1 (]: 2 of 9 START seed file main.locations .......................................... [RUN]
[0m20:54:06.374460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m20:54:06.375260 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m20:54:06.375769 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m20:54:06.836107 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:54:06.836718 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m20:54:06.837174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:06.850103 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:54:06.850723 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:54:06.851196 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m20:54:06.852958 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:54:06.854797 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:54:06.855328 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:54:06.950798 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m20:54:06.951808 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m20:54:06.955239 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:54:06.955842 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:54:06.956306 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:54:07.032830 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m20:54:07.034775 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m20:54:07.178521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e612d982-1b67-4f4e-b966-f30c105248e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C946DAD250>]}
[0m20:54:07.179349 [info ] [Thread-1 (]: 2 of 9 OK loaded seed file main.locations ...................................... [[32mINSERT 51290[0m in 0.80s]
[0m20:54:07.180633 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m20:54:07.181184 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m20:54:07.181964 [info ] [Thread-1 (]: 3 of 9 START seed file main.orders ............................................. [RUN]
[0m20:54:07.182634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m20:54:07.183115 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m20:54:07.183617 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m20:54:10.238267 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:54:10.238887 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m20:54:10.239338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:10.251904 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m20:54:10.252506 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:54:10.253021 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m20:54:10.254818 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:54:10.257339 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:54:10.257951 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:54:10.638401 [debug] [Thread-1 (]: SQL status: OK in 0.380 seconds
[0m20:54:10.639391 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m20:54:10.643406 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:54:10.644003 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:54:10.644469 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:54:10.744093 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m20:54:10.745395 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m20:54:10.933235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e612d982-1b67-4f4e-b966-f30c105248e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C946C2CF70>]}
[0m20:54:10.934049 [info ] [Thread-1 (]: 3 of 9 OK loaded seed file main.orders ......................................... [[32mINSERT 51290[0m in 3.75s]
[0m20:54:10.934915 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m20:54:10.935466 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m20:54:10.936244 [info ] [Thread-1 (]: 4 of 9 START seed file main.products ........................................... [RUN]
[0m20:54:10.937290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m20:54:10.938027 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m20:54:10.938500 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m20:54:11.498726 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:54:11.499438 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m20:54:11.499921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:11.513637 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:54:11.514326 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:54:11.514948 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m20:54:11.517081 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:54:11.519015 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:54:11.519786 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:54:11.602708 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m20:54:11.603704 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m20:54:11.606710 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:54:11.607319 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:54:11.607788 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:54:11.674114 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m20:54:11.675345 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m20:54:11.791318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e612d982-1b67-4f4e-b966-f30c105248e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9456B3930>]}
[0m20:54:11.792130 [info ] [Thread-1 (]: 4 of 9 OK loaded seed file main.products ....................................... [[32mINSERT 51290[0m in 0.85s]
[0m20:54:11.793002 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m20:54:11.793553 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m20:54:11.794343 [info ] [Thread-1 (]: 5 of 9 START seed file main.shipping ........................................... [RUN]
[0m20:54:11.795210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m20:54:11.795828 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m20:54:11.796316 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m20:54:12.647894 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:54:12.648434 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m20:54:12.648818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:12.659981 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:54:12.660519 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:54:12.660919 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m20:54:12.662368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:54:12.663913 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:54:12.664351 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:54:12.933500 [debug] [Thread-1 (]: SQL status: OK in 0.269 seconds
[0m20:54:12.934342 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m20:54:12.937126 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:54:12.937667 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:54:12.938044 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:54:12.989150 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m20:54:12.991018 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m20:54:13.084066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e612d982-1b67-4f4e-b966-f30c105248e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C95406F5D0>]}
[0m20:54:13.084718 [info ] [Thread-1 (]: 5 of 9 OK loaded seed file main.shipping ....................................... [[32mINSERT 51290[0m in 1.29s]
[0m20:54:13.085383 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m20:54:13.085811 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m20:54:13.086353 [info ] [Thread-1 (]: 6 of 9 START sql view model main.stg_customers ................................. [RUN]
[0m20:54:13.086994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m20:54:13.087410 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m20:54:13.095177 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m20:54:13.096678 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m20:54:13.133074 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m20:54:13.134439 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:54:13.134929 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m20:54:13.135272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:13.145618 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:54:13.146109 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:54:13.146483 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m20:54:13.147391 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:54:13.154447 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:54:13.154950 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:54:13.155774 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:54:13.158673 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:54:13.159107 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:54:13.159873 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:54:13.163901 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m20:54:13.164375 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:54:13.164720 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m20:54:13.175247 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:54:13.181289 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:54:13.181763 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m20:54:13.189080 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:54:13.191117 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m20:54:13.220360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e612d982-1b67-4f4e-b966-f30c105248e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9471148A0>]}
[0m20:54:13.221123 [info ] [Thread-1 (]: 6 of 9 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.13s]
[0m20:54:13.221789 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m20:54:13.222209 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m20:54:13.222655 [info ] [Thread-1 (]: 7 of 9 START sql view model main.stg_orders .................................... [RUN]
[0m20:54:13.223316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_orders)
[0m20:54:13.223701 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m20:54:13.226971 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m20:54:13.228279 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m20:54:13.231622 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m20:54:13.232936 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:54:13.233429 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m20:54:13.233762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:13.243869 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:54:13.244362 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:54:13.244729 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m20:54:13.245647 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:54:13.248804 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:54:13.249331 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:54:13.250106 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:54:13.253390 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:54:13.253841 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:54:13.254598 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:54:13.257873 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:54:13.258333 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:54:13.258674 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:54:13.268535 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:54:13.271482 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:54:13.271947 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m20:54:13.279779 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:54:13.282156 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m20:54:13.314018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e612d982-1b67-4f4e-b966-f30c105248e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9490C6630>]}
[0m20:54:13.315738 [info ] [Thread-1 (]: 7 of 9 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.09s]
[0m20:54:13.316947 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m20:54:13.317579 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m20:54:13.318326 [info ] [Thread-1 (]: 8 of 9 START sql view model main.stg_products .................................. [RUN]
[0m20:54:13.319640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m20:54:13.320152 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m20:54:13.323162 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m20:54:13.324344 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m20:54:13.328179 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m20:54:13.329461 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:54:13.330090 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m20:54:13.330734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:13.341881 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:54:13.342365 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:54:13.342785 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:54:13.343647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:54:13.346607 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:54:13.347034 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:54:13.347845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:54:13.351706 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:54:13.352303 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:54:13.353070 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:54:13.354728 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:54:13.355131 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:54:13.355473 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:54:13.362443 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:54:13.366011 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:54:13.366461 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m20:54:13.372441 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:54:13.375188 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m20:54:13.398691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e612d982-1b67-4f4e-b966-f30c105248e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C94701B950>]}
[0m20:54:13.399492 [info ] [Thread-1 (]: 8 of 9 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.08s]
[0m20:54:13.400217 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m20:54:13.400659 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m20:54:13.401228 [info ] [Thread-1 (]: 9 of 9 START sql view model main.stg_shipping .................................. [RUN]
[0m20:54:13.401992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m20:54:13.402368 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m20:54:13.405032 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m20:54:13.406301 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m20:54:13.414445 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m20:54:13.415841 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:54:13.416356 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m20:54:13.416771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:13.428128 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:54:13.428676 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:54:13.429049 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:54:13.429989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:54:13.433123 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:54:13.433572 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m20:54:13.434375 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:54:13.437257 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:54:13.437692 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m20:54:13.438455 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:54:13.440076 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:54:13.440471 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:54:13.440826 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:54:13.445971 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:54:13.450544 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:54:13.451039 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m20:54:13.455814 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:54:13.457800 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m20:54:13.476366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e612d982-1b67-4f4e-b966-f30c105248e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C94701B830>]}
[0m20:54:13.477144 [info ] [Thread-1 (]: 9 of 9 OK created sql view model main.stg_shipping ............................. [[32mOK[0m in 0.07s]
[0m20:54:13.477839 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m20:54:13.479636 [debug] [MainThread]: Using duckdb connection "master"
[0m20:54:13.480052 [debug] [MainThread]: On master: BEGIN
[0m20:54:13.480343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:13.490565 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m20:54:13.491019 [debug] [MainThread]: On master: COMMIT
[0m20:54:13.491316 [debug] [MainThread]: Using duckdb connection "master"
[0m20:54:13.491599 [debug] [MainThread]: On master: COMMIT
[0m20:54:13.492116 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:54:13.492443 [debug] [MainThread]: On master: Close
[0m20:54:13.495109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:13.495550 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:54:13.495821 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:54:13.496080 [debug] [MainThread]: Connection 'model.assignment_4.stg_shipping' was properly closed.
[0m20:54:13.496486 [info ] [MainThread]: 
[0m20:54:13.496847 [info ] [MainThread]: Finished running 5 seeds, 4 view models in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m20:54:13.499199 [debug] [MainThread]: Command end result
[0m20:54:13.534099 [info ] [MainThread]: 
[0m20:54:13.534896 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:54:13.535547 [info ] [MainThread]: 
[0m20:54:13.536163 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:54:13.537599 [debug] [MainThread]: Command `dbt build` succeeded at 20:54:13.537351 after 9.12 seconds
[0m20:54:13.538166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C944DC2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C94557BEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C946D3EE70>]}
[0m20:54:13.538721 [debug] [MainThread]: Flushing usage events
[0m20:55:59.961054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F4E916E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F51378550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F51378410>]}


============================== 20:55:59.966365 | 358f238f-ad1a-413e-91a7-06fd5f21961f ==============================
[0m20:55:59.966365 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:55:59.967664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m20:56:00.279516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '358f238f-ad1a-413e-91a7-06fd5f21961f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F526E0510>]}
[0m20:56:00.352957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '358f238f-ad1a-413e-91a7-06fd5f21961f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F51327F00>]}
[0m20:56:00.358891 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:56:00.371809 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:56:00.568405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:56:00.568933 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:56:00.619272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '358f238f-ad1a-413e-91a7-06fd5f21961f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5155C150>]}
[0m20:56:00.749670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '358f238f-ad1a-413e-91a7-06fd5f21961f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5151FD40>]}
[0m20:56:00.750740 [info ] [MainThread]: Found 5 seeds, 4 models, 421 macros
[0m20:56:00.751837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '358f238f-ad1a-413e-91a7-06fd5f21961f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F515BCE50>]}
[0m20:56:00.754096 [info ] [MainThread]: 
[0m20:56:00.755161 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:56:00.756675 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:56:00.892135 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:56:00.892698 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:56:00.893105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:00.909571 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:56:00.911516 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:56:00.915274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:56:00.916031 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:56:00.925739 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:56:00.926617 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:56:00.927293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:00.941148 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:56:00.943194 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:56:00.943817 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:56:00.944640 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:00.945067 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:56:00.945459 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:56:00.946182 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:00.947396 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:56:00.947819 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:56:00.948198 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:56:00.948864 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:00.949293 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:56:00.961208 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:56:00.969410 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:56:00.969944 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:56:00.970323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:00.983187 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:56:00.983738 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:56:00.984157 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:56:01.052151 [debug] [ThreadPool]: SQL status: OK in 0.067 seconds
[0m20:56:01.054275 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:56:01.056336 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:56:01.056819 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:56:01.065447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '358f238f-ad1a-413e-91a7-06fd5f21961f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F52AA3BA0>]}
[0m20:56:01.066123 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:01.066529 [debug] [MainThread]: On master: BEGIN
[0m20:56:01.066902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:01.080072 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:56:01.080625 [debug] [MainThread]: On master: COMMIT
[0m20:56:01.081019 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:01.081398 [debug] [MainThread]: On master: COMMIT
[0m20:56:01.082024 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:56:01.082448 [debug] [MainThread]: On master: Close
[0m20:56:01.085828 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:01.086704 [info ] [MainThread]: 
[0m20:56:01.091851 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m20:56:01.092664 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_customers ................................. [RUN]
[0m20:56:01.093698 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.stg_customers'
[0m20:56:01.094520 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m20:56:01.106727 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m20:56:01.108131 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m20:56:01.154204 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m20:56:01.155695 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:56:01.156306 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m20:56:01.156769 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:56:01.169976 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:56:01.170698 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:56:01.171271 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m20:56:01.172444 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:01.180701 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:56:01.181298 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:56:01.182285 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:01.187450 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:56:01.188084 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:56:01.189021 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:01.212904 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m20:56:01.213521 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:56:01.213998 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m20:56:01.256417 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m20:56:01.263738 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:56:01.264356 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m20:56:01.268018 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:01.271258 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m20:56:01.291168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '358f238f-ad1a-413e-91a7-06fd5f21961f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F52B21A90>]}
[0m20:56:01.292122 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.20s]
[0m20:56:01.293442 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m20:56:01.295704 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:01.296270 [debug] [MainThread]: On master: BEGIN
[0m20:56:01.296679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:01.310322 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m20:56:01.310956 [debug] [MainThread]: On master: COMMIT
[0m20:56:01.311355 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:01.311737 [debug] [MainThread]: On master: COMMIT
[0m20:56:01.312436 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:56:01.312863 [debug] [MainThread]: On master: Close
[0m20:56:01.316466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:01.317115 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:56:01.317490 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:56:01.317852 [debug] [MainThread]: Connection 'model.assignment_4.stg_customers' was properly closed.
[0m20:56:01.318366 [info ] [MainThread]: 
[0m20:56:01.319285 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m20:56:01.320564 [debug] [MainThread]: Command end result
[0m20:56:01.360989 [info ] [MainThread]: 
[0m20:56:01.362136 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:56:01.362884 [info ] [MainThread]: 
[0m20:56:01.363647 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:56:01.365180 [debug] [MainThread]: Command `dbt run` succeeded at 20:56:01.364966 after 1.67 seconds
[0m20:56:01.365714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F528F2E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F52CCBC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F52CCBCF0>]}
[0m20:56:01.366200 [debug] [MainThread]: Flushing usage events
[0m20:58:52.196469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FEEEF0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FEB9F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213819307D0>]}


============================== 20:58:52.202128 | c7c6741e-6335-4b19-9339-b6cf254d3e0d ==============================
[0m20:58:52.202128 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:58:52.202910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:58:52.520225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021381CF8510>]}
[0m20:58:52.604868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021381907F00>]}
[0m20:58:52.610952 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:58:52.623462 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:58:52.821879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:58:52.823029 [debug] [MainThread]: Partial parsing: added file: assignment_4://models\staging\stg_locations.sql
[0m20:58:53.156451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021381B3CE50>]}
[0m20:58:53.306895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021381893B60>]}
[0m20:58:53.307651 [info ] [MainThread]: Found 5 seeds, 5 models, 421 macros
[0m20:58:53.311762 [info ] [MainThread]: 
[0m20:58:53.312624 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:58:53.323139 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:58:53.454391 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:58:53.454957 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:58:53.455367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:53.472462 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:58:53.474356 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:58:53.478454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:58:53.479493 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:58:53.488762 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:58:53.489329 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:58:53.489833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:53.505104 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m20:58:53.507064 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:58:53.507564 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:58:53.508274 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:58:53.508687 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:58:53.509105 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:58:53.509928 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:58:53.511377 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:58:53.511963 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:58:53.512558 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:58:53.513871 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:58:53.514697 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:58:53.520540 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:58:53.529625 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:58:53.530579 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:58:53.531070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:53.544761 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:58:53.545358 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:58:53.545781 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:58:53.607782 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m20:58:53.610748 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:58:53.616539 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:58:53.618012 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:58:53.626490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213831FFD90>]}
[0m20:58:53.627170 [debug] [MainThread]: Using duckdb connection "master"
[0m20:58:53.627611 [debug] [MainThread]: On master: BEGIN
[0m20:58:53.628007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:53.642846 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m20:58:53.643412 [debug] [MainThread]: On master: COMMIT
[0m20:58:53.643807 [debug] [MainThread]: Using duckdb connection "master"
[0m20:58:53.644190 [debug] [MainThread]: On master: COMMIT
[0m20:58:53.645044 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:58:53.645587 [debug] [MainThread]: On master: Close
[0m20:58:53.649102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:58:53.649760 [info ] [MainThread]: 
[0m20:58:53.653903 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m20:58:53.654728 [info ] [Thread-1 (]: 1 of 10 START seed file main.customers ......................................... [RUN]
[0m20:58:53.656777 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m20:58:53.657376 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m20:58:53.657885 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m20:58:54.010791 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:58:54.011422 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m20:58:54.011896 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:58:54.024766 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:58:54.025399 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:58:54.025887 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m20:58:54.027690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:58:54.044933 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:58:54.045561 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:58:54.111451 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m20:58:54.121304 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m20:58:54.147677 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:58:54.149725 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:58:54.150476 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:58:54.206527 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m20:58:54.209471 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m20:58:54.299308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213832ABA00>]}
[0m20:58:54.300187 [info ] [Thread-1 (]: 1 of 10 OK loaded seed file main.customers ..................................... [[32mINSERT 51290[0m in 0.64s]
[0m20:58:54.301277 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m20:58:54.301968 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m20:58:54.303082 [info ] [Thread-1 (]: 2 of 10 START seed file main.locations ......................................... [RUN]
[0m20:58:54.304065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m20:58:54.304660 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m20:58:54.305158 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m20:58:54.791475 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:58:54.792090 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m20:58:54.792547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:54.805467 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:58:54.806086 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:58:54.806567 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m20:58:54.808280 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:58:54.810112 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:58:54.810663 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:58:54.903589 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m20:58:54.904593 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m20:58:54.907491 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:58:54.908101 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:58:54.908556 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:58:54.997260 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m20:58:54.998848 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m20:58:55.201722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021382F010D0>]}
[0m20:58:55.202540 [info ] [Thread-1 (]: 2 of 10 OK loaded seed file main.locations ..................................... [[32mINSERT 51290[0m in 0.90s]
[0m20:58:55.203429 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m20:58:55.203998 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m20:58:55.205001 [info ] [Thread-1 (]: 3 of 10 START seed file main.orders ............................................ [RUN]
[0m20:58:55.206448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m20:58:55.207035 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m20:58:55.207865 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m20:58:58.456935 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:58:58.457543 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m20:58:58.457999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:58.471161 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:58:58.471768 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:58:58.472372 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m20:58:58.474967 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:58:58.476834 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:58:58.477432 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:58:58.827697 [debug] [Thread-1 (]: SQL status: OK in 0.350 seconds
[0m20:58:58.828624 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m20:58:58.831191 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:58:58.831760 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:58:58.832181 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:58:58.944344 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:58:58.946232 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m20:58:59.168651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021383115A70>]}
[0m20:58:59.169382 [info ] [Thread-1 (]: 3 of 10 OK loaded seed file main.orders ........................................ [[32mINSERT 51290[0m in 3.96s]
[0m20:58:59.170148 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m20:58:59.170858 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m20:58:59.171554 [info ] [Thread-1 (]: 4 of 10 START seed file main.products .......................................... [RUN]
[0m20:58:59.172283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m20:58:59.172707 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m20:58:59.173094 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m20:58:59.656365 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:58:59.656964 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m20:58:59.657341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:59.667728 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:58:59.668228 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:58:59.668593 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m20:58:59.670020 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:58:59.671521 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:58:59.671956 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:58:59.733738 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m20:58:59.734554 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m20:58:59.738023 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:58:59.738508 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:58:59.738862 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:58:59.810903 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m20:58:59.811867 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m20:58:59.913050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021381CC9630>]}
[0m20:58:59.913707 [info ] [Thread-1 (]: 4 of 10 OK loaded seed file main.products ...................................... [[32mINSERT 51290[0m in 0.74s]
[0m20:58:59.914375 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m20:58:59.914793 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m20:58:59.915279 [info ] [Thread-1 (]: 5 of 10 START seed file main.shipping .......................................... [RUN]
[0m20:58:59.915770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m20:58:59.916292 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m20:58:59.916936 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m20:59:00.660253 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:59:00.660771 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m20:59:00.661103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:00.671076 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:59:00.671573 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:59:00.671929 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m20:59:00.674373 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:59:00.676081 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:59:00.676515 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:59:00.889882 [debug] [Thread-1 (]: SQL status: OK in 0.213 seconds
[0m20:59:00.890653 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m20:59:00.892863 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:59:00.893336 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:59:00.893691 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:59:00.958705 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m20:59:00.960246 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m20:59:01.047668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213904F3B50>]}
[0m20:59:01.048292 [info ] [Thread-1 (]: 5 of 10 OK loaded seed file main.shipping ...................................... [[32mINSERT 51290[0m in 1.13s]
[0m20:59:01.048903 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m20:59:01.049306 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m20:59:01.049761 [info ] [Thread-1 (]: 6 of 10 START sql view model main.stg_customers ................................ [RUN]
[0m20:59:01.050204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m20:59:01.050735 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m20:59:01.058095 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m20:59:01.059354 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m20:59:01.093489 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m20:59:01.095666 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:59:01.096506 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m20:59:01.097211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:01.107099 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:59:01.107700 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:59:01.108089 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m20:59:01.109033 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:01.116348 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:59:01.116831 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:59:01.117686 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:01.120583 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:59:01.121017 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:59:01.122613 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:01.126850 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m20:59:01.127313 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:59:01.127647 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m20:59:01.131236 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:59:01.136843 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:59:01.137312 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m20:59:01.140573 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:59:01.142703 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m20:59:01.157998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021382F50590>]}
[0m20:59:01.158729 [info ] [Thread-1 (]: 6 of 10 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.11s]
[0m20:59:01.159380 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m20:59:01.159860 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_locations
[0m20:59:01.160521 [info ] [Thread-1 (]: 7 of 10 START sql view model main.stg_locations ................................ [RUN]
[0m20:59:01.161024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_locations)
[0m20:59:01.161392 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_locations
[0m20:59:01.164550 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_locations"
[0m20:59:01.165816 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_locations
[0m20:59:01.169030 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_locations"
[0m20:59:01.170317 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m20:59:01.170804 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: BEGIN
[0m20:59:01.171126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:01.180977 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:59:01.181448 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m20:59:01.181799 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */

  
  create view "assignment_4"."main"."stg_locations__dbt_tmp" as (
    SELECT
    DISTINCT                         -- Remove duplicates from the dataset
    TRIM("City") AS city,           -- Trim any extra spaces from city names
    TRIM("State") AS state,         -- Trim any extra spaces from state names
    TRIM("Region") AS region,       -- Trim any extra spaces from region names
    TRIM("Country") AS country,     -- Trim any extra spaces from country names
    "Order.ID" AS order_id          -- Keeping order ID as is
FROM "assignment_4"."main"."locations"
  );

[0m20:59:01.182688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:01.185539 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m20:59:01.186011 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m20:59:01.187139 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:01.189659 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m20:59:01.190081 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m20:59:01.190420 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m20:59:01.195421 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:59:01.197735 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m20:59:01.198135 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
drop view if exists "assignment_4"."main"."stg_locations__dbt_backup" cascade
[0m20:59:01.198809 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:01.200170 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: Close
[0m20:59:01.214648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021388887F50>]}
[0m20:59:01.215383 [info ] [Thread-1 (]: 7 of 10 OK created sql view model main.stg_locations ........................... [[32mOK[0m in 0.05s]
[0m20:59:01.216006 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_locations
[0m20:59:01.216458 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m20:59:01.216898 [info ] [Thread-1 (]: 8 of 10 START sql view model main.stg_orders ................................... [RUN]
[0m20:59:01.217580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_locations, now model.assignment_4.stg_orders)
[0m20:59:01.217978 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m20:59:01.220529 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m20:59:01.221778 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m20:59:01.225399 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m20:59:01.226844 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:59:01.227349 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m20:59:01.227684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:01.237654 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:59:01.238137 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:59:01.238495 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m20:59:01.239419 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:01.242251 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:59:01.242661 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:59:01.243395 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:01.246200 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:59:01.246635 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:59:01.247437 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:01.248986 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:59:01.249574 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:59:01.249896 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:59:01.253620 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:59:01.256783 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:59:01.257252 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m20:59:01.260737 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:59:01.263278 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m20:59:01.280446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021383527B30>]}
[0m20:59:01.281369 [info ] [Thread-1 (]: 8 of 10 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.06s]
[0m20:59:01.282070 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m20:59:01.282474 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m20:59:01.282996 [info ] [Thread-1 (]: 9 of 10 START sql view model main.stg_products ................................. [RUN]
[0m20:59:01.283507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m20:59:01.284183 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m20:59:01.287269 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m20:59:01.288788 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m20:59:01.292501 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m20:59:01.294794 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:59:01.295568 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m20:59:01.296138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:01.309247 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:59:01.309745 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:59:01.310326 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:59:01.312008 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:01.315533 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:59:01.315986 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:59:01.316722 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:01.319579 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:59:01.320005 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:59:01.320721 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:01.322207 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:59:01.322580 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:59:01.322907 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:59:01.326619 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:59:01.330291 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:59:01.330710 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m20:59:01.334748 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:59:01.336286 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m20:59:01.351797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021383527C50>]}
[0m20:59:01.352542 [info ] [Thread-1 (]: 9 of 10 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.07s]
[0m20:59:01.353171 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m20:59:01.353647 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m20:59:01.354245 [info ] [Thread-1 (]: 10 of 10 START sql view model main.stg_shipping ................................ [RUN]
[0m20:59:01.354761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m20:59:01.355102 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m20:59:01.358023 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m20:59:01.359546 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m20:59:01.363336 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m20:59:01.364571 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:59:01.365190 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m20:59:01.365691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:01.376906 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:59:01.377389 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:59:01.377732 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:59:01.378532 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:01.381365 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:59:01.381774 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m20:59:01.382942 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:01.385711 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:59:01.386116 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m20:59:01.386846 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:01.388355 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:59:01.388750 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:59:01.389068 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:59:01.393922 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:59:01.396574 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:59:01.396948 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m20:59:01.400133 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:59:01.402181 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m20:59:01.418136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c6741e-6335-4b19-9339-b6cf254d3e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021383527B30>]}
[0m20:59:01.418864 [info ] [Thread-1 (]: 10 of 10 OK created sql view model main.stg_shipping ........................... [[32mOK[0m in 0.06s]
[0m20:59:01.419547 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m20:59:01.421479 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:01.421873 [debug] [MainThread]: On master: BEGIN
[0m20:59:01.422142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:59:01.432155 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m20:59:01.432587 [debug] [MainThread]: On master: COMMIT
[0m20:59:01.432859 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:01.433130 [debug] [MainThread]: On master: COMMIT
[0m20:59:01.433589 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:59:01.433887 [debug] [MainThread]: On master: Close
[0m20:59:01.436343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:01.436735 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:59:01.436987 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:59:01.437267 [debug] [MainThread]: Connection 'model.assignment_4.stg_shipping' was properly closed.
[0m20:59:01.437663 [info ] [MainThread]: 
[0m20:59:01.438004 [info ] [MainThread]: Finished running 5 seeds, 5 view models in 0 hours 0 minutes and 8.13 seconds (8.13s).
[0m20:59:01.440215 [debug] [MainThread]: Command end result
[0m20:59:01.470620 [info ] [MainThread]: 
[0m20:59:01.471284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:59:01.471746 [info ] [MainThread]: 
[0m20:59:01.472230 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m20:59:01.473328 [debug] [MainThread]: Command `dbt build` succeeded at 20:59:01.473169 after 9.50 seconds
[0m20:59:01.473716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021381652E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002138362AB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021383037AD0>]}
[0m20:59:01.474079 [debug] [MainThread]: Flushing usage events
[0m20:59:18.352457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119CFF30E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119CC9F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119FA307D0>]}


============================== 20:59:18.358601 | 82611e66-63ef-46eb-b7c7-89f32140be58 ==============================
[0m20:59:18.358601 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:59:18.359737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:59:18.687126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A0E7C510>]}
[0m20:59:18.772134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119FA0BF00>]}
[0m20:59:18.778509 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m20:59:18.791389 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:59:19.003997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:59:19.004831 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\staging\stg_locations.sql
[0m20:59:19.333836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119FC3D050>]}
[0m20:59:19.477597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119F993B60>]}
[0m20:59:19.478370 [info ] [MainThread]: Found 5 seeds, 5 models, 421 macros
[0m20:59:19.481813 [info ] [MainThread]: 
[0m20:59:19.482659 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:59:19.490448 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m20:59:19.629289 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m20:59:19.630040 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m20:59:19.630737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:19.647922 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:59:19.649836 [debug] [ThreadPool]: On list_assignment_4: Close
[0m20:59:19.653633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m20:59:19.654470 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m20:59:19.663765 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:59:19.664384 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m20:59:19.664846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:19.679739 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m20:59:19.681721 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:59:19.682193 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m20:59:19.682907 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:59:19.683356 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:59:19.683754 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m20:59:19.684494 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:59:19.685792 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:59:19.686280 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m20:59:19.686666 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m20:59:19.687370 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:59:19.687802 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m20:59:19.693875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m20:59:19.701756 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:59:19.702305 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m20:59:19.702681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:19.715821 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:59:19.716381 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m20:59:19.716792 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m20:59:19.774271 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m20:59:19.776387 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m20:59:19.778444 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m20:59:19.778930 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m20:59:19.786241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A133FD90>]}
[0m20:59:19.786899 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:19.787394 [debug] [MainThread]: On master: BEGIN
[0m20:59:19.787853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:19.800955 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:59:19.801508 [debug] [MainThread]: On master: COMMIT
[0m20:59:19.801903 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:19.802373 [debug] [MainThread]: On master: COMMIT
[0m20:59:19.803023 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:59:19.803959 [debug] [MainThread]: On master: Close
[0m20:59:19.808693 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:59:19.809321 [info ] [MainThread]: 
[0m20:59:19.813211 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m20:59:19.814005 [info ] [Thread-1 (]: 1 of 10 START seed file main.customers ......................................... [RUN]
[0m20:59:19.815709 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m20:59:19.816312 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m20:59:19.816803 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m20:59:20.174286 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:59:20.175185 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m20:59:20.175722 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:59:20.188243 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m20:59:20.188861 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:59:20.189335 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m20:59:20.191007 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:20.208821 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:59:20.209446 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:59:20.271353 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m20:59:20.279435 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m20:59:20.302185 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:59:20.302809 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m20:59:20.303279 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m20:59:20.372561 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m20:59:20.377141 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m20:59:20.457180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A153F930>]}
[0m20:59:20.458321 [info ] [Thread-1 (]: 1 of 10 OK loaded seed file main.customers ..................................... [[32mINSERT 51290[0m in 0.64s]
[0m20:59:20.459504 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m20:59:20.460174 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m20:59:20.461181 [info ] [Thread-1 (]: 2 of 10 START seed file main.locations ......................................... [RUN]
[0m20:59:20.462418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m20:59:20.463381 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m20:59:20.464467 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m20:59:20.918885 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:59:20.919585 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m20:59:20.920055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:20.933145 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:59:20.933793 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:59:20.934281 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m20:59:20.935990 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:20.937830 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:59:20.938382 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:59:21.041108 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m20:59:21.042133 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m20:59:21.046138 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:59:21.046851 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m20:59:21.047395 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m20:59:21.141899 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m20:59:21.143391 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m20:59:21.262842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A10453D0>]}
[0m20:59:21.263730 [info ] [Thread-1 (]: 2 of 10 OK loaded seed file main.locations ..................................... [[32mINSERT 51290[0m in 0.80s]
[0m20:59:21.264683 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m20:59:21.265240 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m20:59:21.266207 [info ] [Thread-1 (]: 3 of 10 START seed file main.orders ............................................ [RUN]
[0m20:59:21.267073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m20:59:21.267601 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m20:59:21.268077 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m20:59:24.491544 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:59:24.492281 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m20:59:24.493036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:24.507098 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:59:24.508055 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:59:24.508716 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m20:59:24.510552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:24.512551 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:59:24.513228 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:59:24.872598 [debug] [Thread-1 (]: SQL status: OK in 0.359 seconds
[0m20:59:24.873831 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m20:59:24.877527 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:59:24.878133 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m20:59:24.878734 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m20:59:24.996835 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m20:59:24.998039 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m20:59:25.204718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A12559C0>]}
[0m20:59:25.205558 [info ] [Thread-1 (]: 3 of 10 OK loaded seed file main.orders ........................................ [[32mINSERT 51290[0m in 3.94s]
[0m20:59:25.206484 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m20:59:25.207094 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m20:59:25.208029 [info ] [Thread-1 (]: 4 of 10 START seed file main.products .......................................... [RUN]
[0m20:59:25.209234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m20:59:25.209886 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m20:59:25.210567 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m20:59:25.784125 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:59:25.784908 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m20:59:25.785422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:25.801980 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:59:25.802870 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:59:25.803650 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m20:59:25.806443 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:59:25.809283 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:59:25.809988 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:59:25.907994 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m20:59:25.909498 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m20:59:25.913790 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:59:25.914720 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m20:59:25.915597 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m20:59:25.962873 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m20:59:25.964477 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m20:59:26.067989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A0E69630>]}
[0m20:59:26.068747 [info ] [Thread-1 (]: 4 of 10 OK loaded seed file main.products ...................................... [[32mINSERT 51290[0m in 0.86s]
[0m20:59:26.069656 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m20:59:26.070286 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m20:59:26.071058 [info ] [Thread-1 (]: 5 of 10 START seed file main.shipping .......................................... [RUN]
[0m20:59:26.071942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m20:59:26.072568 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m20:59:26.073128 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m20:59:26.893955 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:59:26.894423 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m20:59:26.894755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:26.907188 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m20:59:26.907791 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:59:26.908185 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m20:59:26.909524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:26.910888 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:59:26.911273 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:59:27.087298 [debug] [Thread-1 (]: SQL status: OK in 0.176 seconds
[0m20:59:27.088056 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m20:59:27.092434 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:59:27.093404 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m20:59:27.094468 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m20:59:27.162333 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m20:59:27.163328 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m20:59:27.227368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211AE637B50>]}
[0m20:59:27.227990 [info ] [Thread-1 (]: 5 of 10 OK loaded seed file main.shipping ...................................... [[32mINSERT 51290[0m in 1.16s]
[0m20:59:27.228605 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m20:59:27.229033 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m20:59:27.229651 [info ] [Thread-1 (]: 6 of 10 START sql view model main.stg_customers ................................ [RUN]
[0m20:59:27.230149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m20:59:27.230504 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m20:59:27.237840 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m20:59:27.239002 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m20:59:27.272159 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m20:59:27.273396 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:59:27.273875 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m20:59:27.274205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:27.283837 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:59:27.284308 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:59:27.284645 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m20:59:27.285475 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:27.292254 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:59:27.292710 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:59:27.293601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:27.296586 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:59:27.297007 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:59:27.297721 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:27.301507 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m20:59:27.301951 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:59:27.302287 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m20:59:27.306396 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:59:27.312415 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m20:59:27.312873 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m20:59:27.315905 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:59:27.317958 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m20:59:27.331783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A13D08A0>]}
[0m20:59:27.332612 [info ] [Thread-1 (]: 6 of 10 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.10s]
[0m20:59:27.333410 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m20:59:27.333959 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_locations
[0m20:59:27.334614 [info ] [Thread-1 (]: 7 of 10 START sql view model main.stg_locations ................................ [RUN]
[0m20:59:27.335227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_locations)
[0m20:59:27.335925 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_locations
[0m20:59:27.340296 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_locations"
[0m20:59:27.342352 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_locations
[0m20:59:27.347957 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_locations"
[0m20:59:27.349485 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m20:59:27.349979 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: BEGIN
[0m20:59:27.350323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:27.361255 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:59:27.361773 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m20:59:27.362237 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */

  
  create view "assignment_4"."main"."stg_locations__dbt_tmp" as (
    SELECT
    DISTINCT
    TRIM("City") AS city,
    TRIM("State") AS state,         -- Trim any extra spaces from state names
    TRIM("Region") AS region,       -- Trim any extra spaces from region names
    TRIM("Country") AS country,     -- Trim any extra spaces from country names
    "Order.ID" AS order_id          -- Keeping order ID as is
FROM "assignment_4"."main"."locations"
  );

[0m20:59:27.363216 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:27.366119 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m20:59:27.366547 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations" rename to "stg_locations__dbt_backup"
[0m20:59:27.367250 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:27.370425 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m20:59:27.370876 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m20:59:27.371575 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:27.373097 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m20:59:27.373520 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m20:59:27.373998 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m20:59:27.378113 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:59:27.380405 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m20:59:27.380806 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
drop view if exists "assignment_4"."main"."stg_locations__dbt_backup" cascade
[0m20:59:27.383823 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:59:27.385906 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: Close
[0m20:59:27.400855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A118F7D0>]}
[0m20:59:27.401586 [info ] [Thread-1 (]: 7 of 10 OK created sql view model main.stg_locations ........................... [[32mOK[0m in 0.07s]
[0m20:59:27.402218 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_locations
[0m20:59:27.402616 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m20:59:27.403139 [info ] [Thread-1 (]: 8 of 10 START sql view model main.stg_orders ................................... [RUN]
[0m20:59:27.403621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_locations, now model.assignment_4.stg_orders)
[0m20:59:27.404007 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m20:59:27.406630 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m20:59:27.407879 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m20:59:27.411509 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m20:59:27.412906 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:59:27.413383 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m20:59:27.413699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:27.422929 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:59:27.423404 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:59:27.423752 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m20:59:27.424666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:27.427505 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:59:27.427925 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:59:27.428653 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:27.432125 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:59:27.432709 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:59:27.433795 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:27.435665 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:59:27.436340 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:59:27.436938 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m20:59:27.441529 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:59:27.445320 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m20:59:27.446015 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m20:59:27.450021 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:59:27.451746 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m20:59:27.467830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A1667EF0>]}
[0m20:59:27.468879 [info ] [Thread-1 (]: 8 of 10 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.06s]
[0m20:59:27.469664 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m20:59:27.470239 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m20:59:27.471123 [info ] [Thread-1 (]: 9 of 10 START sql view model main.stg_products ................................. [RUN]
[0m20:59:27.471772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m20:59:27.472196 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m20:59:27.475745 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m20:59:27.477316 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m20:59:27.482052 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m20:59:27.483442 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:59:27.484105 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m20:59:27.484629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:27.494567 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:59:27.495044 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:59:27.495381 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:59:27.496310 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:27.499220 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:59:27.499633 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:59:27.500360 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:27.504252 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:59:27.504785 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:59:27.505694 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:27.508799 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:59:27.509407 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:59:27.509950 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m20:59:27.514598 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:59:27.518225 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m20:59:27.518724 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m20:59:27.522173 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:59:27.524721 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m20:59:27.540116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A1667F50>]}
[0m20:59:27.541029 [info ] [Thread-1 (]: 9 of 10 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.07s]
[0m20:59:27.541711 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m20:59:27.542123 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m20:59:27.542650 [info ] [Thread-1 (]: 10 of 10 START sql view model main.stg_shipping ................................ [RUN]
[0m20:59:27.543144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m20:59:27.543483 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m20:59:27.545937 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m20:59:27.547170 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m20:59:27.551117 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m20:59:27.552614 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:59:27.553093 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m20:59:27.553430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:27.563352 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:59:27.563822 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:59:27.564168 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m20:59:27.564999 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:27.568422 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:59:27.568864 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m20:59:27.569589 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:27.572278 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:59:27.572684 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m20:59:27.573416 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:27.574927 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:59:27.575299 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:59:27.575613 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m20:59:27.579235 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:59:27.582552 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m20:59:27.583257 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m20:59:27.587448 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:59:27.589244 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m20:59:27.604107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82611e66-63ef-46eb-b7c7-89f32140be58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A1768170>]}
[0m20:59:27.604833 [info ] [Thread-1 (]: 10 of 10 OK created sql view model main.stg_shipping ........................... [[32mOK[0m in 0.06s]
[0m20:59:27.605445 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m20:59:27.607185 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:27.607575 [debug] [MainThread]: On master: BEGIN
[0m20:59:27.607845 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:59:27.617188 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m20:59:27.617622 [debug] [MainThread]: On master: COMMIT
[0m20:59:27.617900 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:27.618163 [debug] [MainThread]: On master: COMMIT
[0m20:59:27.618648 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:59:27.618960 [debug] [MainThread]: On master: Close
[0m20:59:27.621397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:27.621793 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m20:59:27.622041 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m20:59:27.622273 [debug] [MainThread]: Connection 'model.assignment_4.stg_shipping' was properly closed.
[0m20:59:27.623037 [info ] [MainThread]: 
[0m20:59:27.623392 [info ] [MainThread]: Finished running 5 seeds, 5 view models in 0 hours 0 minutes and 8.14 seconds (8.14s).
[0m20:59:27.626222 [debug] [MainThread]: Command end result
[0m20:59:27.674574 [info ] [MainThread]: 
[0m20:59:27.675162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:59:27.675537 [info ] [MainThread]: 
[0m20:59:27.675907 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m20:59:27.677347 [debug] [MainThread]: Command `dbt build` succeeded at 20:59:27.677081 after 9.49 seconds
[0m20:59:27.677886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A1667E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119E916CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A69D7A70>]}
[0m20:59:27.678437 [debug] [MainThread]: Flushing usage events
[0m21:00:30.081125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221326AEE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022135108550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022135108410>]}


============================== 21:00:30.086328 | 9db9062b-e9df-463e-8471-a0279ac33881 ==============================
[0m21:00:30.086328 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:00:30.087589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_locations', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:30.392849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9db9062b-e9df-463e-8471-a0279ac33881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022135548510>]}
[0m21:00:30.468351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9db9062b-e9df-463e-8471-a0279ac33881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221350B7F00>]}
[0m21:00:30.474370 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m21:00:30.488878 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:00:30.727320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:00:30.728148 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\staging\stg_locations.sql
[0m21:00:31.037787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9db9062b-e9df-463e-8471-a0279ac33881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221352ED050>]}
[0m21:00:31.168540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9db9062b-e9df-463e-8471-a0279ac33881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221352AFD40>]}
[0m21:00:31.169253 [info ] [MainThread]: Found 5 seeds, 5 models, 421 macros
[0m21:00:31.169905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db9062b-e9df-463e-8471-a0279ac33881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221367F6350>]}
[0m21:00:31.172160 [info ] [MainThread]: 
[0m21:00:31.173396 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:00:31.175206 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m21:00:31.305111 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m21:00:31.305675 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m21:00:31.306089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:31.322102 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:00:31.324010 [debug] [ThreadPool]: On list_assignment_4: Close
[0m21:00:31.328626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m21:00:31.329377 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m21:00:31.338391 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:00:31.338941 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m21:00:31.339346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:31.352757 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:00:31.354689 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:00:31.355148 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m21:00:31.355845 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:00:31.356261 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:00:31.356646 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m21:00:31.357366 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:00:31.358607 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m21:00:31.359027 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:00:31.359531 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m21:00:31.360286 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:00:31.360729 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m21:00:31.372387 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m21:00:31.381013 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m21:00:31.381552 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m21:00:31.381936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:31.394871 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:00:31.395423 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m21:00:31.395839 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m21:00:31.451388 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m21:00:31.453545 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m21:00:31.455787 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m21:00:31.456325 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m21:00:31.463906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db9062b-e9df-463e-8471-a0279ac33881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221367FD8B0>]}
[0m21:00:31.464575 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:31.464985 [debug] [MainThread]: On master: BEGIN
[0m21:00:31.465361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:31.478392 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m21:00:31.478945 [debug] [MainThread]: On master: COMMIT
[0m21:00:31.479345 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:31.479724 [debug] [MainThread]: On master: COMMIT
[0m21:00:31.480352 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:00:31.480774 [debug] [MainThread]: On master: Close
[0m21:00:31.484739 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:00:31.485723 [info ] [MainThread]: 
[0m21:00:31.496247 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_locations
[0m21:00:31.497117 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_locations ................................. [RUN]
[0m21:00:31.498576 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.stg_locations'
[0m21:00:31.499559 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_locations
[0m21:00:31.514956 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_locations"
[0m21:00:31.516891 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_locations
[0m21:00:31.567447 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_locations"
[0m21:00:31.569074 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:00:31.569712 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: BEGIN
[0m21:00:31.570178 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:00:31.583557 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:00:31.584229 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:00:31.584726 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */

  
  create view "assignment_4"."main"."stg_locations__dbt_tmp" as (
    SELECT
    DISTINCT
    TRIM("City") AS city,
    TRIM("State") AS state,
    TRIM("Region") AS region,
    TRIM("Country") AS country,
    "Order.ID" AS order_id
FROM "assignment_4"."main"."locations"
  );

[0m21:00:31.585968 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:00:31.594501 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:00:31.595111 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations" rename to "stg_locations__dbt_backup"
[0m21:00:31.596129 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:31.600052 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:00:31.600692 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m21:00:31.601692 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:31.628116 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m21:00:31.628741 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:00:31.629213 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m21:00:31.671990 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m21:00:31.679841 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:00:31.680476 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
drop view if exists "assignment_4"."main"."stg_locations__dbt_backup" cascade
[0m21:00:31.684777 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:00:31.688205 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: Close
[0m21:00:31.708479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db9062b-e9df-463e-8471-a0279ac33881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022136882390>]}
[0m21:00:31.709487 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_locations ............................ [[32mOK[0m in 0.21s]
[0m21:00:31.711193 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_locations
[0m21:00:31.713341 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:31.713861 [debug] [MainThread]: On master: BEGIN
[0m21:00:31.714245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:31.727112 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m21:00:31.727676 [debug] [MainThread]: On master: COMMIT
[0m21:00:31.728072 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:31.728457 [debug] [MainThread]: On master: COMMIT
[0m21:00:31.729087 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:00:31.729519 [debug] [MainThread]: On master: Close
[0m21:00:31.732826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:31.733330 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m21:00:31.733685 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m21:00:31.734025 [debug] [MainThread]: Connection 'model.assignment_4.stg_locations' was properly closed.
[0m21:00:31.734473 [info ] [MainThread]: 
[0m21:00:31.735330 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m21:00:31.736877 [debug] [MainThread]: Command end result
[0m21:00:31.782933 [info ] [MainThread]: 
[0m21:00:31.784163 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:31.785246 [info ] [MainThread]: 
[0m21:00:31.786164 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:00:31.787805 [debug] [MainThread]: Command `dbt run` succeeded at 21:00:31.787560 after 1.98 seconds
[0m21:00:31.788350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221367CFE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213655BCF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221354B53B0>]}
[0m21:00:31.788924 [debug] [MainThread]: Flushing usage events
[0m21:20:06.749740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EE77BF0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EE745F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EEA1F07D0>]}


============================== 21:20:06.755271 | 740e2a73-9792-4d6e-a7e4-9e03eb2846e7 ==============================
[0m21:20:06.755271 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:20:06.756112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m21:20:07.139624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EEB5B8510>]}
[0m21:20:07.217182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EEA1C7F00>]}
[0m21:20:07.224765 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m21:20:07.238498 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:20:07.462858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:20:07.463781 [debug] [MainThread]: Partial parsing: added file: assignment_4://models\marts\the_most_popular_customer.sql
[0m21:20:07.831754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EEA3FD050>]}
[0m21:20:08.040783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EEA153B60>]}
[0m21:20:08.041523 [info ] [MainThread]: Found 5 seeds, 6 models, 421 macros
[0m21:20:08.045617 [info ] [MainThread]: 
[0m21:20:08.046662 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:20:08.054838 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m21:20:08.192815 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m21:20:08.193398 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m21:20:08.193865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:08.211372 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m21:20:08.213334 [debug] [ThreadPool]: On list_assignment_4: Close
[0m21:20:08.217200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m21:20:08.217936 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m21:20:08.227112 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:20:08.227694 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m21:20:08.228113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:08.243446 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m21:20:08.245637 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:20:08.246184 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m21:20:08.247123 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:20:08.247782 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:20:08.248327 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m21:20:08.249511 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:20:08.251015 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m21:20:08.251572 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:20:08.251977 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m21:20:08.252712 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:20:08.253138 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m21:20:08.259475 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m21:20:08.267524 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m21:20:08.268071 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m21:20:08.268480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:08.283302 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m21:20:08.283867 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m21:20:08.284295 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m21:20:08.344150 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m21:20:08.346454 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m21:20:08.348628 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m21:20:08.349172 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m21:20:08.357825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EEBA83BD0>]}
[0m21:20:08.358708 [debug] [MainThread]: Using duckdb connection "master"
[0m21:20:08.359136 [debug] [MainThread]: On master: BEGIN
[0m21:20:08.359507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:08.373569 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m21:20:08.374142 [debug] [MainThread]: On master: COMMIT
[0m21:20:08.374536 [debug] [MainThread]: Using duckdb connection "master"
[0m21:20:08.374974 [debug] [MainThread]: On master: COMMIT
[0m21:20:08.375631 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:20:08.376056 [debug] [MainThread]: On master: Close
[0m21:20:08.379538 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:20:08.380145 [info ] [MainThread]: 
[0m21:20:08.384066 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m21:20:08.384985 [info ] [Thread-1 (]: 1 of 11 START seed file main.customers ......................................... [RUN]
[0m21:20:08.386794 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m21:20:08.387406 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m21:20:08.387933 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m21:20:08.778650 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m21:20:08.779417 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m21:20:08.779908 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:20:08.793166 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:20:08.793796 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m21:20:08.794277 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m21:20:08.796835 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:20:08.815868 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m21:20:08.816513 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:20:08.879728 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m21:20:08.888330 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m21:20:08.914261 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m21:20:08.915044 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m21:20:08.915636 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m21:20:08.989335 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m21:20:08.992271 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m21:20:09.085684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EEBC8B1E0>]}
[0m21:20:09.086531 [info ] [Thread-1 (]: 1 of 11 OK loaded seed file main.customers ..................................... [[32mINSERT 51290[0m in 0.70s]
[0m21:20:09.087462 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m21:20:09.088039 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m21:20:09.088876 [info ] [Thread-1 (]: 2 of 11 START seed file main.locations ......................................... [RUN]
[0m21:20:09.089905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m21:20:09.090865 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m21:20:09.091554 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m21:20:09.601371 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m21:20:09.602045 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m21:20:09.602555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:09.617591 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m21:20:09.618265 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m21:20:09.618751 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m21:20:09.620419 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:09.622406 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m21:20:09.622971 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:20:09.719547 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m21:20:09.720590 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m21:20:09.724045 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m21:20:09.724646 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m21:20:09.725112 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m21:20:09.815753 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m21:20:09.817318 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m21:20:09.976290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EEB7913D0>]}
[0m21:20:09.977586 [info ] [Thread-1 (]: 2 of 11 OK loaded seed file main.locations ..................................... [[32mINSERT 51290[0m in 0.89s]
[0m21:20:09.978626 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m21:20:09.979237 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m21:20:09.980103 [info ] [Thread-1 (]: 3 of 11 START seed file main.orders ............................................ [RUN]
[0m21:20:09.981249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m21:20:09.981873 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m21:20:09.982355 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m21:20:13.122353 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m21:20:13.122983 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m21:20:13.123447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:13.136743 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:20:13.137475 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m21:20:13.137980 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m21:20:13.140240 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:20:13.142229 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m21:20:13.142814 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:20:13.490580 [debug] [Thread-1 (]: SQL status: OK in 0.347 seconds
[0m21:20:13.491605 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m21:20:13.495048 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m21:20:13.495685 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m21:20:13.496230 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m21:20:13.618336 [debug] [Thread-1 (]: SQL status: OK in 0.121 seconds
[0m21:20:13.620210 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m21:20:13.893307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EEB995A70>]}
[0m21:20:13.894117 [info ] [Thread-1 (]: 3 of 11 OK loaded seed file main.orders ........................................ [[32mINSERT 51290[0m in 3.91s]
[0m21:20:13.894990 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m21:20:13.895534 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m21:20:13.896326 [info ] [Thread-1 (]: 4 of 11 START seed file main.products .......................................... [RUN]
[0m21:20:13.897171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m21:20:13.898297 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m21:20:13.899105 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m21:20:14.470719 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m21:20:14.471340 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m21:20:14.471869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:14.485888 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m21:20:14.486517 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m21:20:14.487053 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m21:20:14.488812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:14.490601 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m21:20:14.491115 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:20:14.575853 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m21:20:14.576863 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m21:20:14.580278 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m21:20:14.580937 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m21:20:14.581416 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m21:20:14.670880 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m21:20:14.672357 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m21:20:14.844732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EEB5A9630>]}
[0m21:20:14.845542 [info ] [Thread-1 (]: 4 of 11 OK loaded seed file main.products ...................................... [[32mINSERT 51290[0m in 0.95s]
[0m21:20:14.846420 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m21:20:14.846967 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m21:20:14.847762 [info ] [Thread-1 (]: 5 of 11 START seed file main.shipping .......................................... [RUN]
[0m21:20:14.848605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m21:20:14.849218 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m21:20:14.849739 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m21:20:15.744716 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m21:20:15.745334 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m21:20:15.745795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:15.759028 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:20:15.759807 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m21:20:15.760539 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m21:20:15.762982 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:20:15.764836 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m21:20:15.765368 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:20:16.021001 [debug] [Thread-1 (]: SQL status: OK in 0.255 seconds
[0m21:20:16.022010 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m21:20:16.025660 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m21:20:16.026307 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m21:20:16.026788 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m21:20:16.117194 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m21:20:16.119072 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m21:20:16.235120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EF2198350>]}
[0m21:20:16.236377 [info ] [Thread-1 (]: 5 of 11 OK loaded seed file main.shipping ...................................... [[32mINSERT 51290[0m in 1.39s]
[0m21:20:16.237782 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m21:20:16.238364 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m21:20:16.239166 [info ] [Thread-1 (]: 6 of 11 START sql view model main.stg_customers ................................ [RUN]
[0m21:20:16.239881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m21:20:16.240395 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m21:20:16.250795 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m21:20:16.252587 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m21:20:16.298785 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m21:20:16.300466 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m21:20:16.301133 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m21:20:16.301618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:16.314950 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:20:16.315572 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m21:20:16.316064 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m21:20:16.317258 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:16.326477 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m21:20:16.327091 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:20:16.328104 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:20:16.331815 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m21:20:16.332371 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:20:16.333327 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:20:16.338368 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m21:20:16.338989 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m21:20:16.339472 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m21:20:16.344278 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:20:16.351525 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m21:20:16.352130 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m21:20:16.355641 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:20:16.358481 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m21:20:16.375369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EEB7C3850>]}
[0m21:20:16.376400 [info ] [Thread-1 (]: 6 of 11 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.14s]
[0m21:20:16.377317 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m21:20:16.377877 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_locations
[0m21:20:16.378643 [info ] [Thread-1 (]: 7 of 11 START sql view model main.stg_locations ................................ [RUN]
[0m21:20:16.379554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_locations)
[0m21:20:16.380093 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_locations
[0m21:20:16.384092 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_locations"
[0m21:20:16.385579 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_locations
[0m21:20:16.389975 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_locations"
[0m21:20:16.391567 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:20:16.392288 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: BEGIN
[0m21:20:16.392777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:16.407092 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m21:20:16.407699 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:20:16.408244 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */

  
  create view "assignment_4"."main"."stg_locations__dbt_tmp" as (
    SELECT
    DISTINCT
    TRIM("City") AS city,
    TRIM("State") AS state,
    TRIM("Region") AS region,
    TRIM("Country") AS country,
    "Order.ID" AS order_id
FROM "assignment_4"."main"."locations"
  );

[0m21:20:16.409764 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:16.414046 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:20:16.414621 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations" rename to "stg_locations__dbt_backup"
[0m21:20:16.415595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:20:16.419776 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:20:16.420362 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m21:20:16.421305 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:20:16.423537 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m21:20:16.424207 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:20:16.424680 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m21:20:16.429538 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:20:16.432729 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:20:16.433275 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
drop view if exists "assignment_4"."main"."stg_locations__dbt_backup" cascade
[0m21:20:16.437258 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:20:16.439520 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: Close
[0m21:20:16.459344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EF10374D0>]}
[0m21:20:16.460872 [info ] [Thread-1 (]: 7 of 11 OK created sql view model main.stg_locations ........................... [[32mOK[0m in 0.08s]
[0m21:20:16.461934 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_locations
[0m21:20:16.462659 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m21:20:16.463629 [info ] [Thread-1 (]: 8 of 11 START sql view model main.stg_orders ................................... [RUN]
[0m21:20:16.464843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_locations, now model.assignment_4.stg_orders)
[0m21:20:16.465635 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m21:20:16.469721 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m21:20:16.471686 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m21:20:16.478352 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m21:20:16.480031 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m21:20:16.480646 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m21:20:16.481204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:16.496207 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m21:20:16.496847 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m21:20:16.497361 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m21:20:16.498559 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:16.502419 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m21:20:16.502996 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:20:16.504025 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:20:16.508269 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m21:20:16.508971 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:20:16.509988 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:20:16.512097 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m21:20:16.512615 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m21:20:16.513084 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m21:20:16.518831 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:20:16.521964 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m21:20:16.522519 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m21:20:16.526315 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:20:16.528437 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m21:20:16.546656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EEBDA7CB0>]}
[0m21:20:16.547600 [info ] [Thread-1 (]: 8 of 11 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.08s]
[0m21:20:16.548485 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m21:20:16.549045 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m21:20:16.549790 [info ] [Thread-1 (]: 9 of 11 START sql view model main.stg_products ................................. [RUN]
[0m21:20:16.550448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m21:20:16.550943 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m21:20:16.554232 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m21:20:16.555779 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m21:20:16.562813 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m21:20:16.564547 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m21:20:16.565391 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m21:20:16.566079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:16.578862 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:20:16.579489 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m21:20:16.580006 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m21:20:16.581142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:16.585164 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m21:20:16.585752 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m21:20:16.586741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:20:16.590407 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m21:20:16.590974 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:20:16.591948 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:20:16.594050 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m21:20:16.594625 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m21:20:16.595138 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m21:20:16.599492 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:20:16.603943 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m21:20:16.604548 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m21:20:16.608766 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:20:16.611386 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m21:20:16.629360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EEBDA7D10>]}
[0m21:20:16.630303 [info ] [Thread-1 (]: 9 of 11 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.08s]
[0m21:20:16.631184 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m21:20:16.631818 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m21:20:16.632612 [info ] [Thread-1 (]: 10 of 11 START sql view model main.stg_shipping ................................ [RUN]
[0m21:20:16.633290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m21:20:16.633860 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m21:20:16.637185 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m21:20:16.638752 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m21:20:16.643490 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m21:20:16.645161 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m21:20:16.646054 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m21:20:16.646601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:16.659302 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:20:16.659920 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m21:20:16.660408 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m21:20:16.661493 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:16.667025 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m21:20:16.667788 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m21:20:16.669039 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:16.673329 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m21:20:16.674057 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m21:20:16.675205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:16.677805 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m21:20:16.678628 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m21:20:16.679297 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m21:20:16.683732 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:20:16.687275 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m21:20:16.688247 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m21:20:16.692667 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:20:16.695497 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m21:20:16.714610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EEBDA7EF0>]}
[0m21:20:16.715851 [info ] [Thread-1 (]: 10 of 11 OK created sql view model main.stg_shipping ........................... [[32mOK[0m in 0.08s]
[0m21:20:16.716999 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m21:20:16.717713 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m21:20:16.718629 [info ] [Thread-1 (]: 11 of 11 START sql table model main.the_most_popular_customer .................. [RUN]
[0m21:20:16.719727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_shipping, now model.assignment_4.the_most_popular_customer)
[0m21:20:16.720238 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m21:20:16.724549 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m21:20:16.727090 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m21:20:16.758015 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m21:20:16.759980 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:20:16.760619 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m21:20:16.761092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:16.774810 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m21:20:16.775423 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:20:16.775940 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      SELECT
    sc.customer_id,
    sc.customer_name,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_customers" AS sc
JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
GROUP BY
    sc.customer_id,
    sc.customer_name
ORDER BY
    order_count DESC
LIMIT 5;
    );
  
  
[0m21:20:16.792750 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      SELECT
    sc.customer_id,
    sc.customer_name,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_customers" AS sc
JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
GROUP BY
    sc.customer_id,
    sc.customer_name
ORDER BY
    order_count DESC
LIMIT 5;
    );
  
  
[0m21:20:16.793435 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:20:16.794059 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: ROLLBACK
[0m21:20:16.813894 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.the_most_popular_customer'
[0m21:20:16.814516 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m21:20:16.823557 [debug] [Thread-1 (]: Runtime Error in model the_most_popular_customer (models\marts\the_most_popular_customer.sql)
  Parser Error: syntax error at or near ";"
[0m21:20:16.824249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740e2a73-9792-4d6e-a7e4-9e03eb2846e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EF2DE6C90>]}
[0m21:20:16.825062 [error] [Thread-1 (]: 11 of 11 ERROR creating sql table model main.the_most_popular_customer ......... [[31mERROR[0m in 0.10s]
[0m21:20:16.826058 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m21:20:16.828767 [debug] [MainThread]: Using duckdb connection "master"
[0m21:20:16.829588 [debug] [MainThread]: On master: BEGIN
[0m21:20:16.829975 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:20:16.842616 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m21:20:16.843178 [debug] [MainThread]: On master: COMMIT
[0m21:20:16.843567 [debug] [MainThread]: Using duckdb connection "master"
[0m21:20:16.843962 [debug] [MainThread]: On master: COMMIT
[0m21:20:16.844596 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:20:16.845018 [debug] [MainThread]: On master: Close
[0m21:20:16.848607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:16.849150 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m21:20:16.849504 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m21:20:16.849852 [debug] [MainThread]: Connection 'model.assignment_4.the_most_popular_customer' was properly closed.
[0m21:20:16.850760 [info ] [MainThread]: 
[0m21:20:16.851241 [info ] [MainThread]: Finished running 5 seeds, 5 view models, 1 table model in 0 hours 0 minutes and 8.80 seconds (8.80s).
[0m21:20:16.854734 [debug] [MainThread]: Command end result
[0m21:20:16.901992 [info ] [MainThread]: 
[0m21:20:16.902943 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:20:16.903443 [info ] [MainThread]: 
[0m21:20:16.904032 [error] [MainThread]:   Runtime Error in model the_most_popular_customer (models\marts\the_most_popular_customer.sql)
  Parser Error: syntax error at or near ";"
[0m21:20:16.904487 [info ] [MainThread]: 
[0m21:20:16.904942 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m21:20:16.906287 [debug] [MainThread]: Command `dbt build` failed at 21:20:16.906095 after 10.42 seconds
[0m21:20:16.906813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EE9F11130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EF1923B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EF1923FB0>]}
[0m21:20:16.907298 [debug] [MainThread]: Flushing usage events
[0m21:20:56.574258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D85E1AE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D88878550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D88878410>]}


============================== 21:20:56.579865 | 5097a77b-84e4-4254-b65f-59f826cfae8c ==============================
[0m21:20:56.579865 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:20:56.581058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m most_popular_customer', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:20:56.902555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5097a77b-84e4-4254-b65f-59f826cfae8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D88BEC510>]}
[0m21:20:56.979951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5097a77b-84e4-4254-b65f-59f826cfae8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D88827F00>]}
[0m21:20:56.986101 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m21:20:56.999899 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:20:57.203997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:57.204545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:57.255086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5097a77b-84e4-4254-b65f-59f826cfae8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D88A5C350>]}
[0m21:20:57.383450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5097a77b-84e4-4254-b65f-59f826cfae8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D88A1FF20>]}
[0m21:20:57.384168 [info ] [MainThread]: Found 5 seeds, 6 models, 421 macros
[0m21:20:57.384858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5097a77b-84e4-4254-b65f-59f826cfae8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D88ABCE50>]}
[0m21:20:57.385738 [warn ] [MainThread]: The selection criterion 'most_popular_customer' does not match any enabled nodes
[0m21:20:57.387784 [info ] [MainThread]: 
[0m21:20:57.388624 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:20:57.391480 [debug] [MainThread]: Command end result
[0m21:20:57.431357 [debug] [MainThread]: Command `dbt run` succeeded at 21:20:57.431091 after 1.02 seconds
[0m21:20:57.432241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D89E0FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D887DF290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D89DBBF50>]}
[0m21:20:57.433133 [debug] [MainThread]: Flushing usage events
[0m21:21:29.177373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C7125EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C73CB8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C73CB8410>]}


============================== 21:21:29.183112 | b859952f-5625-4b03-acc6-3e02f6e7102a ==============================
[0m21:21:29.183112 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:21:29.184203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select most_popular_customer', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:21:29.493059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b859952f-5625-4b03-acc6-3e02f6e7102a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C750A0510>]}
[0m21:21:29.567166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b859952f-5625-4b03-acc6-3e02f6e7102a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C73C67F00>]}
[0m21:21:29.573208 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m21:21:29.585036 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:21:29.789923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:21:29.790470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:21:29.841209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b859952f-5625-4b03-acc6-3e02f6e7102a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C73E9C350>]}
[0m21:21:29.971353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b859952f-5625-4b03-acc6-3e02f6e7102a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C73E5FF20>]}
[0m21:21:29.972047 [info ] [MainThread]: Found 5 seeds, 6 models, 421 macros
[0m21:21:29.972962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b859952f-5625-4b03-acc6-3e02f6e7102a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C73EFCE50>]}
[0m21:21:29.973887 [warn ] [MainThread]: The selection criterion 'most_popular_customer' does not match any enabled nodes
[0m21:21:29.975864 [info ] [MainThread]: 
[0m21:21:29.976612 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:21:29.979357 [debug] [MainThread]: Command end result
[0m21:21:30.023019 [debug] [MainThread]: Command `dbt run` succeeded at 21:21:30.022548 after 1.00 seconds
[0m21:21:30.023945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C7529FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C73C1F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C7524BF50>]}
[0m21:21:30.024602 [debug] [MainThread]: Flushing usage events
[0m21:22:17.447106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001752113EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017523B98550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017523B98410>]}


============================== 21:22:17.452415 | 9ab9afa0-fe86-41ab-a305-767086348980 ==============================
[0m21:22:17.452415 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:22:17.453708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select the_most_popular_customer', 'send_anonymous_usage_stats': 'True'}
[0m21:22:17.758895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ab9afa0-fe86-41ab-a305-767086348980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017524F60510>]}
[0m21:22:17.832736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ab9afa0-fe86-41ab-a305-767086348980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017523B43F00>]}
[0m21:22:17.843512 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m21:22:17.866973 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:22:18.059489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:22:18.060028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:22:18.115886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ab9afa0-fe86-41ab-a305-767086348980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017523D7C350>]}
[0m21:22:18.259039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ab9afa0-fe86-41ab-a305-767086348980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017523D3FF20>]}
[0m21:22:18.259787 [info ] [MainThread]: Found 5 seeds, 6 models, 421 macros
[0m21:22:18.260477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab9afa0-fe86-41ab-a305-767086348980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017523DDCE50>]}
[0m21:22:18.262600 [info ] [MainThread]: 
[0m21:22:18.263683 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:22:18.266218 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m21:22:18.434156 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m21:22:18.434715 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m21:22:18.435121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:18.454499 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m21:22:18.457239 [debug] [ThreadPool]: On list_assignment_4: Close
[0m21:22:18.462640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m21:22:18.463684 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m21:22:18.473170 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:22:18.473720 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m21:22:18.474114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:22:18.487781 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:22:18.489667 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:22:18.490116 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m21:22:18.490825 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:22:18.491230 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:22:18.491614 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m21:22:18.492515 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:22:18.493757 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m21:22:18.494170 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:22:18.494547 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m21:22:18.495241 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:22:18.495668 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m21:22:18.506253 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m21:22:18.513937 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m21:22:18.514460 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m21:22:18.514838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:18.527633 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:22:18.528176 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m21:22:18.528593 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m21:22:18.586504 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m21:22:18.588839 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m21:22:18.590985 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m21:22:18.591472 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m21:22:18.598303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab9afa0-fe86-41ab-a305-767086348980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001752515C390>]}
[0m21:22:18.598943 [debug] [MainThread]: Using duckdb connection "master"
[0m21:22:18.599341 [debug] [MainThread]: On master: BEGIN
[0m21:22:18.599710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:22:18.612813 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m21:22:18.613370 [debug] [MainThread]: On master: COMMIT
[0m21:22:18.613760 [debug] [MainThread]: Using duckdb connection "master"
[0m21:22:18.614143 [debug] [MainThread]: On master: COMMIT
[0m21:22:18.614766 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:22:18.615190 [debug] [MainThread]: On master: Close
[0m21:22:18.618516 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:22:18.619521 [info ] [MainThread]: 
[0m21:22:18.661928 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m21:22:18.662778 [info ] [Thread-1 (]: 1 of 1 START sql table model main.the_most_popular_customer .................... [RUN]
[0m21:22:18.663740 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.the_most_popular_customer'
[0m21:22:18.664271 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m21:22:18.675302 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m21:22:18.677274 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m21:22:18.728235 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m21:22:18.729814 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:22:18.730434 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m21:22:18.730897 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:22:18.746159 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m21:22:18.746792 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:22:18.747298 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      SELECT
    sc.customer_id,
    sc.customer_name,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_customers" AS sc
JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
GROUP BY
    sc.customer_id,
    sc.customer_name
ORDER BY
    order_count DESC
LIMIT 5;
    );
  
  
[0m21:22:18.748928 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      SELECT
    sc.customer_id,
    sc.customer_name,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_customers" AS sc
JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
GROUP BY
    sc.customer_id,
    sc.customer_name
ORDER BY
    order_count DESC
LIMIT 5;
    );
  
  
[0m21:22:18.749923 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:22:18.750574 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: ROLLBACK
[0m21:22:18.760319 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.the_most_popular_customer'
[0m21:22:18.760918 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m21:22:18.776274 [debug] [Thread-1 (]: Runtime Error in model the_most_popular_customer (models\marts\the_most_popular_customer.sql)
  Parser Error: syntax error at or near ";"
[0m21:22:18.778241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab9afa0-fe86-41ab-a305-767086348980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175253A5610>]}
[0m21:22:18.779124 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.the_most_popular_customer ........... [[31mERROR[0m in 0.11s]
[0m21:22:18.780777 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m21:22:18.783809 [debug] [MainThread]: Using duckdb connection "master"
[0m21:22:18.784333 [debug] [MainThread]: On master: BEGIN
[0m21:22:18.784892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:22:18.799368 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m21:22:18.799939 [debug] [MainThread]: On master: COMMIT
[0m21:22:18.800334 [debug] [MainThread]: Using duckdb connection "master"
[0m21:22:18.800887 [debug] [MainThread]: On master: COMMIT
[0m21:22:18.801950 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:22:18.802520 [debug] [MainThread]: On master: Close
[0m21:22:18.805777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:22:18.806295 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m21:22:18.806703 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m21:22:18.807092 [debug] [MainThread]: Connection 'model.assignment_4.the_most_popular_customer' was properly closed.
[0m21:22:18.807914 [info ] [MainThread]: 
[0m21:22:18.808604 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m21:22:18.809811 [debug] [MainThread]: Command end result
[0m21:22:18.851964 [info ] [MainThread]: 
[0m21:22:18.852841 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:22:18.853548 [info ] [MainThread]: 
[0m21:22:18.854438 [error] [MainThread]:   Runtime Error in model the_most_popular_customer (models\marts\the_most_popular_customer.sql)
  Parser Error: syntax error at or near ";"
[0m21:22:18.855140 [info ] [MainThread]: 
[0m21:22:18.855834 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:22:18.857405 [debug] [MainThread]: Command `dbt run` failed at 21:22:18.857176 after 1.58 seconds
[0m21:22:18.857966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175251A9180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017525453F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175254525D0>]}
[0m21:22:18.858448 [debug] [MainThread]: Flushing usage events
[0m21:24:52.532866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C8CD1F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C8C9CF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C8F7707D0>]}


============================== 21:24:52.538426 | 5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa ==============================
[0m21:24:52.538426 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:24:52.539339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:24:52.860752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C8FB28510>]}
[0m21:24:52.939820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C8F747F00>]}
[0m21:24:52.946281 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m21:24:52.958658 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:24:53.161217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:24:53.162082 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\marts\the_most_popular_customer.sql
[0m21:24:53.478984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C8F97CE50>]}
[0m21:24:53.624082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C8F6D3B60>]}
[0m21:24:53.624796 [info ] [MainThread]: Found 5 seeds, 6 models, 421 macros
[0m21:24:53.628093 [info ] [MainThread]: 
[0m21:24:53.628893 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:24:53.636616 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m21:24:53.766802 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m21:24:53.767365 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m21:24:53.767787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:53.784229 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:24:53.786128 [debug] [ThreadPool]: On list_assignment_4: Close
[0m21:24:53.789871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m21:24:53.790603 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m21:24:53.800035 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:24:53.800594 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m21:24:53.801067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:53.814648 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:24:53.816650 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:24:53.817132 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m21:24:53.817901 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:24:53.818330 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:24:53.818720 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m21:24:53.819454 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:24:53.820667 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m21:24:53.821086 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:24:53.821566 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m21:24:53.822303 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:24:53.822738 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m21:24:53.828993 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m21:24:53.836958 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m21:24:53.837487 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m21:24:53.837870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:53.851497 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:24:53.852056 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m21:24:53.852493 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m21:24:53.911903 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m21:24:53.914800 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m21:24:53.917471 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m21:24:53.917986 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m21:24:53.925592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C90FDFBD0>]}
[0m21:24:53.926252 [debug] [MainThread]: Using duckdb connection "master"
[0m21:24:53.926674 [debug] [MainThread]: On master: BEGIN
[0m21:24:53.927041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:24:53.940738 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m21:24:53.941288 [debug] [MainThread]: On master: COMMIT
[0m21:24:53.941716 [debug] [MainThread]: Using duckdb connection "master"
[0m21:24:53.942097 [debug] [MainThread]: On master: COMMIT
[0m21:24:53.942722 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:24:53.943140 [debug] [MainThread]: On master: Close
[0m21:24:53.946164 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:24:53.946758 [info ] [MainThread]: 
[0m21:24:53.950734 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m21:24:53.951551 [info ] [Thread-1 (]: 1 of 11 START seed file main.customers ......................................... [RUN]
[0m21:24:53.953591 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m21:24:53.954374 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m21:24:53.954982 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m21:24:54.308717 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m21:24:54.309328 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m21:24:54.309790 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:24:54.324919 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m21:24:54.325577 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m21:24:54.326125 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m21:24:54.328307 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:24:54.345666 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m21:24:54.346433 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:24:54.415816 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m21:24:54.424225 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m21:24:54.448381 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m21:24:54.449044 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m21:24:54.449519 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m21:24:54.521887 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m21:24:54.524796 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m21:24:54.601448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C911EB1E0>]}
[0m21:24:54.602293 [info ] [Thread-1 (]: 1 of 11 OK loaded seed file main.customers ..................................... [[32mINSERT 51290[0m in 0.65s]
[0m21:24:54.603196 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m21:24:54.604027 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m21:24:54.604848 [info ] [Thread-1 (]: 2 of 11 START seed file main.locations ......................................... [RUN]
[0m21:24:54.605676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m21:24:54.606167 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m21:24:54.606742 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m21:24:55.075988 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m21:24:55.076599 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m21:24:55.077072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:55.089777 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:24:55.090401 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m21:24:55.090876 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m21:24:55.092623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:24:55.094527 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m21:24:55.095083 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:24:55.191724 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m21:24:55.192735 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m21:24:55.196241 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m21:24:55.196847 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m21:24:55.197308 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m21:24:55.289605 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m21:24:55.291088 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m21:24:55.423373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C90CF13D0>]}
[0m21:24:55.424257 [info ] [Thread-1 (]: 2 of 11 OK loaded seed file main.locations ..................................... [[32mINSERT 51290[0m in 0.82s]
[0m21:24:55.425152 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m21:24:55.425723 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m21:24:55.426533 [info ] [Thread-1 (]: 3 of 11 START seed file main.orders ............................................ [RUN]
[0m21:24:55.427538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m21:24:55.428259 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m21:24:55.428736 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m21:24:58.465881 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m21:24:58.466487 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m21:24:58.466942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:58.480471 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:24:58.481086 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m21:24:58.481564 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m21:24:58.483879 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:24:58.485665 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m21:24:58.486185 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:24:58.842626 [debug] [Thread-1 (]: SQL status: OK in 0.356 seconds
[0m21:24:58.843625 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m21:24:58.847112 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m21:24:58.847730 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m21:24:58.848202 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m21:24:58.964838 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m21:24:58.966734 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m21:24:59.177074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C90EF5A70>]}
[0m21:24:59.177884 [info ] [Thread-1 (]: 3 of 11 OK loaded seed file main.orders ........................................ [[32mINSERT 51290[0m in 3.75s]
[0m21:24:59.178761 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m21:24:59.179304 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m21:24:59.180089 [info ] [Thread-1 (]: 4 of 11 START seed file main.products .......................................... [RUN]
[0m21:24:59.181025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m21:24:59.181901 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m21:24:59.182475 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m21:24:59.750552 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m21:24:59.751158 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m21:24:59.751613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:59.764620 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:24:59.765234 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m21:24:59.765717 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m21:24:59.767469 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:24:59.769311 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m21:24:59.769837 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:24:59.850899 [debug] [Thread-1 (]: SQL status: OK in 0.080 seconds
[0m21:24:59.851924 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m21:24:59.855160 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m21:24:59.856072 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m21:24:59.856673 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m21:24:59.940976 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m21:24:59.942255 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m21:25:00.057315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C8FAF9630>]}
[0m21:25:00.058118 [info ] [Thread-1 (]: 4 of 11 OK loaded seed file main.products ...................................... [[32mINSERT 51290[0m in 0.88s]
[0m21:25:00.058984 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m21:25:00.059596 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m21:25:00.060521 [info ] [Thread-1 (]: 5 of 11 START seed file main.shipping .......................................... [RUN]
[0m21:25:00.061473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m21:25:00.062018 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m21:25:00.062535 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m21:25:00.954936 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m21:25:00.955565 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m21:25:00.956069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:00.968991 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:25:00.969608 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m21:25:00.970076 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m21:25:00.971703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:25:00.973524 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m21:25:00.974059 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:25:01.247497 [debug] [Thread-1 (]: SQL status: OK in 0.273 seconds
[0m21:25:01.248484 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m21:25:01.251501 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m21:25:01.252112 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m21:25:01.252573 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m21:25:01.328072 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m21:25:01.329358 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m21:25:01.418200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C95FF83D0>]}
[0m21:25:01.419003 [info ] [Thread-1 (]: 5 of 11 OK loaded seed file main.shipping ...................................... [[32mINSERT 51290[0m in 1.36s]
[0m21:25:01.419881 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m21:25:01.420460 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m21:25:01.421250 [info ] [Thread-1 (]: 6 of 11 START sql view model main.stg_customers ................................ [RUN]
[0m21:25:01.421923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m21:25:01.422516 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m21:25:01.432896 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m21:25:01.434428 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m21:25:01.480406 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m21:25:01.482000 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m21:25:01.482624 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m21:25:01.483078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:01.496241 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:25:01.496854 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m21:25:01.497352 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m21:25:01.498481 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:25:01.507713 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m21:25:01.508331 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:25:01.509363 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:25:01.513198 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m21:25:01.513792 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:25:01.514759 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:25:01.519819 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m21:25:01.520421 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m21:25:01.520902 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m21:25:01.539412 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m21:25:01.546866 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m21:25:01.547527 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m21:25:01.551601 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:25:01.554434 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m21:25:01.572802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C90D23A80>]}
[0m21:25:01.573926 [info ] [Thread-1 (]: 6 of 11 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.15s]
[0m21:25:01.574849 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m21:25:01.575457 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_locations
[0m21:25:01.576237 [info ] [Thread-1 (]: 7 of 11 START sql view model main.stg_locations ................................ [RUN]
[0m21:25:01.577088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_locations)
[0m21:25:01.577654 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_locations
[0m21:25:01.581691 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_locations"
[0m21:25:01.583238 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_locations
[0m21:25:01.587583 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_locations"
[0m21:25:01.589128 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:25:01.589799 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: BEGIN
[0m21:25:01.590256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:01.604071 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m21:25:01.604719 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:25:01.605302 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */

  
  create view "assignment_4"."main"."stg_locations__dbt_tmp" as (
    SELECT
    DISTINCT
    TRIM("City") AS city,
    TRIM("State") AS state,
    TRIM("Region") AS region,
    TRIM("Country") AS country,
    "Order.ID" AS order_id
FROM "assignment_4"."main"."locations"
  );

[0m21:25:01.606532 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:25:01.610396 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:25:01.610969 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations" rename to "stg_locations__dbt_backup"
[0m21:25:01.611990 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:25:01.616623 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:25:01.617221 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m21:25:01.618243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:25:01.620301 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m21:25:01.620808 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:25:01.621312 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m21:25:01.625731 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:25:01.630925 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m21:25:01.631800 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
drop view if exists "assignment_4"."main"."stg_locations__dbt_backup" cascade
[0m21:25:01.636747 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:25:01.640553 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: Close
[0m21:25:01.661740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C8EFD0710>]}
[0m21:25:01.662695 [info ] [Thread-1 (]: 7 of 11 OK created sql view model main.stg_locations ........................... [[32mOK[0m in 0.08s]
[0m21:25:01.663656 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_locations
[0m21:25:01.664239 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m21:25:01.665013 [info ] [Thread-1 (]: 8 of 11 START sql view model main.stg_orders ................................... [RUN]
[0m21:25:01.665697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_locations, now model.assignment_4.stg_orders)
[0m21:25:01.666191 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m21:25:01.669548 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m21:25:01.671096 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m21:25:01.677268 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m21:25:01.678897 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m21:25:01.679526 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m21:25:01.679978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:01.694128 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m21:25:01.694762 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m21:25:01.695262 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m21:25:01.696511 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:25:01.700299 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m21:25:01.700867 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:25:01.701858 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:25:01.706470 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m21:25:01.707097 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:25:01.708379 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:25:01.711196 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m21:25:01.711761 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m21:25:01.712224 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m21:25:01.716561 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:25:01.720009 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m21:25:01.720572 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m21:25:01.724596 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:25:01.726623 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m21:25:01.743968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C91414290>]}
[0m21:25:01.745033 [info ] [Thread-1 (]: 8 of 11 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.08s]
[0m21:25:01.746026 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m21:25:01.746593 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m21:25:01.747318 [info ] [Thread-1 (]: 9 of 11 START sql view model main.stg_products ................................. [RUN]
[0m21:25:01.748325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m21:25:01.748830 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m21:25:01.752112 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m21:25:01.753538 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m21:25:01.760068 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m21:25:01.762062 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m21:25:01.763013 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m21:25:01.763667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:01.779152 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m21:25:01.779871 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m21:25:01.780404 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m21:25:01.781651 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:25:01.785826 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m21:25:01.786678 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m21:25:01.788185 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:25:01.793581 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m21:25:01.794199 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:25:01.795249 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:25:01.797549 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m21:25:01.798158 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m21:25:01.798675 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m21:25:01.802771 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:25:01.806636 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m21:25:01.807306 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m21:25:01.811066 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:25:01.813190 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m21:25:01.832415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C914142F0>]}
[0m21:25:01.833377 [info ] [Thread-1 (]: 9 of 11 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.08s]
[0m21:25:01.834314 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m21:25:01.834888 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m21:25:01.835628 [info ] [Thread-1 (]: 10 of 11 START sql view model main.stg_shipping ................................ [RUN]
[0m21:25:01.836287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m21:25:01.836775 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m21:25:01.840112 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m21:25:01.841595 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m21:25:01.846462 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m21:25:01.847969 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m21:25:01.848587 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m21:25:01.849069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:01.863841 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m21:25:01.864499 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m21:25:01.865070 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m21:25:01.866666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:25:01.872784 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m21:25:01.873670 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m21:25:01.875060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:25:01.879377 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m21:25:01.880041 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m21:25:01.881178 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:25:01.883564 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m21:25:01.884130 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m21:25:01.884619 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m21:25:01.890410 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:25:01.894966 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m21:25:01.895880 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m21:25:01.900159 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:25:01.903036 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m21:25:01.922073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C914144D0>]}
[0m21:25:01.923328 [info ] [Thread-1 (]: 10 of 11 OK created sql view model main.stg_shipping ........................... [[32mOK[0m in 0.09s]
[0m21:25:01.924294 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m21:25:01.924859 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m21:25:01.925590 [info ] [Thread-1 (]: 11 of 11 START sql table model main.the_most_popular_customer .................. [RUN]
[0m21:25:01.926258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_shipping, now model.assignment_4.the_most_popular_customer)
[0m21:25:01.926760 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m21:25:01.931147 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m21:25:01.932718 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m21:25:01.962697 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m21:25:01.964621 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:25:01.965551 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m21:25:01.966010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:01.979605 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:25:01.980236 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:25:01.980755 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc              -- Reference the staging model
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"  -- Join with the orders table
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC  -- Order by the count of orders in descending order
LIMIT 1;
    );
  
  
[0m21:25:01.981864 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc              -- Reference the staging model
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"  -- Join with the orders table
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC  -- Order by the count of orders in descending order
LIMIT 1;
    );
  
  
[0m21:25:01.982444 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:25:01.983057 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: ROLLBACK
[0m21:25:01.992996 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.the_most_popular_customer'
[0m21:25:01.993592 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m21:25:02.004043 [debug] [Thread-1 (]: Runtime Error in model the_most_popular_customer (models\marts\the_most_popular_customer.sql)
  Parser Error: syntax error at or near ";"
[0m21:25:02.004781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b79ebef-8008-4b0f-ab1a-58ce6d71f4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C970A4950>]}
[0m21:25:02.005619 [error] [Thread-1 (]: 11 of 11 ERROR creating sql table model main.the_most_popular_customer ......... [[31mERROR[0m in 0.08s]
[0m21:25:02.006503 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m21:25:02.009261 [debug] [MainThread]: Using duckdb connection "master"
[0m21:25:02.009914 [debug] [MainThread]: On master: BEGIN
[0m21:25:02.010339 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:25:02.022845 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m21:25:02.023430 [debug] [MainThread]: On master: COMMIT
[0m21:25:02.023835 [debug] [MainThread]: Using duckdb connection "master"
[0m21:25:02.024215 [debug] [MainThread]: On master: COMMIT
[0m21:25:02.024858 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:25:02.025279 [debug] [MainThread]: On master: Close
[0m21:25:02.029060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:25:02.029607 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m21:25:02.029956 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m21:25:02.030295 [debug] [MainThread]: Connection 'model.assignment_4.the_most_popular_customer' was properly closed.
[0m21:25:02.030829 [info ] [MainThread]: 
[0m21:25:02.031302 [info ] [MainThread]: Finished running 5 seeds, 5 view models, 1 table model in 0 hours 0 minutes and 8.40 seconds (8.40s).
[0m21:25:02.034703 [debug] [MainThread]: Command end result
[0m21:25:02.083032 [info ] [MainThread]: 
[0m21:25:02.083876 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:25:02.084522 [info ] [MainThread]: 
[0m21:25:02.085191 [error] [MainThread]:   Runtime Error in model the_most_popular_customer (models\marts\the_most_popular_customer.sql)
  Parser Error: syntax error at or near ";"
[0m21:25:02.085790 [info ] [MainThread]: 
[0m21:25:02.086266 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m21:25:02.087552 [debug] [MainThread]: Command `dbt build` failed at 21:25:02.087364 after 9.81 seconds
[0m21:25:02.088063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C8FA69D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C8E4B6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C90EC3530>]}
[0m21:25:02.088546 [debug] [MainThread]: Flushing usage events
[0m21:26:28.603386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001469EEBEE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146A1928550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146A1928410>]}


============================== 21:26:28.608884 | 5c5d7d9f-111d-458a-ae75-94d30e94de37 ==============================
[0m21:26:28.608884 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:26:28.610195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select the_most_popular_customer', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:26:28.922739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c5d7d9f-111d-458a-ae75-94d30e94de37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146A2D38510>]}
[0m21:26:28.996453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c5d7d9f-111d-458a-ae75-94d30e94de37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146A18D7F00>]}
[0m21:26:29.002238 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m21:26:29.015978 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:26:29.214944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:26:29.215780 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\marts\the_most_popular_customer.sql
[0m21:26:29.523945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c5d7d9f-111d-458a-ae75-94d30e94de37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146A1B0CE50>]}
[0m21:26:29.656256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c5d7d9f-111d-458a-ae75-94d30e94de37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146A1ACFF20>]}
[0m21:26:29.656976 [info ] [MainThread]: Found 5 seeds, 6 models, 421 macros
[0m21:26:29.657670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c5d7d9f-111d-458a-ae75-94d30e94de37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146A301E350>]}
[0m21:26:29.659917 [info ] [MainThread]: 
[0m21:26:29.661050 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:26:29.662490 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m21:26:29.787748 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m21:26:29.788309 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m21:26:29.788722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:29.805116 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:26:29.807023 [debug] [ThreadPool]: On list_assignment_4: Close
[0m21:26:29.810913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m21:26:29.811668 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m21:26:29.820538 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:26:29.821193 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m21:26:29.821608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:29.835314 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:26:29.837231 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:26:29.837688 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m21:26:29.838394 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:26:29.838808 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:26:29.839195 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m21:26:29.840174 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:26:29.842329 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m21:26:29.842914 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:26:29.843298 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m21:26:29.843975 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:26:29.844403 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m21:26:29.855952 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m21:26:29.863539 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m21:26:29.864074 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m21:26:29.864458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:29.877526 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:26:29.878079 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m21:26:29.878499 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m21:26:29.935445 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m21:26:29.937578 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m21:26:29.939630 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m21:26:29.940108 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m21:26:29.947602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c5d7d9f-111d-458a-ae75-94d30e94de37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146A3299300>]}
[0m21:26:29.948401 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:29.949016 [debug] [MainThread]: On master: BEGIN
[0m21:26:29.949451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:29.962537 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m21:26:29.963101 [debug] [MainThread]: On master: COMMIT
[0m21:26:29.963493 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:29.963866 [debug] [MainThread]: On master: COMMIT
[0m21:26:29.964509 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:26:29.964934 [debug] [MainThread]: On master: Close
[0m21:26:29.969438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:26:29.970390 [info ] [MainThread]: 
[0m21:26:29.979604 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m21:26:29.980760 [info ] [Thread-1 (]: 1 of 1 START sql table model main.the_most_popular_customer .................... [RUN]
[0m21:26:29.982000 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.the_most_popular_customer'
[0m21:26:29.982541 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m21:26:29.993217 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m21:26:29.994799 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m21:26:30.051638 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m21:26:30.053675 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:26:30.054619 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m21:26:30.055396 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:26:30.073476 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m21:26:30.074114 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:26:30.074817 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC
LIMIT 1;
    );
  
  
[0m21:26:30.076115 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC
LIMIT 1;
    );
  
  
[0m21:26:30.076754 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:26:30.077465 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: ROLLBACK
[0m21:26:30.087711 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.the_most_popular_customer'
[0m21:26:30.088343 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m21:26:30.101381 [debug] [Thread-1 (]: Runtime Error in model the_most_popular_customer (models\marts\the_most_popular_customer.sql)
  Parser Error: syntax error at or near ";"
[0m21:26:30.103453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5d7d9f-111d-458a-ae75-94d30e94de37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146A309DA90>]}
[0m21:26:30.104437 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.the_most_popular_customer ........... [[31mERROR[0m in 0.12s]
[0m21:26:30.106028 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m21:26:30.113371 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:30.113922 [debug] [MainThread]: On master: BEGIN
[0m21:26:30.114314 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:30.129161 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m21:26:30.129747 [debug] [MainThread]: On master: COMMIT
[0m21:26:30.130170 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:30.130563 [debug] [MainThread]: On master: COMMIT
[0m21:26:30.131258 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:26:30.131689 [debug] [MainThread]: On master: Close
[0m21:26:30.135089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:30.135634 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m21:26:30.135990 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m21:26:30.136334 [debug] [MainThread]: Connection 'model.assignment_4.the_most_popular_customer' was properly closed.
[0m21:26:30.137095 [info ] [MainThread]: 
[0m21:26:30.138021 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m21:26:30.139970 [debug] [MainThread]: Command end result
[0m21:26:30.181269 [info ] [MainThread]: 
[0m21:26:30.182376 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:26:30.183127 [info ] [MainThread]: 
[0m21:26:30.184066 [error] [MainThread]:   Runtime Error in model the_most_popular_customer (models\marts\the_most_popular_customer.sql)
  Parser Error: syntax error at or near ";"
[0m21:26:30.184783 [info ] [MainThread]: 
[0m21:26:30.185469 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:26:30.186976 [debug] [MainThread]: Command `dbt run` failed at 21:26:30.186762 after 1.80 seconds
[0m21:26:30.187515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146A3003960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146A33DE850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146A33DEB70>]}
[0m21:26:30.187994 [debug] [MainThread]: Flushing usage events
[0m21:27:11.574143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8106AEE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C813108550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C813108410>]}


============================== 21:27:11.579341 | 51b3f257-26c4-4c5b-b852-61fc3bb6758f ==============================
[0m21:27:11.579341 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:27:11.580649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select the_most_popular_customer', 'send_anonymous_usage_stats': 'True'}
[0m21:27:11.892884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51b3f257-26c4-4c5b-b852-61fc3bb6758f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C814460510>]}
[0m21:27:11.974926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51b3f257-26c4-4c5b-b852-61fc3bb6758f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8130B3F00>]}
[0m21:27:11.981000 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m21:27:11.992936 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:27:12.184431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:27:12.184958 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:27:12.236393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51b3f257-26c4-4c5b-b852-61fc3bb6758f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8132EC350>]}
[0m21:27:12.367294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51b3f257-26c4-4c5b-b852-61fc3bb6758f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8132AFF20>]}
[0m21:27:12.368080 [info ] [MainThread]: Found 5 seeds, 6 models, 421 macros
[0m21:27:12.368790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51b3f257-26c4-4c5b-b852-61fc3bb6758f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C81334CE50>]}
[0m21:27:12.370931 [info ] [MainThread]: 
[0m21:27:12.371954 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:27:12.374075 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m21:27:12.506046 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m21:27:12.506603 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m21:27:12.507015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:12.524603 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m21:27:12.526704 [debug] [ThreadPool]: On list_assignment_4: Close
[0m21:27:12.530342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m21:27:12.531103 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m21:27:12.540149 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:27:12.540725 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m21:27:12.541129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:12.554490 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:27:12.556423 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:27:12.556897 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m21:27:12.557594 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:27:12.558005 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:27:12.558387 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m21:27:12.559102 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:27:12.560306 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m21:27:12.560720 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:27:12.561204 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m21:27:12.561885 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:27:12.562314 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m21:27:12.573190 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m21:27:12.584219 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m21:27:12.584770 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m21:27:12.585183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:12.599825 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:27:12.600572 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m21:27:12.601069 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m21:27:12.669917 [debug] [ThreadPool]: SQL status: OK in 0.068 seconds
[0m21:27:12.672073 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m21:27:12.674113 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m21:27:12.674601 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m21:27:12.683238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51b3f257-26c4-4c5b-b852-61fc3bb6758f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C81465C390>]}
[0m21:27:12.683920 [debug] [MainThread]: Using duckdb connection "master"
[0m21:27:12.684330 [debug] [MainThread]: On master: BEGIN
[0m21:27:12.684705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:12.697442 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m21:27:12.697997 [debug] [MainThread]: On master: COMMIT
[0m21:27:12.698387 [debug] [MainThread]: Using duckdb connection "master"
[0m21:27:12.698770 [debug] [MainThread]: On master: COMMIT
[0m21:27:12.699378 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:27:12.699803 [debug] [MainThread]: On master: Close
[0m21:27:12.702758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:27:12.703521 [info ] [MainThread]: 
[0m21:27:12.708371 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m21:27:12.709200 [info ] [Thread-1 (]: 1 of 1 START sql table model main.the_most_popular_customer .................... [RUN]
[0m21:27:12.710399 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.the_most_popular_customer'
[0m21:27:12.711027 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m21:27:12.722413 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m21:27:12.724009 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m21:27:12.776222 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m21:27:12.777840 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:27:12.778780 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m21:27:12.779302 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:27:12.792924 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:27:12.793699 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:27:12.831598 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC
LIMIT 1;
    );
  
  
[0m21:27:12.833355 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC
LIMIT 1;
    );
  
  
[0m21:27:12.833901 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:27:12.834527 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: ROLLBACK
[0m21:27:12.844280 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.the_most_popular_customer'
[0m21:27:12.844874 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m21:27:12.854517 [debug] [Thread-1 (]: Runtime Error in model the_most_popular_customer (models\marts\the_most_popular_customer.sql)
  Parser Error: syntax error at or near ";"
[0m21:27:12.856480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b3f257-26c4-4c5b-b852-61fc3bb6758f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8148A9610>]}
[0m21:27:12.857362 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.the_most_popular_customer ........... [[31mERROR[0m in 0.15s]
[0m21:27:12.858994 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m21:27:12.861751 [debug] [MainThread]: Using duckdb connection "master"
[0m21:27:12.862273 [debug] [MainThread]: On master: BEGIN
[0m21:27:12.862787 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:27:12.876001 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m21:27:12.876562 [debug] [MainThread]: On master: COMMIT
[0m21:27:12.876951 [debug] [MainThread]: Using duckdb connection "master"
[0m21:27:12.877326 [debug] [MainThread]: On master: COMMIT
[0m21:27:12.877939 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:27:12.878808 [debug] [MainThread]: On master: Close
[0m21:27:12.882973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:12.883504 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m21:27:12.883862 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m21:27:12.884201 [debug] [MainThread]: Connection 'model.assignment_4.the_most_popular_customer' was properly closed.
[0m21:27:12.884928 [info ] [MainThread]: 
[0m21:27:12.885784 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m21:27:12.887136 [debug] [MainThread]: Command end result
[0m21:27:12.929277 [info ] [MainThread]: 
[0m21:27:12.930497 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:27:12.931357 [info ] [MainThread]: 
[0m21:27:12.932168 [error] [MainThread]:   Runtime Error in model the_most_popular_customer (models\marts\the_most_popular_customer.sql)
  Parser Error: syntax error at or near ";"
[0m21:27:12.932815 [info ] [MainThread]: 
[0m21:27:12.933490 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:27:12.934986 [debug] [MainThread]: Command `dbt run` failed at 21:27:12.934773 after 1.51 seconds
[0m21:27:12.935524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8146A9180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C814953F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8149525D0>]}
[0m21:27:12.936004 [debug] [MainThread]: Flushing usage events
[0m21:29:54.894973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2799CEE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A27C438550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A27C438410>]}


============================== 21:29:54.900318 | 394c89a8-c1b1-45bf-b3ce-15a67e894990 ==============================
[0m21:29:54.900318 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:29:54.901612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select the_most_popular_customer', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:29:55.215461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '394c89a8-c1b1-45bf-b3ce-15a67e894990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A27D800510>]}
[0m21:29:55.291728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '394c89a8-c1b1-45bf-b3ce-15a67e894990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A27C3E7F00>]}
[0m21:29:55.297864 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m21:29:55.310781 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:29:55.510262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:29:55.511097 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\marts\the_most_popular_customer.sql
[0m21:29:55.820599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '394c89a8-c1b1-45bf-b3ce-15a67e894990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A27C61CE50>]}
[0m21:29:55.950131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '394c89a8-c1b1-45bf-b3ce-15a67e894990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A27C5DFF20>]}
[0m21:29:55.950885 [info ] [MainThread]: Found 5 seeds, 6 models, 421 macros
[0m21:29:55.951590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '394c89a8-c1b1-45bf-b3ce-15a67e894990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A27DAFE350>]}
[0m21:29:55.954204 [info ] [MainThread]: 
[0m21:29:55.955506 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:29:55.957163 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m21:29:56.085013 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m21:29:56.085861 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m21:29:56.087323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:56.106288 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m21:29:56.108167 [debug] [ThreadPool]: On list_assignment_4: Close
[0m21:29:56.111781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m21:29:56.112528 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m21:29:56.121700 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:29:56.122252 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m21:29:56.122652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:56.136446 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:29:56.138565 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:29:56.139031 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m21:29:56.139714 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:29:56.140122 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:29:56.140506 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m21:29:56.141289 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:29:56.142509 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m21:29:56.142922 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m21:29:56.143298 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m21:29:56.143960 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:29:56.144388 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m21:29:56.156027 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m21:29:56.164628 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m21:29:56.165168 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m21:29:56.165551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:56.178926 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:29:56.179476 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m21:29:56.179941 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m21:29:56.237769 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m21:29:56.239918 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m21:29:56.241969 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m21:29:56.242450 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m21:29:56.250721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '394c89a8-c1b1-45bf-b3ce-15a67e894990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A27DD79300>]}
[0m21:29:56.251372 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:56.251782 [debug] [MainThread]: On master: BEGIN
[0m21:29:56.252147 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:56.265510 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m21:29:56.266075 [debug] [MainThread]: On master: COMMIT
[0m21:29:56.266464 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:56.266846 [debug] [MainThread]: On master: COMMIT
[0m21:29:56.267470 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:29:56.267898 [debug] [MainThread]: On master: Close
[0m21:29:56.271130 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:56.272103 [info ] [MainThread]: 
[0m21:29:56.282195 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m21:29:56.283413 [info ] [Thread-1 (]: 1 of 1 START sql table model main.the_most_popular_customer .................... [RUN]
[0m21:29:56.285075 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.the_most_popular_customer'
[0m21:29:56.285970 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m21:29:56.298450 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m21:29:56.300076 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m21:29:56.351544 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m21:29:56.353244 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:29:56.354157 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m21:29:56.354622 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:29:56.368366 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m21:29:56.368988 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:29:56.369496 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC
LIMIT 1
    );
  
  
[0m21:29:56.471497 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m21:29:56.480315 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:29:56.480947 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer__dbt_tmp" rename to "the_most_popular_customer"
[0m21:29:56.483441 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:56.510592 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m21:29:56.511215 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:29:56.511684 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m21:29:56.519348 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:29:56.527065 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m21:29:56.527682 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
drop table if exists "assignment_4"."main"."the_most_popular_customer__dbt_backup" cascade
[0m21:29:56.528629 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:29:56.531815 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m21:29:56.558711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '394c89a8-c1b1-45bf-b3ce-15a67e894990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A27DB7DCD0>]}
[0m21:29:56.559681 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.the_most_popular_customer ............... [[32mOK[0m in 0.27s]
[0m21:29:56.560997 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m21:29:56.562835 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:56.563345 [debug] [MainThread]: On master: BEGIN
[0m21:29:56.563947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:56.577581 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m21:29:56.578134 [debug] [MainThread]: On master: COMMIT
[0m21:29:56.578524 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:56.578895 [debug] [MainThread]: On master: COMMIT
[0m21:29:56.579514 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:29:56.580351 [debug] [MainThread]: On master: Close
[0m21:29:56.584641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:56.585150 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m21:29:56.585498 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m21:29:56.585835 [debug] [MainThread]: Connection 'model.assignment_4.the_most_popular_customer' was properly closed.
[0m21:29:56.586289 [info ] [MainThread]: 
[0m21:29:56.587027 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m21:29:56.588647 [debug] [MainThread]: Command end result
[0m21:29:56.629414 [info ] [MainThread]: 
[0m21:29:56.630317 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:56.630996 [info ] [MainThread]: 
[0m21:29:56.631742 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:29:56.633412 [debug] [MainThread]: Command `dbt run` succeeded at 21:29:56.633152 after 1.99 seconds
[0m21:29:56.634017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A27DB0B960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A27D784050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A27D7860D0>]}
[0m21:29:56.634517 [debug] [MainThread]: Flushing usage events
[0m22:04:29.687538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019496F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019460F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201973A07D0>]}


============================== 22:04:29.696705 | 5a587128-6576-4de2-8564-05411b1aa814 ==============================
[0m22:04:29.696705 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:04:29.698137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:04:30.231992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201987A8510>]}
[0m22:04:30.327727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020197377F00>]}
[0m22:04:30.336900 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:04:30.352508 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:04:30.676507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:04:30.677454 [debug] [MainThread]: Partial parsing: added file: assignment_4://models\marts\locations_qw.sql
[0m22:04:31.126212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201975ACE50>]}
[0m22:04:31.330558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020197303B60>]}
[0m22:04:31.331438 [info ] [MainThread]: Found 5 seeds, 7 models, 421 macros
[0m22:04:31.336206 [info ] [MainThread]: 
[0m22:04:31.337258 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:04:31.347159 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:04:31.536836 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:04:31.537957 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:04:31.539454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:31.597941 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m22:04:31.601308 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:04:31.606740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:04:31.607652 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:04:31.619243 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:04:31.619922 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:04:31.620539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:31.639131 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m22:04:31.641468 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:04:31.642048 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:04:31.642883 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:04:31.643407 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:04:31.643892 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:04:31.646229 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:04:31.648020 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:04:31.648586 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:04:31.649081 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:04:31.650021 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:04:31.650604 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:04:31.657648 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:04:31.668541 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:04:31.669199 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:04:31.669678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:31.686608 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:04:31.687263 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:04:31.687793 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:04:31.776570 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m22:04:31.779233 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:04:31.783211 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:04:31.784081 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:04:31.792967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020198C53AF0>]}
[0m22:04:31.793774 [debug] [MainThread]: Using duckdb connection "master"
[0m22:04:31.794285 [debug] [MainThread]: On master: BEGIN
[0m22:04:31.794752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:04:31.811288 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m22:04:31.812015 [debug] [MainThread]: On master: COMMIT
[0m22:04:31.812528 [debug] [MainThread]: Using duckdb connection "master"
[0m22:04:31.813012 [debug] [MainThread]: On master: COMMIT
[0m22:04:31.813802 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:04:31.814331 [debug] [MainThread]: On master: Close
[0m22:04:31.818321 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:04:31.819086 [info ] [MainThread]: 
[0m22:04:31.825728 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m22:04:31.826704 [info ] [Thread-1 (]: 1 of 12 START seed file main.customers ......................................... [RUN]
[0m22:04:31.828881 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m22:04:31.829676 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m22:04:31.830316 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m22:04:32.266345 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:04:32.267100 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m22:04:32.267715 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:04:32.284290 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:04:32.285061 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:04:32.285675 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m22:04:32.328292 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m22:04:32.349711 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:04:32.350482 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:04:32.441013 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m22:04:32.451628 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m22:04:32.482449 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:04:32.483236 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:04:32.483859 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:04:32.533782 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m22:04:32.537081 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m22:04:32.657106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020198E6B380>]}
[0m22:04:32.658086 [info ] [Thread-1 (]: 1 of 12 OK loaded seed file main.customers ..................................... [[32mINSERT 51290[0m in 0.83s]
[0m22:04:32.659332 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m22:04:32.660115 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m22:04:32.661133 [info ] [Thread-1 (]: 2 of 12 START seed file main.locations ......................................... [RUN]
[0m22:04:32.662253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m22:04:32.663041 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m22:04:32.663655 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m22:04:33.258985 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:04:33.259741 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m22:04:33.260409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:33.276874 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:04:33.277630 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:04:33.278239 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m22:04:33.280969 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:04:33.283320 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:04:33.284017 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:04:33.419676 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m22:04:33.420892 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m22:04:33.424627 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:04:33.425365 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:04:33.425963 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:04:33.531559 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m22:04:33.533474 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m22:04:33.726935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019895D3D0>]}
[0m22:04:33.727923 [info ] [Thread-1 (]: 2 of 12 OK loaded seed file main.locations ..................................... [[32mINSERT 51290[0m in 1.06s]
[0m22:04:33.729335 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m22:04:33.730296 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m22:04:33.731292 [info ] [Thread-1 (]: 3 of 12 START seed file main.orders ............................................ [RUN]
[0m22:04:33.732540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m22:04:33.733356 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m22:04:33.733998 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m22:04:37.677874 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:04:37.678619 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m22:04:37.679195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:37.696088 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:04:37.696833 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:04:37.697591 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m22:04:37.700394 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:04:37.702725 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:04:37.703683 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:04:38.192481 [debug] [Thread-1 (]: SQL status: OK in 0.488 seconds
[0m22:04:38.193687 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m22:04:38.197212 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:04:38.197959 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:04:38.198557 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:04:38.336053 [debug] [Thread-1 (]: SQL status: OK in 0.137 seconds
[0m22:04:38.337911 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m22:04:38.674731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020198B65A70>]}
[0m22:04:38.675720 [info ] [Thread-1 (]: 3 of 12 OK loaded seed file main.orders ........................................ [[32mINSERT 51290[0m in 4.94s]
[0m22:04:38.676885 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m22:04:38.677661 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m22:04:38.678899 [info ] [Thread-1 (]: 4 of 12 START seed file main.products .......................................... [RUN]
[0m22:04:38.680089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m22:04:38.680818 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m22:04:38.681431 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m22:04:39.355005 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:04:39.355782 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m22:04:39.356382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:39.373588 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:04:39.374419 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:04:39.375219 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m22:04:39.377491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:39.380005 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:04:39.380743 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:04:39.492639 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m22:04:39.493900 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m22:04:39.498350 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:04:39.499254 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:04:39.499913 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:04:39.600212 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m22:04:39.601708 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m22:04:39.848186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020198774D70>]}
[0m22:04:39.850009 [info ] [Thread-1 (]: 4 of 12 OK loaded seed file main.products ...................................... [[32mINSERT 51290[0m in 1.17s]
[0m22:04:39.851460 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m22:04:39.852378 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m22:04:39.853400 [info ] [Thread-1 (]: 5 of 12 START seed file main.shipping .......................................... [RUN]
[0m22:04:39.854516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m22:04:39.855522 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m22:04:39.856482 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m22:04:41.000397 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:04:41.001148 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m22:04:41.001749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:41.018453 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:04:41.019205 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:04:41.019854 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m22:04:41.022103 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:04:41.024617 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:04:41.025415 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:04:41.334340 [debug] [Thread-1 (]: SQL status: OK in 0.308 seconds
[0m22:04:41.335549 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m22:04:41.339409 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:04:41.340164 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:04:41.340881 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:04:41.426168 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m22:04:41.427938 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m22:04:41.607576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019F820BD0>]}
[0m22:04:41.608593 [info ] [Thread-1 (]: 5 of 12 OK loaded seed file main.shipping ...................................... [[32mINSERT 51290[0m in 1.75s]
[0m22:04:41.609759 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m22:04:41.610577 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m22:04:41.611615 [info ] [Thread-1 (]: 6 of 12 START sql view model main.stg_customers ................................ [RUN]
[0m22:04:41.612672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m22:04:41.614618 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m22:04:41.633856 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m22:04:41.636435 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m22:04:41.696422 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m22:04:41.699778 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:04:41.700608 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m22:04:41.701189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:41.718249 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:04:41.719127 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:04:41.719768 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m22:04:41.721275 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:41.734222 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:04:41.734986 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m22:04:41.738002 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:04:41.743239 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:04:41.743978 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:04:41.745179 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:04:41.751921 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:04:41.752660 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:04:41.753256 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:04:41.758365 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:04:41.769111 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:04:41.770096 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m22:04:41.774038 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:04:41.778415 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m22:04:41.806252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201988E4210>]}
[0m22:04:41.807438 [info ] [Thread-1 (]: 6 of 12 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.19s]
[0m22:04:41.808588 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m22:04:41.809381 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_locations
[0m22:04:41.810823 [info ] [Thread-1 (]: 7 of 12 START sql view model main.stg_locations ................................ [RUN]
[0m22:04:41.812162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_locations)
[0m22:04:41.812849 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_locations
[0m22:04:41.818578 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_locations"
[0m22:04:41.820548 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_locations
[0m22:04:41.826394 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_locations"
[0m22:04:41.828435 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:04:41.829549 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: BEGIN
[0m22:04:41.830513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:41.848814 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:04:41.849686 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:04:41.850519 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */

  
  create view "assignment_4"."main"."stg_locations__dbt_tmp" as (
    SELECT
    DISTINCT
    TRIM("City") AS city,
    TRIM("State") AS state,
    TRIM("Region") AS region,
    TRIM("Country") AS country,
    "Order.ID" AS order_id
FROM "assignment_4"."main"."locations"
  );

[0m22:04:41.852391 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:41.857876 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:04:41.858691 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations" rename to "stg_locations__dbt_backup"
[0m22:04:41.860058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:41.866070 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:04:41.866981 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m22:04:41.868581 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:41.871444 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:04:41.872210 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:04:41.872886 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:04:41.878728 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:04:41.882963 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:04:41.883921 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
drop view if exists "assignment_4"."main"."stg_locations__dbt_backup" cascade
[0m22:04:41.887829 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:04:41.890444 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: Close
[0m22:04:41.910909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019E1DB530>]}
[0m22:04:41.912061 [info ] [Thread-1 (]: 7 of 12 OK created sql view model main.stg_locations ........................... [[32mOK[0m in 0.10s]
[0m22:04:41.913198 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_locations
[0m22:04:41.913918 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m22:04:41.915086 [info ] [Thread-1 (]: 8 of 12 START sql view model main.stg_orders ................................... [RUN]
[0m22:04:41.916530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_locations, now model.assignment_4.stg_orders)
[0m22:04:41.917473 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m22:04:41.922076 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m22:04:41.924075 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m22:04:41.930445 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m22:04:41.932527 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:04:41.933355 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m22:04:41.933950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:41.951246 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:04:41.952131 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:04:41.952857 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m22:04:41.954534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:41.959652 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:04:41.960456 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m22:04:41.961731 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:41.967374 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:04:41.968152 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:04:41.969301 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:41.971919 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:04:41.972717 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:04:41.973393 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:04:41.978417 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:04:41.982661 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:04:41.983428 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m22:04:41.987440 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:04:41.990054 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m22:04:42.011276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201990801D0>]}
[0m22:04:42.012412 [info ] [Thread-1 (]: 8 of 12 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.09s]
[0m22:04:42.013546 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m22:04:42.014317 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m22:04:42.015270 [info ] [Thread-1 (]: 9 of 12 START sql view model main.stg_products ................................. [RUN]
[0m22:04:42.016226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m22:04:42.016911 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m22:04:42.021302 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m22:04:42.023319 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m22:04:42.029577 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m22:04:42.031519 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:04:42.032575 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m22:04:42.033373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:42.050442 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:04:42.051311 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:04:42.052042 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:04:42.053879 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:42.058866 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:04:42.059619 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m22:04:42.060833 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:42.065949 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:04:42.066778 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m22:04:42.067958 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:42.070700 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:04:42.071427 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:04:42.072027 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:04:42.076969 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:04:42.082031 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:04:42.082835 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m22:04:42.086585 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:04:42.089662 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m22:04:42.111097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020199080230>]}
[0m22:04:42.112369 [info ] [Thread-1 (]: 9 of 12 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.09s]
[0m22:04:42.113512 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m22:04:42.114225 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m22:04:42.115162 [info ] [Thread-1 (]: 10 of 12 START sql view model main.stg_shipping ................................ [RUN]
[0m22:04:42.116361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m22:04:42.117475 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m22:04:42.121709 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m22:04:42.123545 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m22:04:42.129426 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m22:04:42.131636 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:04:42.132582 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m22:04:42.133423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:42.150915 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:04:42.151783 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:04:42.152444 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:04:42.153778 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:42.159557 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:04:42.160538 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m22:04:42.161979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:42.167017 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:04:42.167764 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m22:04:42.168955 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:42.171678 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:04:42.172404 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:04:42.173118 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:04:42.178943 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:04:42.182845 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:04:42.183617 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m22:04:42.188503 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:04:42.191256 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m22:04:42.215466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020199080410>]}
[0m22:04:42.216657 [info ] [Thread-1 (]: 10 of 12 OK created sql view model main.stg_shipping ........................... [[32mOK[0m in 0.10s]
[0m22:04:42.217810 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m22:04:42.218513 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m22:04:42.219633 [info ] [Thread-1 (]: 11 of 12 START sql table model main.the_most_popular_customer .................. [RUN]
[0m22:04:42.220768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_shipping, now model.assignment_4.the_most_popular_customer)
[0m22:04:42.221437 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m22:04:42.227623 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m22:04:42.229652 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m22:04:42.270422 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m22:04:42.272432 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:04:42.273245 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m22:04:42.273953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:42.291450 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:04:42.292227 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:04:42.292887 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC
LIMIT 1
    );
  
  
[0m22:04:42.345689 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m22:04:42.351195 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:04:42.352021 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer" rename to "the_most_popular_customer__dbt_backup"
[0m22:04:42.353395 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:42.358238 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:04:42.359038 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer__dbt_tmp" rename to "the_most_popular_customer"
[0m22:04:42.360374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:04:42.370042 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:04:42.370782 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:04:42.371390 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:04:42.377439 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:04:42.381830 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:04:42.382661 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
drop table if exists "assignment_4"."main"."the_most_popular_customer__dbt_backup" cascade
[0m22:04:42.387691 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:04:42.390395 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m22:04:42.417623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020198F77E30>]}
[0m22:04:42.418784 [info ] [Thread-1 (]: 11 of 12 OK created sql table model main.the_most_popular_customer ............. [[32mOK[0m in 0.20s]
[0m22:04:42.419932 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m22:04:42.420770 [debug] [Thread-1 (]: Began running node model.assignment_4.locations_qw
[0m22:04:42.421961 [info ] [Thread-1 (]: 12 of 12 START sql table model main.locations_qw ............................... [RUN]
[0m22:04:42.422976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.the_most_popular_customer, now model.assignment_4.locations_qw)
[0m22:04:42.423617 [debug] [Thread-1 (]: Began compiling node model.assignment_4.locations_qw
[0m22:04:42.429398 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.locations_qw"
[0m22:04:42.431323 [debug] [Thread-1 (]: Began executing node model.assignment_4.locations_qw
[0m22:04:42.436805 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.locations_qw"
[0m22:04:42.439207 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:04:42.439993 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: BEGIN
[0m22:04:42.440576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:42.458278 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:04:42.459097 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:04:42.459794 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC;
    );
  
  
[0m22:04:42.470110 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC;
    );
  
  
[0m22:04:42.470955 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:04:42.471726 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: ROLLBACK
[0m22:04:42.494929 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.locations_qw'
[0m22:04:42.495692 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: Close
[0m22:04:42.506659 [debug] [Thread-1 (]: Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Parser Error: syntax error at or near ";"
[0m22:04:42.507515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a587128-6576-4de2-8564-05411b1aa814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019EFB6330>]}
[0m22:04:42.508616 [error] [Thread-1 (]: 12 of 12 ERROR creating sql table model main.locations_qw ...................... [[31mERROR[0m in 0.08s]
[0m22:04:42.510116 [debug] [Thread-1 (]: Finished running node model.assignment_4.locations_qw
[0m22:04:42.513061 [debug] [MainThread]: Using duckdb connection "master"
[0m22:04:42.513723 [debug] [MainThread]: On master: BEGIN
[0m22:04:42.514199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:04:42.530799 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m22:04:42.531472 [debug] [MainThread]: On master: COMMIT
[0m22:04:42.532051 [debug] [MainThread]: Using duckdb connection "master"
[0m22:04:42.532600 [debug] [MainThread]: On master: COMMIT
[0m22:04:42.533496 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:04:42.534046 [debug] [MainThread]: On master: Close
[0m22:04:42.537775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:42.538465 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m22:04:42.539085 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m22:04:42.539550 [debug] [MainThread]: Connection 'model.assignment_4.locations_qw' was properly closed.
[0m22:04:42.540255 [info ] [MainThread]: 
[0m22:04:42.540861 [info ] [MainThread]: Finished running 5 seeds, 5 view models, 2 table models in 0 hours 0 minutes and 11.20 seconds (11.20s).
[0m22:04:42.545719 [debug] [MainThread]: Command end result
[0m22:04:42.608747 [info ] [MainThread]: 
[0m22:04:42.609603 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:04:42.610216 [info ] [MainThread]: 
[0m22:04:42.610935 [error] [MainThread]:   Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Parser Error: syntax error at or near ";"
[0m22:04:42.611691 [info ] [MainThread]: 
[0m22:04:42.612306 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m22:04:42.613973 [debug] [MainThread]: Command `dbt build` failed at 22:04:42.613730 after 13.24 seconds
[0m22:04:42.614631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019B1A5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201973D6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020198CC4170>]}
[0m22:04:42.615232 [debug] [MainThread]: Flushing usage events
[0m22:04:57.763459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E500130E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E4FCBF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E52A507D0>]}


============================== 22:04:57.770251 | d8d7da3c-7668-4784-9088-938618b80a33 ==============================
[0m22:04:57.770251 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:04:57.771239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m22:04:58.166976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E52DEC510>]}
[0m22:04:58.262664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E52A2BF00>]}
[0m22:04:58.270062 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:04:58.285193 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:04:58.530706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:04:58.531737 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\marts\locations_qw.sql
[0m22:04:58.935728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E52C5C750>]}
[0m22:04:59.120086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E529B3B60>]}
[0m22:04:59.121493 [info ] [MainThread]: Found 5 seeds, 7 models, 421 macros
[0m22:04:59.127378 [info ] [MainThread]: 
[0m22:04:59.128565 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:04:59.138518 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:04:59.303376 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:04:59.304370 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:04:59.305175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:59.326096 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m22:04:59.328603 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:04:59.334917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:04:59.335841 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:04:59.347687 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:04:59.348459 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:04:59.349008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:59.366746 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m22:04:59.369105 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:04:59.369712 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:04:59.370577 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:04:59.371100 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:04:59.371598 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:04:59.372499 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:04:59.374180 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:04:59.374748 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:04:59.375237 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:04:59.376071 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:04:59.376622 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:04:59.383670 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:04:59.393529 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:04:59.394185 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:04:59.394661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:59.410937 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m22:04:59.411638 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:04:59.412178 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:04:59.484887 [debug] [ThreadPool]: SQL status: OK in 0.072 seconds
[0m22:04:59.487594 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:04:59.490241 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:04:59.490841 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:04:59.500064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E54333AF0>]}
[0m22:04:59.500913 [debug] [MainThread]: Using duckdb connection "master"
[0m22:04:59.501449 [debug] [MainThread]: On master: BEGIN
[0m22:04:59.501924 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:04:59.518531 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m22:04:59.519285 [debug] [MainThread]: On master: COMMIT
[0m22:04:59.519800 [debug] [MainThread]: Using duckdb connection "master"
[0m22:04:59.520280 [debug] [MainThread]: On master: COMMIT
[0m22:04:59.521107 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:04:59.521647 [debug] [MainThread]: On master: Close
[0m22:04:59.525562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:04:59.526281 [info ] [MainThread]: 
[0m22:04:59.530880 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m22:04:59.531864 [info ] [Thread-1 (]: 1 of 12 START seed file main.customers ......................................... [RUN]
[0m22:04:59.534006 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m22:04:59.534693 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m22:04:59.535354 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m22:04:59.962575 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:04:59.963517 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m22:04:59.964425 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:04:59.980956 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:04:59.981726 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:04:59.982340 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m22:04:59.984980 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:05:00.007332 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:05:00.008095 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:05:00.101513 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m22:05:00.116867 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m22:05:00.164584 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:05:00.165441 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:05:00.166124 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:05:00.246033 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m22:05:00.249196 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m22:05:00.342320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5454B380>]}
[0m22:05:00.343377 [info ] [Thread-1 (]: 1 of 12 OK loaded seed file main.customers ..................................... [[32mINSERT 51290[0m in 0.81s]
[0m22:05:00.344619 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m22:05:00.345442 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m22:05:00.346488 [info ] [Thread-1 (]: 2 of 12 START seed file main.locations ......................................... [RUN]
[0m22:05:00.347526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m22:05:00.348204 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m22:05:00.348828 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m22:05:00.903708 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:05:00.904473 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m22:05:00.905059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:00.921735 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:05:00.922509 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:05:00.923132 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m22:05:00.925526 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:05:00.927909 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:05:00.928624 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:05:01.046753 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m22:05:01.048002 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m22:05:01.051674 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:05:01.052424 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:05:01.053017 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:05:01.162360 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m22:05:01.164697 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m22:05:01.353001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5403D3D0>]}
[0m22:05:01.354089 [info ] [Thread-1 (]: 2 of 12 OK loaded seed file main.locations ..................................... [[32mINSERT 51290[0m in 1.01s]
[0m22:05:01.355312 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m22:05:01.356030 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m22:05:01.357023 [info ] [Thread-1 (]: 3 of 12 START seed file main.orders ............................................ [RUN]
[0m22:05:01.358125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m22:05:01.359190 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m22:05:01.359947 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m22:05:05.269783 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:05:05.270529 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m22:05:05.271117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:05.287781 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:05:05.288554 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:05:05.289169 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m22:05:05.291938 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:05:05.294351 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:05:05.295661 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:05:05.722071 [debug] [Thread-1 (]: SQL status: OK in 0.425 seconds
[0m22:05:05.723293 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m22:05:05.727481 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:05:05.728222 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:05:05.728857 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:05:05.866091 [debug] [Thread-1 (]: SQL status: OK in 0.136 seconds
[0m22:05:05.867760 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m22:05:06.117811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E54245A70>]}
[0m22:05:06.118798 [info ] [Thread-1 (]: 3 of 12 OK loaded seed file main.orders ........................................ [[32mINSERT 51290[0m in 4.76s]
[0m22:05:06.119915 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m22:05:06.120621 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m22:05:06.121592 [info ] [Thread-1 (]: 4 of 12 START seed file main.products .......................................... [RUN]
[0m22:05:06.122678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m22:05:06.123593 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m22:05:06.124280 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m22:05:06.779992 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:05:06.780736 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m22:05:06.781325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:06.797876 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:05:06.798623 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:05:06.799229 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m22:05:06.801433 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:05:06.803667 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:05:06.804330 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:05:06.909199 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m22:05:06.910447 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m22:05:06.914752 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:05:06.915525 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:05:06.916130 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:05:07.010351 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m22:05:07.011843 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m22:05:07.187001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E52DE0D70>]}
[0m22:05:07.187986 [info ] [Thread-1 (]: 4 of 12 OK loaded seed file main.products ...................................... [[32mINSERT 51290[0m in 1.06s]
[0m22:05:07.189242 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m22:05:07.189958 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m22:05:07.190934 [info ] [Thread-1 (]: 5 of 12 START seed file main.shipping .......................................... [RUN]
[0m22:05:07.192026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m22:05:07.192712 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m22:05:07.193329 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m22:05:08.315865 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:05:08.316611 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m22:05:08.317205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:08.334825 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:05:08.335592 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:05:08.336212 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m22:05:08.338824 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:05:08.341294 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:05:08.342034 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:05:08.702603 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m22:05:08.703815 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m22:05:08.708036 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:05:08.708774 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:05:08.709366 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:05:08.797281 [debug] [Thread-1 (]: SQL status: OK in 0.087 seconds
[0m22:05:08.798821 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m22:05:08.913916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E592F0A50>]}
[0m22:05:08.914902 [info ] [Thread-1 (]: 5 of 12 OK loaded seed file main.shipping ...................................... [[32mINSERT 51290[0m in 1.72s]
[0m22:05:08.916025 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m22:05:08.916747 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m22:05:08.917705 [info ] [Thread-1 (]: 6 of 12 START sql view model main.stg_customers ................................ [RUN]
[0m22:05:08.918556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m22:05:08.919188 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m22:05:08.932467 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m22:05:08.934276 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m22:05:08.993894 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m22:05:08.995747 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:05:08.996555 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m22:05:08.997228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:09.014116 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:05:09.015111 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:05:09.015769 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m22:05:09.017268 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.028660 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:05:09.029424 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m22:05:09.030675 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.035361 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:05:09.036165 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:05:09.037393 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.043768 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:05:09.044494 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:05:09.045095 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:05:09.050161 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:05:09.059472 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:05:09.060240 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m22:05:09.064180 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:05:09.067067 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m22:05:09.089927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5408DD30>]}
[0m22:05:09.091073 [info ] [Thread-1 (]: 6 of 12 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.17s]
[0m22:05:09.092191 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m22:05:09.093034 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_locations
[0m22:05:09.094012 [info ] [Thread-1 (]: 7 of 12 START sql view model main.stg_locations ................................ [RUN]
[0m22:05:09.094985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_locations)
[0m22:05:09.095646 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_locations
[0m22:05:09.100897 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_locations"
[0m22:05:09.102694 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_locations
[0m22:05:09.108066 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_locations"
[0m22:05:09.109925 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:05:09.110680 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: BEGIN
[0m22:05:09.111274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:09.133084 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m22:05:09.134018 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:05:09.134735 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */

  
  create view "assignment_4"."main"."stg_locations__dbt_tmp" as (
    SELECT
    DISTINCT
    TRIM("City") AS city,
    TRIM("State") AS state,
    TRIM("Region") AS region,
    TRIM("Country") AS country,
    "Order.ID" AS order_id
FROM "assignment_4"."main"."locations"
  );

[0m22:05:09.136602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.142587 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:05:09.143403 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations" rename to "stg_locations__dbt_backup"
[0m22:05:09.144910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.152652 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:05:09.153788 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m22:05:09.155407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.158568 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:05:09.159312 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:05:09.159952 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:05:09.165576 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:05:09.169371 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:05:09.170062 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
drop view if exists "assignment_4"."main"."stg_locations__dbt_backup" cascade
[0m22:05:09.173946 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:05:09.176398 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: Close
[0m22:05:09.196968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E547605F0>]}
[0m22:05:09.198186 [info ] [Thread-1 (]: 7 of 12 OK created sql view model main.stg_locations ........................... [[32mOK[0m in 0.10s]
[0m22:05:09.199305 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_locations
[0m22:05:09.200009 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m22:05:09.200929 [info ] [Thread-1 (]: 8 of 12 START sql view model main.stg_orders ................................... [RUN]
[0m22:05:09.202193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_locations, now model.assignment_4.stg_orders)
[0m22:05:09.203123 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m22:05:09.207548 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m22:05:09.209397 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m22:05:09.215507 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m22:05:09.217472 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:05:09.218236 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m22:05:09.218823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:09.235513 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:05:09.236267 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:05:09.236909 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m22:05:09.238410 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.243201 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:05:09.243918 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m22:05:09.245114 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.250696 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:05:09.251441 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:05:09.252619 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.255194 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:05:09.255861 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:05:09.256484 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:05:09.263810 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m22:05:09.267603 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:05:09.268305 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m22:05:09.273393 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:05:09.276237 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m22:05:09.300880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E54760710>]}
[0m22:05:09.302026 [info ] [Thread-1 (]: 8 of 12 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.10s]
[0m22:05:09.303161 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m22:05:09.303876 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m22:05:09.304811 [info ] [Thread-1 (]: 9 of 12 START sql view model main.stg_products ................................. [RUN]
[0m22:05:09.305718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m22:05:09.306406 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m22:05:09.310667 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m22:05:09.312399 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m22:05:09.318789 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m22:05:09.320664 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:05:09.321686 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m22:05:09.322929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:09.339791 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:05:09.340597 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:05:09.341243 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:05:09.342623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.347655 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:05:09.348482 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m22:05:09.349690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.354591 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:05:09.355340 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m22:05:09.356519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.359119 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:05:09.359772 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:05:09.360369 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:05:09.365322 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:05:09.370115 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:05:09.370850 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m22:05:09.374858 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:05:09.377561 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m22:05:09.399141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E54760770>]}
[0m22:05:09.400334 [info ] [Thread-1 (]: 9 of 12 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.09s]
[0m22:05:09.401571 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m22:05:09.402456 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m22:05:09.403513 [info ] [Thread-1 (]: 10 of 12 START sql view model main.stg_shipping ................................ [RUN]
[0m22:05:09.404665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m22:05:09.405514 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m22:05:09.410337 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m22:05:09.412360 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m22:05:09.419355 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m22:05:09.421526 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:05:09.422727 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m22:05:09.423838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:09.442801 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m22:05:09.443571 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:05:09.444200 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:05:09.445631 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.452310 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:05:09.453261 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m22:05:09.454590 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.459238 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:05:09.459984 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m22:05:09.461107 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:05:09.464675 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:05:09.465513 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:05:09.466232 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:05:09.472099 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:05:09.476120 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:05:09.476857 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m22:05:09.481137 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:05:09.484119 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m22:05:09.505942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E54760950>]}
[0m22:05:09.507128 [info ] [Thread-1 (]: 10 of 12 OK created sql view model main.stg_shipping ........................... [[32mOK[0m in 0.10s]
[0m22:05:09.508261 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m22:05:09.508965 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m22:05:09.509894 [info ] [Thread-1 (]: 11 of 12 START sql table model main.the_most_popular_customer .................. [RUN]
[0m22:05:09.510727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_shipping, now model.assignment_4.the_most_popular_customer)
[0m22:05:09.511362 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m22:05:09.516815 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m22:05:09.518715 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m22:05:09.556418 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m22:05:09.558393 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:05:09.559156 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m22:05:09.559782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:09.576714 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:05:09.577468 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:05:09.578125 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC
LIMIT 1
    );
  
  
[0m22:05:09.632909 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m22:05:09.638608 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:05:09.639409 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer" rename to "the_most_popular_customer__dbt_backup"
[0m22:05:09.640851 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.645606 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:05:09.646415 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer__dbt_tmp" rename to "the_most_popular_customer"
[0m22:05:09.647966 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:09.657520 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:05:09.658262 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:05:09.658935 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:05:09.699598 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m22:05:09.703543 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:05:09.704281 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
drop table if exists "assignment_4"."main"."the_most_popular_customer__dbt_backup" cascade
[0m22:05:09.708041 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:05:09.710783 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m22:05:09.736206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5AC4F950>]}
[0m22:05:09.737355 [info ] [Thread-1 (]: 11 of 12 OK created sql table model main.the_most_popular_customer ............. [[32mOK[0m in 0.23s]
[0m22:05:09.738486 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m22:05:09.739240 [debug] [Thread-1 (]: Began running node model.assignment_4.locations_qw
[0m22:05:09.740214 [info ] [Thread-1 (]: 12 of 12 START sql table model main.locations_qw ............................... [RUN]
[0m22:05:09.741113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.the_most_popular_customer, now model.assignment_4.locations_qw)
[0m22:05:09.741812 [debug] [Thread-1 (]: Began compiling node model.assignment_4.locations_qw
[0m22:05:09.747268 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.locations_qw"
[0m22:05:09.748925 [debug] [Thread-1 (]: Began executing node model.assignment_4.locations_qw
[0m22:05:09.754172 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.locations_qw"
[0m22:05:09.755903 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:05:09.756649 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: BEGIN
[0m22:05:09.757226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:09.774408 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:05:09.775171 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:05:09.775822 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:05:09.784539 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:05:09.785387 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:05:09.786163 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: ROLLBACK
[0m22:05:09.798791 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.locations_qw'
[0m22:05:09.799537 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: Close
[0m22:05:09.810467 [debug] [Thread-1 (]: Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:05:09.811395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d7da3c-7668-4784-9088-938618b80a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5AC4E270>]}
[0m22:05:09.812410 [error] [Thread-1 (]: 12 of 12 ERROR creating sql table model main.locations_qw ...................... [[31mERROR[0m in 0.07s]
[0m22:05:09.813589 [debug] [Thread-1 (]: Finished running node model.assignment_4.locations_qw
[0m22:05:09.816481 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:09.817141 [debug] [MainThread]: On master: BEGIN
[0m22:05:09.817624 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:09.833411 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m22:05:09.834084 [debug] [MainThread]: On master: COMMIT
[0m22:05:09.834591 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:09.835070 [debug] [MainThread]: On master: COMMIT
[0m22:05:09.835876 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:05:09.836417 [debug] [MainThread]: On master: Close
[0m22:05:09.840567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:09.841207 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m22:05:09.841675 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m22:05:09.842108 [debug] [MainThread]: Connection 'model.assignment_4.locations_qw' was properly closed.
[0m22:05:09.842804 [info ] [MainThread]: 
[0m22:05:09.843414 [info ] [MainThread]: Finished running 5 seeds, 5 view models, 2 table models in 0 hours 0 minutes and 10.71 seconds (10.71s).
[0m22:05:09.848252 [debug] [MainThread]: Command end result
[0m22:05:09.908760 [info ] [MainThread]: 
[0m22:05:09.909633 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:05:09.910240 [info ] [MainThread]: 
[0m22:05:09.911047 [error] [MainThread]:   Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:05:09.911838 [info ] [MainThread]: 
[0m22:05:09.912440 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m22:05:09.914061 [debug] [MainThread]: Command `dbt build` failed at 22:05:09.913822 after 12.33 seconds
[0m22:05:09.914718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E598C35F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E52A7F6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E54760770>]}
[0m22:05:09.915333 [debug] [MainThread]: Flushing usage events
[0m22:07:29.681073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021342EFEE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021345958550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021345958410>]}


============================== 22:07:29.687463 | b2ef52c7-144d-45b4-87ff-2c04b5f85537 ==============================
[0m22:07:29.687463 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:29.688861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select locations_qw', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:30.077402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2ef52c7-144d-45b4-87ff-2c04b5f85537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021346D30510>]}
[0m22:07:30.183298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2ef52c7-144d-45b4-87ff-2c04b5f85537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021345907F00>]}
[0m22:07:30.190710 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:07:30.208028 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:07:30.454184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:07:30.454819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:07:30.519862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2ef52c7-144d-45b4-87ff-2c04b5f85537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021345B3C350>]}
[0m22:07:30.689492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2ef52c7-144d-45b4-87ff-2c04b5f85537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021346E70AA0>]}
[0m22:07:30.690358 [info ] [MainThread]: Found 5 seeds, 7 models, 421 macros
[0m22:07:30.691195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2ef52c7-144d-45b4-87ff-2c04b5f85537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021345B9CE50>]}
[0m22:07:30.693899 [info ] [MainThread]: 
[0m22:07:30.695197 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:30.698096 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:07:30.860929 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:07:30.861621 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:07:30.862243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:30.882560 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m22:07:30.884867 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:07:30.889639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:07:30.890543 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:07:30.902545 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:07:30.903217 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:07:30.903728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:30.920352 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:07:30.922706 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:07:30.923408 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:07:30.924280 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:07:30.924798 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:07:30.925286 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:07:30.926189 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:07:30.927701 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:07:30.928229 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:07:30.928713 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:07:30.929521 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:07:30.930066 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:07:30.944346 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:07:30.954281 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:07:30.954932 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:07:30.955412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:30.971577 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m22:07:30.972232 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:07:30.972760 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:07:31.051153 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m22:07:31.053820 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:07:31.056274 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:07:31.056866 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:07:31.066735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2ef52c7-144d-45b4-87ff-2c04b5f85537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021347117380>]}
[0m22:07:31.067538 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:31.068055 [debug] [MainThread]: On master: BEGIN
[0m22:07:31.068527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:31.085380 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m22:07:31.086057 [debug] [MainThread]: On master: COMMIT
[0m22:07:31.086558 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:31.087035 [debug] [MainThread]: On master: COMMIT
[0m22:07:31.087844 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:07:31.088381 [debug] [MainThread]: On master: Close
[0m22:07:31.092209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:07:31.093262 [info ] [MainThread]: 
[0m22:07:31.102831 [debug] [Thread-1 (]: Began running node model.assignment_4.locations_qw
[0m22:07:31.104747 [info ] [Thread-1 (]: 1 of 1 START sql table model main.locations_qw ................................. [RUN]
[0m22:07:31.106742 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.locations_qw'
[0m22:07:31.108004 [debug] [Thread-1 (]: Began compiling node model.assignment_4.locations_qw
[0m22:07:31.122170 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.locations_qw"
[0m22:07:31.123848 [debug] [Thread-1 (]: Began executing node model.assignment_4.locations_qw
[0m22:07:31.187720 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.locations_qw"
[0m22:07:31.189825 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:07:31.190861 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: BEGIN
[0m22:07:31.191602 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:07:31.207833 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:07:31.208598 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:07:31.209244 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:07:31.211377 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:07:31.212125 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:07:31.212896 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: ROLLBACK
[0m22:07:31.225410 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.locations_qw'
[0m22:07:31.226149 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: Close
[0m22:07:31.236851 [debug] [Thread-1 (]: Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:07:31.239367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2ef52c7-144d-45b4-87ff-2c04b5f85537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021347174E90>]}
[0m22:07:31.240456 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.locations_qw ........................ [[31mERROR[0m in 0.13s]
[0m22:07:31.242340 [debug] [Thread-1 (]: Finished running node model.assignment_4.locations_qw
[0m22:07:31.245910 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:31.246709 [debug] [MainThread]: On master: BEGIN
[0m22:07:31.247196 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:31.263857 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m22:07:31.264534 [debug] [MainThread]: On master: COMMIT
[0m22:07:31.265033 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:31.265551 [debug] [MainThread]: On master: COMMIT
[0m22:07:31.266325 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:07:31.266861 [debug] [MainThread]: On master: Close
[0m22:07:31.270667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:31.271272 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m22:07:31.271722 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m22:07:31.272151 [debug] [MainThread]: Connection 'model.assignment_4.locations_qw' was properly closed.
[0m22:07:31.272697 [info ] [MainThread]: 
[0m22:07:31.273635 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m22:07:31.275187 [debug] [MainThread]: Command end result
[0m22:07:31.329649 [info ] [MainThread]: 
[0m22:07:31.330829 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:07:31.331739 [info ] [MainThread]: 
[0m22:07:31.332889 [error] [MainThread]:   Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:07:31.334221 [info ] [MainThread]: 
[0m22:07:31.335124 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:07:31.337008 [debug] [MainThread]: Command `dbt run` failed at 22:07:31.336748 after 1.96 seconds
[0m22:07:31.337670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021346F75180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021347227A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021347226670>]}
[0m22:07:31.338384 [debug] [MainThread]: Flushing usage events
[0m22:19:46.952046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB48F30E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB459F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB73307D0>]}


============================== 22:19:46.958510 | b82a45db-8d2b-43f7-9d3f-e08d1ec2d525 ==============================
[0m22:19:46.958510 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:19:46.959577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:19:47.355207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB8748510>]}
[0m22:19:47.456453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB7307F00>]}
[0m22:19:47.463805 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:19:47.478707 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:19:47.738068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:19:47.739034 [debug] [MainThread]: Partial parsing: added file: assignment_4://models\marts\orders_qw.sql
[0m22:19:48.155494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB753C750>]}
[0m22:19:48.342103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB7293B60>]}
[0m22:19:48.342992 [info ] [MainThread]: Found 5 seeds, 8 models, 421 macros
[0m22:19:48.347578 [info ] [MainThread]: 
[0m22:19:48.348843 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:19:48.358699 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:19:48.521275 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:19:48.521969 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:19:48.522707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:48.544796 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m22:19:48.547178 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:19:48.552780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:19:48.554023 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:19:48.565692 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:19:48.566376 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:19:48.566887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:19:48.584783 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m22:19:48.587205 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:19:48.587815 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:19:48.588710 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:19:48.589240 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:19:48.589742 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:19:48.590723 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:19:48.592255 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:19:48.592788 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:19:48.593280 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:19:48.594114 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:19:48.594741 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:19:48.601878 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:19:48.611651 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:19:48.612299 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:19:48.612803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:48.629649 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:19:48.630340 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:19:48.630877 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:19:48.705786 [debug] [ThreadPool]: SQL status: OK in 0.074 seconds
[0m22:19:48.708488 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:19:48.711171 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:19:48.711811 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:19:48.721157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB8BF3AF0>]}
[0m22:19:48.721964 [debug] [MainThread]: Using duckdb connection "master"
[0m22:19:48.722495 [debug] [MainThread]: On master: BEGIN
[0m22:19:48.722966 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:19:48.739590 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m22:19:48.740257 [debug] [MainThread]: On master: COMMIT
[0m22:19:48.740765 [debug] [MainThread]: Using duckdb connection "master"
[0m22:19:48.741245 [debug] [MainThread]: On master: COMMIT
[0m22:19:48.742154 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:19:48.742713 [debug] [MainThread]: On master: Close
[0m22:19:48.746701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:19:48.747687 [info ] [MainThread]: 
[0m22:19:48.752516 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m22:19:48.753463 [info ] [Thread-1 (]: 1 of 13 START seed file main.customers ......................................... [RUN]
[0m22:19:48.755673 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m22:19:48.756310 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m22:19:48.756933 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m22:19:49.187407 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:19:49.188168 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m22:19:49.188760 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:19:49.204660 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:19:49.205417 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:19:49.206052 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m22:19:49.208312 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:19:49.229519 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:19:49.230291 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:19:49.308354 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m22:19:49.318876 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m22:19:49.347431 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:19:49.348192 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:19:49.348797 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:19:49.430300 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m22:19:49.433739 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m22:19:49.540189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB8E132B0>]}
[0m22:19:49.541175 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file main.customers ..................................... [[32mINSERT 51290[0m in 0.78s]
[0m22:19:49.542810 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m22:19:49.543638 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m22:19:49.544816 [info ] [Thread-1 (]: 2 of 13 START seed file main.locations ......................................... [RUN]
[0m22:19:49.545918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m22:19:49.546560 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m22:19:49.547167 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m22:19:50.112342 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:19:50.113119 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m22:19:50.113853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:50.130297 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:19:50.131071 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:19:50.131692 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m22:19:50.133809 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:50.136115 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:19:50.136826 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:19:50.255832 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m22:19:50.257096 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m22:19:50.260661 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:19:50.261393 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:19:50.261984 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:19:50.328378 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m22:19:50.330204 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m22:19:50.559746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB88F90D0>]}
[0m22:19:50.560738 [info ] [Thread-1 (]: 2 of 13 OK loaded seed file main.locations ..................................... [[32mINSERT 51290[0m in 1.01s]
[0m22:19:50.561857 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m22:19:50.562558 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m22:19:50.563540 [info ] [Thread-1 (]: 3 of 13 START seed file main.orders ............................................ [RUN]
[0m22:19:50.564616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m22:19:50.565545 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m22:19:50.566260 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m22:19:54.470898 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:19:54.471671 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m22:19:54.472257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:54.489518 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:19:54.490280 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:19:54.490886 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m22:19:54.493095 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:19:54.495430 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:19:54.496123 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:19:54.952636 [debug] [Thread-1 (]: SQL status: OK in 0.456 seconds
[0m22:19:54.953852 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m22:19:54.957449 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:19:54.958187 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:19:54.958777 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:19:55.093802 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m22:19:55.096189 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m22:19:55.421394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB8B09A70>]}
[0m22:19:55.422704 [info ] [Thread-1 (]: 3 of 13 OK loaded seed file main.orders ........................................ [[32mINSERT 51290[0m in 4.86s]
[0m22:19:55.423835 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m22:19:55.424532 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m22:19:55.425607 [info ] [Thread-1 (]: 4 of 13 START seed file main.products .......................................... [RUN]
[0m22:19:55.426658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m22:19:55.427332 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m22:19:55.427940 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m22:19:56.111764 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:19:56.112577 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m22:19:56.113183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:56.129875 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:19:56.130627 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:19:56.131241 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m22:19:56.133972 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:19:56.136215 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:19:56.136864 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:19:56.242269 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m22:19:56.243543 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m22:19:56.247203 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:19:56.247971 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:19:56.248609 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:19:56.346265 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m22:19:56.348043 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m22:19:56.524103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB8718D70>]}
[0m22:19:56.525143 [info ] [Thread-1 (]: 4 of 13 OK loaded seed file main.products ...................................... [[32mINSERT 51290[0m in 1.10s]
[0m22:19:56.526268 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m22:19:56.527136 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m22:19:56.528219 [info ] [Thread-1 (]: 5 of 13 START seed file main.shipping .......................................... [RUN]
[0m22:19:56.529351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m22:19:56.530292 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m22:19:56.530938 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m22:19:57.694166 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:19:57.694944 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m22:19:57.695523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:57.712376 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:19:57.713125 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:19:57.713738 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m22:19:57.716255 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:19:57.718470 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:19:57.719133 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:19:58.062328 [debug] [Thread-1 (]: SQL status: OK in 0.342 seconds
[0m22:19:58.063537 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m22:19:58.067014 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:19:58.067767 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:19:58.068361 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:19:58.155244 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m22:19:58.157114 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m22:19:58.337437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011ABF3C53D0>]}
[0m22:19:58.338414 [info ] [Thread-1 (]: 5 of 13 OK loaded seed file main.shipping ...................................... [[32mINSERT 51290[0m in 1.81s]
[0m22:19:58.339524 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m22:19:58.340255 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m22:19:58.341284 [info ] [Thread-1 (]: 6 of 13 START sql view model main.stg_customers ................................ [RUN]
[0m22:19:58.342161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m22:19:58.342792 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m22:19:58.355806 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m22:19:58.357619 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m22:19:58.415004 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m22:19:58.416819 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:19:58.417608 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m22:19:58.418199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:58.435009 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:19:58.435755 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:19:58.436373 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m22:19:58.438042 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.449566 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:19:58.450320 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m22:19:58.451561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.456454 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:19:58.457171 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:19:58.458342 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.464570 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:19:58.465290 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:19:58.465887 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:19:58.508202 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m22:19:58.517513 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:19:58.518270 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m22:19:58.522556 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:19:58.525312 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m22:19:58.547528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB8938750>]}
[0m22:19:58.549189 [info ] [Thread-1 (]: 6 of 13 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.21s]
[0m22:19:58.550774 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m22:19:58.551650 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_locations
[0m22:19:58.552767 [info ] [Thread-1 (]: 7 of 13 START sql view model main.stg_locations ................................ [RUN]
[0m22:19:58.553998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_locations)
[0m22:19:58.554961 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_locations
[0m22:19:58.560627 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_locations"
[0m22:19:58.562951 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_locations
[0m22:19:58.568836 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_locations"
[0m22:19:58.570640 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:19:58.571426 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: BEGIN
[0m22:19:58.572004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:58.589074 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:19:58.589812 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:19:58.590437 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */

  
  create view "assignment_4"."main"."stg_locations__dbt_tmp" as (
    SELECT
    DISTINCT
    TRIM("City") AS city,
    TRIM("State") AS state,
    TRIM("Region") AS region,
    TRIM("Country") AS country,
    "Order.ID" AS order_id
FROM "assignment_4"."main"."locations"
  );

[0m22:19:58.591926 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.596978 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:19:58.597992 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations" rename to "stg_locations__dbt_backup"
[0m22:19:58.599295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.604666 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:19:58.605406 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m22:19:58.606579 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.609185 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:19:58.609844 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:19:58.610468 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:19:58.615854 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:19:58.619766 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:19:58.620498 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
drop view if exists "assignment_4"."main"."stg_locations__dbt_backup" cascade
[0m22:19:58.624993 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:19:58.628635 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: Close
[0m22:19:58.649013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB73B5310>]}
[0m22:19:58.650212 [info ] [Thread-1 (]: 7 of 13 OK created sql view model main.stg_locations ........................... [[32mOK[0m in 0.10s]
[0m22:19:58.651425 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_locations
[0m22:19:58.652218 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m22:19:58.653181 [info ] [Thread-1 (]: 8 of 13 START sql view model main.stg_orders ................................... [RUN]
[0m22:19:58.654177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_locations, now model.assignment_4.stg_orders)
[0m22:19:58.654848 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m22:19:58.659139 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m22:19:58.660939 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m22:19:58.667035 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m22:19:58.668861 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:19:58.669612 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m22:19:58.670198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:58.686957 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:19:58.687756 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:19:58.688409 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m22:19:58.690220 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.695148 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:19:58.695872 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m22:19:58.697123 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.702384 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:19:58.703108 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:19:58.704293 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.707024 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:19:58.707722 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:19:58.708321 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:19:58.714595 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:19:58.719397 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:19:58.720156 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m22:19:58.724186 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:19:58.726951 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m22:19:58.749013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB9020950>]}
[0m22:19:58.750243 [info ] [Thread-1 (]: 8 of 13 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.09s]
[0m22:19:58.751392 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m22:19:58.752937 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m22:19:58.755914 [info ] [Thread-1 (]: 9 of 13 START sql view model main.stg_products ................................. [RUN]
[0m22:19:58.758135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m22:19:58.759343 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m22:19:58.765260 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m22:19:58.767650 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m22:19:58.776790 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m22:19:58.779416 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:19:58.780629 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m22:19:58.781687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:58.799818 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:19:58.800642 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:19:58.801500 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:19:58.803190 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.808605 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:19:58.809441 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m22:19:58.810799 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.816690 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:19:58.817651 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m22:19:58.819042 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.821786 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:19:58.822480 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:19:58.823082 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:19:58.827822 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:19:58.833047 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:19:58.833865 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m22:19:58.837640 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:19:58.840705 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m22:19:58.864022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB9020A70>]}
[0m22:19:58.865187 [info ] [Thread-1 (]: 9 of 13 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.11s]
[0m22:19:58.866331 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m22:19:58.867336 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m22:19:58.868490 [info ] [Thread-1 (]: 10 of 13 START sql view model main.stg_shipping ................................ [RUN]
[0m22:19:58.869494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m22:19:58.870243 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m22:19:58.874483 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m22:19:58.876399 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m22:19:58.882250 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m22:19:58.884138 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:19:58.884934 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m22:19:58.885607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:58.902813 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:19:58.903716 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:19:58.904526 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:19:58.906107 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.912869 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:19:58.913654 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m22:19:58.914901 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.919977 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:19:58.920733 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m22:19:58.921891 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:58.924667 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:19:58.925710 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:19:58.926569 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:19:58.931611 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:19:58.935879 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:19:58.936613 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m22:19:58.940244 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:19:58.943614 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m22:19:58.964294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB9020B90>]}
[0m22:19:58.965532 [info ] [Thread-1 (]: 10 of 13 OK created sql view model main.stg_shipping ........................... [[32mOK[0m in 0.09s]
[0m22:19:58.966793 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m22:19:58.967671 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m22:19:58.968861 [info ] [Thread-1 (]: 11 of 13 START sql table model main.the_most_popular_customer .................. [RUN]
[0m22:19:58.969970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_shipping, now model.assignment_4.the_most_popular_customer)
[0m22:19:58.970815 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m22:19:58.976458 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m22:19:58.978445 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m22:19:59.016943 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m22:19:59.018807 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:19:59.019568 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m22:19:59.020156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:59.037411 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:19:59.038179 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:19:59.038840 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC
LIMIT 1
    );
  
  
[0m22:19:59.093089 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m22:19:59.098465 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:19:59.099232 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer" rename to "the_most_popular_customer__dbt_backup"
[0m22:19:59.100552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:59.105789 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:19:59.106551 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer__dbt_tmp" rename to "the_most_popular_customer"
[0m22:19:59.107783 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:19:59.117268 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:19:59.118011 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:19:59.118617 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:19:59.158844 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m22:19:59.163202 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:19:59.163994 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
drop table if exists "assignment_4"."main"."the_most_popular_customer__dbt_backup" cascade
[0m22:19:59.168300 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:19:59.171968 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m22:19:59.196896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB6147050>]}
[0m22:19:59.198371 [info ] [Thread-1 (]: 11 of 13 OK created sql table model main.the_most_popular_customer ............. [[32mOK[0m in 0.23s]
[0m22:19:59.199556 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m22:19:59.200284 [debug] [Thread-1 (]: Began running node model.assignment_4.locations_qw
[0m22:19:59.201223 [info ] [Thread-1 (]: 12 of 13 START sql table model main.locations_qw ............................... [RUN]
[0m22:19:59.202101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.the_most_popular_customer, now model.assignment_4.locations_qw)
[0m22:19:59.202729 [debug] [Thread-1 (]: Began compiling node model.assignment_4.locations_qw
[0m22:19:59.207401 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.locations_qw"
[0m22:19:59.209033 [debug] [Thread-1 (]: Began executing node model.assignment_4.locations_qw
[0m22:19:59.214882 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.locations_qw"
[0m22:19:59.216775 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:19:59.217524 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: BEGIN
[0m22:19:59.218129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:59.235148 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:19:59.235891 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:19:59.236539 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:19:59.238711 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:19:59.239502 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:19:59.240265 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: ROLLBACK
[0m22:19:59.253246 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.locations_qw'
[0m22:19:59.253985 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: Close
[0m22:19:59.265523 [debug] [Thread-1 (]: Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:19:59.266437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011ABF5FFC50>]}
[0m22:19:59.267444 [error] [Thread-1 (]: 12 of 13 ERROR creating sql table model main.locations_qw ...................... [[31mERROR[0m in 0.06s]
[0m22:19:59.268677 [debug] [Thread-1 (]: Finished running node model.assignment_4.locations_qw
[0m22:19:59.269499 [debug] [Thread-1 (]: Began running node model.assignment_4.orders_qw
[0m22:19:59.271195 [info ] [Thread-1 (]: 13 of 13 START sql table model main.orders_qw .................................. [RUN]
[0m22:19:59.272325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.locations_qw, now model.assignment_4.orders_qw)
[0m22:19:59.273027 [debug] [Thread-1 (]: Began compiling node model.assignment_4.orders_qw
[0m22:19:59.282838 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.orders_qw"
[0m22:19:59.285674 [debug] [Thread-1 (]: Began executing node model.assignment_4.orders_qw
[0m22:19:59.290951 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.orders_qw"
[0m22:19:59.293142 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:19:59.293918 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: BEGIN
[0m22:19:59.294486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:59.311723 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:19:59.312463 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:19:59.313109 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."orders_qw__dbt_tmp"
  
    as (
      SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."stg_orders"
ORDER BY order_date ASC
LIMIT 5
    );
  
  
[0m22:19:59.316371 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."orders_qw__dbt_tmp"
  
    as (
      SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."stg_orders"
ORDER BY order_date ASC
LIMIT 5
    );
  
  
[0m22:19:59.317278 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:19:59.318153 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: ROLLBACK
[0m22:19:59.326493 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.orders_qw'
[0m22:19:59.327210 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: Close
[0m22:19:59.338142 [debug] [Thread-1 (]: Runtime Error in model orders_qw (models\marts\orders_qw.sql)
  Binder Error: Referenced column "Order.ID" not found in FROM clause!
  Candidate bindings: "stg_orders.order_id", "stg_orders.order_date", "stg_orders.order_priority", "stg_orders.market", "stg_orders.region"
  LINE 12:     "Order.ID" AS order_id,
               ^
[0m22:19:59.339004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82a45db-8d2b-43f7-9d3f-e08d1ec2d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011ABB132150>]}
[0m22:19:59.340082 [error] [Thread-1 (]: 13 of 13 ERROR creating sql table model main.orders_qw ......................... [[31mERROR[0m in 0.07s]
[0m22:19:59.341253 [debug] [Thread-1 (]: Finished running node model.assignment_4.orders_qw
[0m22:19:59.343571 [debug] [MainThread]: Using duckdb connection "master"
[0m22:19:59.344190 [debug] [MainThread]: On master: BEGIN
[0m22:19:59.344663 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:19:59.361246 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m22:19:59.361931 [debug] [MainThread]: On master: COMMIT
[0m22:19:59.362447 [debug] [MainThread]: Using duckdb connection "master"
[0m22:19:59.363047 [debug] [MainThread]: On master: COMMIT
[0m22:19:59.363952 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:19:59.364523 [debug] [MainThread]: On master: Close
[0m22:19:59.367952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:59.368598 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m22:19:59.369036 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m22:19:59.369465 [debug] [MainThread]: Connection 'model.assignment_4.orders_qw' was properly closed.
[0m22:19:59.370165 [info ] [MainThread]: 
[0m22:19:59.370770 [info ] [MainThread]: Finished running 5 seeds, 5 view models, 3 table models in 0 hours 0 minutes and 11.02 seconds (11.02s).
[0m22:19:59.375819 [debug] [MainThread]: Command end result
[0m22:19:59.436466 [info ] [MainThread]: 
[0m22:19:59.437471 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:19:59.438352 [info ] [MainThread]: 
[0m22:19:59.439288 [error] [MainThread]:   Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:19:59.440616 [info ] [MainThread]: 
[0m22:19:59.441626 [error] [MainThread]:   Runtime Error in model orders_qw (models\marts\orders_qw.sql)
  Binder Error: Referenced column "Order.ID" not found in FROM clause!
  Candidate bindings: "stg_orders.order_id", "stg_orders.order_date", "stg_orders.order_priority", "stg_orders.market", "stg_orders.region"
  LINE 12:     "Order.ID" AS order_id,
               ^
[0m22:19:59.442528 [info ] [MainThread]: 
[0m22:19:59.443461 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=2 SKIP=0 TOTAL=13
[0m22:19:59.446033 [debug] [MainThread]: Command `dbt build` failed at 22:19:59.445563 after 12.81 seconds
[0m22:19:59.447414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB8B29D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB730BD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011AB730BBF0>]}
[0m22:19:59.448318 [debug] [MainThread]: Flushing usage events
[0m22:20:56.084492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0755F6E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E078058550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E078058410>]}


============================== 22:20:56.093673 | a25fa255-4b31-4a8f-a3db-aca5857a1c54 ==============================
[0m22:20:56.093673 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:20:56.095048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select orders_qw', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:20:56.508592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a25fa255-4b31-4a8f-a3db-aca5857a1c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E079468510>]}
[0m22:20:56.604602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a25fa255-4b31-4a8f-a3db-aca5857a1c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E078003F00>]}
[0m22:20:56.611855 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:20:56.628467 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:20:56.880628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:20:56.881271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:20:56.948014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a25fa255-4b31-4a8f-a3db-aca5857a1c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07823C950>]}
[0m22:20:57.125368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a25fa255-4b31-4a8f-a3db-aca5857a1c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E079590AA0>]}
[0m22:20:57.126231 [info ] [MainThread]: Found 5 seeds, 8 models, 421 macros
[0m22:20:57.127050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a25fa255-4b31-4a8f-a3db-aca5857a1c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07829CE50>]}
[0m22:20:57.129720 [info ] [MainThread]: 
[0m22:20:57.131144 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:20:57.133243 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:20:57.293481 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:20:57.294166 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:20:57.294730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:57.316079 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m22:20:57.318637 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:20:57.323198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:20:57.324118 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:20:57.335401 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:20:57.336188 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:20:57.336717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:20:57.353496 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:20:57.355915 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:20:57.356549 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:20:57.357475 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:20:57.358000 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:20:57.358642 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:20:57.359760 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:20:57.361310 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:20:57.361842 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:20:57.362338 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:20:57.363194 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:20:57.363753 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:20:57.377288 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:20:57.387132 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:20:57.387777 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:20:57.388254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:57.404968 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:20:57.405622 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:20:57.406154 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:20:57.488388 [debug] [ThreadPool]: SQL status: OK in 0.082 seconds
[0m22:20:57.491037 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:20:57.499253 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:20:57.499888 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:20:57.509822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a25fa255-4b31-4a8f-a3db-aca5857a1c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0798372B0>]}
[0m22:20:57.510629 [debug] [MainThread]: Using duckdb connection "master"
[0m22:20:57.511136 [debug] [MainThread]: On master: BEGIN
[0m22:20:57.511605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:20:57.528798 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m22:20:57.529483 [debug] [MainThread]: On master: COMMIT
[0m22:20:57.529986 [debug] [MainThread]: Using duckdb connection "master"
[0m22:20:57.530469 [debug] [MainThread]: On master: COMMIT
[0m22:20:57.531245 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:20:57.531777 [debug] [MainThread]: On master: Close
[0m22:20:57.536458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:20:57.537519 [info ] [MainThread]: 
[0m22:20:57.543275 [debug] [Thread-1 (]: Began running node model.assignment_4.orders_qw
[0m22:20:57.544255 [info ] [Thread-1 (]: 1 of 1 START sql table model main.orders_qw .................................... [RUN]
[0m22:20:57.545511 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.orders_qw'
[0m22:20:57.546359 [debug] [Thread-1 (]: Began compiling node model.assignment_4.orders_qw
[0m22:20:57.559486 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.orders_qw"
[0m22:20:57.561204 [debug] [Thread-1 (]: Began executing node model.assignment_4.orders_qw
[0m22:20:57.628268 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.orders_qw"
[0m22:20:57.630325 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:20:57.631079 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: BEGIN
[0m22:20:57.631665 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:20:57.648511 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:20:57.649257 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:20:57.649908 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."orders_qw__dbt_tmp"
  
    as (
      SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."stg_orders"
ORDER BY order_date ASC
LIMIT 5
    );
  
  
[0m22:20:57.652345 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."orders_qw__dbt_tmp"
  
    as (
      SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."stg_orders"
ORDER BY order_date ASC
LIMIT 5
    );
  
  
[0m22:20:57.653077 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:20:57.653855 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: ROLLBACK
[0m22:20:57.666662 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.orders_qw'
[0m22:20:57.667407 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: Close
[0m22:20:57.678385 [debug] [Thread-1 (]: Runtime Error in model orders_qw (models\marts\orders_qw.sql)
  Binder Error: Referenced column "Order.ID" not found in FROM clause!
  Candidate bindings: "stg_orders.order_id", "stg_orders.order_date", "stg_orders.order_priority", "stg_orders.market", "stg_orders.region"
  LINE 12:     "Order.ID" AS order_id,
               ^
[0m22:20:57.680874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a25fa255-4b31-4a8f-a3db-aca5857a1c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E079895190>]}
[0m22:20:57.681979 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.orders_qw ........................... [[31mERROR[0m in 0.13s]
[0m22:20:57.683929 [debug] [Thread-1 (]: Finished running node model.assignment_4.orders_qw
[0m22:20:57.687296 [debug] [MainThread]: Using duckdb connection "master"
[0m22:20:57.687940 [debug] [MainThread]: On master: BEGIN
[0m22:20:57.688426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:20:57.705854 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m22:20:57.706553 [debug] [MainThread]: On master: COMMIT
[0m22:20:57.707058 [debug] [MainThread]: Using duckdb connection "master"
[0m22:20:57.707551 [debug] [MainThread]: On master: COMMIT
[0m22:20:57.708375 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:20:57.708918 [debug] [MainThread]: On master: Close
[0m22:20:57.712703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:20:57.713307 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m22:20:57.713757 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m22:20:57.714188 [debug] [MainThread]: Connection 'model.assignment_4.orders_qw' was properly closed.
[0m22:20:57.714791 [info ] [MainThread]: 
[0m22:20:57.715742 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m22:20:57.717361 [debug] [MainThread]: Command end result
[0m22:20:57.769619 [info ] [MainThread]: 
[0m22:20:57.771560 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:20:57.772758 [info ] [MainThread]: 
[0m22:20:57.774091 [error] [MainThread]:   Runtime Error in model orders_qw (models\marts\orders_qw.sql)
  Binder Error: Referenced column "Order.ID" not found in FROM clause!
  Candidate bindings: "stg_orders.order_id", "stg_orders.order_date", "stg_orders.order_priority", "stg_orders.market", "stg_orders.region"
  LINE 12:     "Order.ID" AS order_id,
               ^
[0m22:20:57.775273 [info ] [MainThread]: 
[0m22:20:57.776160 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:20:57.777994 [debug] [MainThread]: Command `dbt run` failed at 22:20:57.777729 after 1.91 seconds
[0m22:20:57.778663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E079699180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E079947F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E079946670>]}
[0m22:20:57.779276 [debug] [MainThread]: Flushing usage events
[0m22:22:31.140175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199081F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219904CF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219932607D0>]}


============================== 22:22:31.147141 | cc2d01e1-b44f-4e6c-a83f-dc292ad7e988 ==============================
[0m22:22:31.147141 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:22:31.148116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:22:31.572076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219935FC510>]}
[0m22:22:31.672039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021993237F00>]}
[0m22:22:31.679734 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:22:31.695017 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:22:31.953859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:22:31.954884 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\marts\orders_qw.sql
[0m22:22:32.359410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199346C750>]}
[0m22:22:32.540729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219931C3B60>]}
[0m22:22:32.541964 [info ] [MainThread]: Found 5 seeds, 8 models, 421 macros
[0m22:22:32.546578 [info ] [MainThread]: 
[0m22:22:32.547618 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:22:32.557506 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:22:32.721383 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:22:32.722082 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:22:32.722613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:32.743409 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m22:22:32.745757 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:22:32.751269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:22:32.752586 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:22:32.765085 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:22:32.765788 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:22:32.766312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:22:32.783295 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:22:32.785667 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:22:32.786253 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:22:32.787132 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:22:32.787672 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:22:32.788170 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:22:32.789104 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:22:32.790744 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:22:32.791288 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:22:32.791986 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:22:32.793028 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:22:32.793701 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:22:32.800992 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:22:32.811164 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:22:32.811837 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:22:32.812318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:32.828524 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m22:22:32.829194 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:22:32.829723 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:22:32.913593 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m22:22:32.916268 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:22:32.918819 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:22:32.919430 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:22:32.929138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021994AF3AF0>]}
[0m22:22:32.929955 [debug] [MainThread]: Using duckdb connection "master"
[0m22:22:32.930551 [debug] [MainThread]: On master: BEGIN
[0m22:22:32.931060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:22:32.948215 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m22:22:32.948911 [debug] [MainThread]: On master: COMMIT
[0m22:22:32.949419 [debug] [MainThread]: Using duckdb connection "master"
[0m22:22:32.949911 [debug] [MainThread]: On master: COMMIT
[0m22:22:32.950910 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:22:32.951688 [debug] [MainThread]: On master: Close
[0m22:22:32.955874 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:22:32.956674 [info ] [MainThread]: 
[0m22:22:32.962947 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m22:22:32.964374 [info ] [Thread-1 (]: 1 of 13 START seed file main.customers ......................................... [RUN]
[0m22:22:32.967501 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m22:22:32.968643 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m22:22:32.969795 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m22:22:33.395011 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:22:33.395776 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m22:22:33.396427 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:22:33.412645 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:22:33.413557 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:22:33.414228 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m22:22:33.417098 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:22:33.439468 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:22:33.440252 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:22:33.533404 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m22:22:33.543951 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m22:22:33.576078 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:22:33.576915 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:22:33.577528 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:22:33.657931 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m22:22:33.661221 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m22:22:33.752634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021994D132B0>]}
[0m22:22:33.753639 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file main.customers ..................................... [[32mINSERT 51290[0m in 0.78s]
[0m22:22:33.754803 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m22:22:33.755547 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m22:22:33.756548 [info ] [Thread-1 (]: 2 of 13 START seed file main.locations ......................................... [RUN]
[0m22:22:33.757608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m22:22:33.758297 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m22:22:33.758914 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m22:22:34.320960 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:22:34.321710 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m22:22:34.322287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:34.338444 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:22:34.339217 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:22:34.339834 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m22:22:34.341993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:34.344300 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:22:34.344971 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:22:34.464944 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m22:22:34.466234 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m22:22:34.470474 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:22:34.471668 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:22:34.472293 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:22:34.579700 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m22:22:34.581387 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m22:22:34.769758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219948013D0>]}
[0m22:22:34.770760 [info ] [Thread-1 (]: 2 of 13 OK loaded seed file main.locations ..................................... [[32mINSERT 51290[0m in 1.01s]
[0m22:22:34.772010 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m22:22:34.772766 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m22:22:34.773704 [info ] [Thread-1 (]: 3 of 13 START seed file main.orders ............................................ [RUN]
[0m22:22:34.774768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m22:22:34.775572 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m22:22:34.776250 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m22:22:38.726760 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:22:38.727504 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m22:22:38.728143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:38.746073 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:22:38.746818 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:22:38.747429 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m22:22:38.750081 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:22:38.752314 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:22:38.752972 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:22:39.196659 [debug] [Thread-1 (]: SQL status: OK in 0.443 seconds
[0m22:22:39.197884 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m22:22:39.201552 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:22:39.202495 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:22:39.203160 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:22:39.309656 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m22:22:39.311778 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m22:22:39.564349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021994A0DA70>]}
[0m22:22:39.565332 [info ] [Thread-1 (]: 3 of 13 OK loaded seed file main.orders ........................................ [[32mINSERT 51290[0m in 4.79s]
[0m22:22:39.566455 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m22:22:39.567234 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m22:22:39.568440 [info ] [Thread-1 (]: 4 of 13 START seed file main.products .......................................... [RUN]
[0m22:22:39.569643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m22:22:39.570334 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m22:22:39.570946 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m22:22:40.246988 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:22:40.247730 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m22:22:40.248307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:40.265366 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:22:40.266152 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:22:40.266786 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m22:22:40.269052 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:22:40.271362 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:22:40.272096 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:22:40.388894 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m22:22:40.390749 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m22:22:40.394828 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:22:40.395729 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:22:40.396566 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:22:40.495286 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m22:22:40.497328 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m22:22:40.678442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219935F0D70>]}
[0m22:22:40.679546 [info ] [Thread-1 (]: 4 of 13 OK loaded seed file main.products ...................................... [[32mINSERT 51290[0m in 1.11s]
[0m22:22:40.680736 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m22:22:40.681495 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m22:22:40.682660 [info ] [Thread-1 (]: 5 of 13 START seed file main.shipping .......................................... [RUN]
[0m22:22:40.683735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m22:22:40.684371 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m22:22:40.685062 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m22:22:41.849089 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:22:41.849837 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m22:22:41.850425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:41.869086 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m22:22:41.869842 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:22:41.870447 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m22:22:41.873348 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:22:41.875706 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:22:41.876389 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:22:42.183877 [debug] [Thread-1 (]: SQL status: OK in 0.307 seconds
[0m22:22:42.185083 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m22:22:42.189148 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:22:42.189902 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:22:42.190532 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:22:42.285848 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m22:22:42.287332 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m22:22:42.396400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199B1DD2D0>]}
[0m22:22:42.397394 [info ] [Thread-1 (]: 5 of 13 OK loaded seed file main.shipping ...................................... [[32mINSERT 51290[0m in 1.71s]
[0m22:22:42.398540 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m22:22:42.399264 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m22:22:42.400229 [info ] [Thread-1 (]: 6 of 13 START sql view model main.stg_customers ................................ [RUN]
[0m22:22:42.401059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m22:22:42.401725 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m22:22:42.414760 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m22:22:42.416442 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m22:22:42.474233 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m22:22:42.476028 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:22:42.476817 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m22:22:42.477446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:42.494131 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:22:42.494898 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:22:42.495523 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m22:22:42.496935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:42.509515 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:22:42.510275 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m22:22:42.511495 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:42.516129 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:22:42.516845 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:22:42.518199 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:42.525696 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:22:42.526444 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:22:42.527050 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:22:42.568868 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m22:22:42.577687 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:22:42.578468 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m22:22:42.582688 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:22:42.585450 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m22:22:42.607885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021994839940>]}
[0m22:22:42.609161 [info ] [Thread-1 (]: 6 of 13 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.21s]
[0m22:22:42.610699 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m22:22:42.611558 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_locations
[0m22:22:42.612864 [info ] [Thread-1 (]: 7 of 13 START sql view model main.stg_locations ................................ [RUN]
[0m22:22:42.614165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_locations)
[0m22:22:42.614966 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_locations
[0m22:22:42.621187 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_locations"
[0m22:22:42.623267 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_locations
[0m22:22:42.629183 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_locations"
[0m22:22:42.631067 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:22:42.631925 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: BEGIN
[0m22:22:42.632537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:42.650007 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:22:42.650780 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:22:42.651406 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */

  
  create view "assignment_4"."main"."stg_locations__dbt_tmp" as (
    SELECT
    DISTINCT
    TRIM("City") AS city,
    TRIM("State") AS state,
    TRIM("Region") AS region,
    TRIM("Country") AS country,
    "Order.ID" AS order_id
FROM "assignment_4"."main"."locations"
  );

[0m22:22:42.652796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:42.657975 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:22:42.658741 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations" rename to "stg_locations__dbt_backup"
[0m22:22:42.659943 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:42.665956 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:22:42.666848 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m22:22:42.668034 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:42.670803 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:22:42.671538 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:22:42.672132 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:22:42.677314 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:22:42.681446 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:22:42.682174 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
drop view if exists "assignment_4"."main"."stg_locations__dbt_backup" cascade
[0m22:22:42.686654 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:22:42.689488 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: Close
[0m22:22:42.711002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199702D550>]}
[0m22:22:42.712283 [info ] [Thread-1 (]: 7 of 13 OK created sql view model main.stg_locations ........................... [[32mOK[0m in 0.10s]
[0m22:22:42.713415 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_locations
[0m22:22:42.714127 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m22:22:42.715082 [info ] [Thread-1 (]: 8 of 13 START sql view model main.stg_orders ................................... [RUN]
[0m22:22:42.716171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_locations, now model.assignment_4.stg_orders)
[0m22:22:42.717106 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m22:22:42.721432 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m22:22:42.723277 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m22:22:42.729419 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m22:22:42.731311 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:22:42.732314 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m22:22:42.733285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:42.750285 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:22:42.751067 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:22:42.751724 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m22:22:42.753332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:42.758990 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:22:42.759917 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m22:22:42.761130 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:42.766451 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:22:42.767187 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:22:42.768380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:42.771044 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:22:42.771704 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:22:42.772298 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:22:42.777304 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:22:42.781031 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:22:42.781711 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m22:22:42.785799 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:22:42.788452 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m22:22:42.810196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021994F20710>]}
[0m22:22:42.811341 [info ] [Thread-1 (]: 8 of 13 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.09s]
[0m22:22:42.812572 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m22:22:42.813351 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m22:22:42.814330 [info ] [Thread-1 (]: 9 of 13 START sql view model main.stg_products ................................. [RUN]
[0m22:22:42.815465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m22:22:42.816273 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m22:22:42.821030 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m22:22:42.823144 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m22:22:42.832271 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m22:22:42.835008 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:22:42.836446 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m22:22:42.837497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:42.864175 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m22:22:42.864948 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:22:42.865596 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:22:42.867345 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:42.873229 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:22:42.874530 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m22:22:42.876447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:42.881610 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:22:42.882368 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m22:22:42.883797 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:42.887720 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:22:42.888736 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:22:42.889597 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:22:42.895074 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:22:42.899723 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:22:42.900627 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m22:22:42.904618 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:22:42.907712 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m22:22:42.927417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021994F20830>]}
[0m22:22:42.928563 [info ] [Thread-1 (]: 9 of 13 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.11s]
[0m22:22:42.929675 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m22:22:42.930422 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m22:22:42.931587 [info ] [Thread-1 (]: 10 of 13 START sql view model main.stg_shipping ................................ [RUN]
[0m22:22:42.932705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m22:22:42.933546 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m22:22:42.937729 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m22:22:42.939352 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m22:22:42.944832 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m22:22:42.946528 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:22:42.947545 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m22:22:42.948449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:42.965377 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:22:42.966153 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:22:42.966788 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:22:42.968056 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:42.973727 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:22:42.974475 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m22:22:42.975625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:42.980255 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:22:42.980966 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m22:22:42.982083 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:22:42.984669 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:22:42.985327 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:22:42.985918 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:22:42.991327 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:22:42.995727 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:22:42.996467 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m22:22:43.000292 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:22:43.003688 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m22:22:43.026011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021994F20950>]}
[0m22:22:43.027500 [info ] [Thread-1 (]: 10 of 13 OK created sql view model main.stg_shipping ........................... [[32mOK[0m in 0.09s]
[0m22:22:43.028760 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m22:22:43.029639 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m22:22:43.030814 [info ] [Thread-1 (]: 11 of 13 START sql table model main.the_most_popular_customer .................. [RUN]
[0m22:22:43.031934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_shipping, now model.assignment_4.the_most_popular_customer)
[0m22:22:43.032628 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m22:22:43.037788 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m22:22:43.039760 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m22:22:43.078838 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m22:22:43.080640 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:22:43.081410 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m22:22:43.081997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:43.101087 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m22:22:43.101869 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:22:43.102534 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC
LIMIT 1
    );
  
  
[0m22:22:43.153297 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m22:22:43.158694 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:22:43.159459 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer" rename to "the_most_popular_customer__dbt_backup"
[0m22:22:43.160817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:43.165526 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:22:43.166238 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer__dbt_tmp" rename to "the_most_popular_customer"
[0m22:22:43.167495 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:43.176848 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:22:43.177631 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:22:43.178257 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:22:43.219668 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m22:22:43.223776 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:22:43.224495 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
drop table if exists "assignment_4"."main"."the_most_popular_customer__dbt_backup" cascade
[0m22:22:43.228720 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:22:43.232276 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m22:22:43.256692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199A073890>]}
[0m22:22:43.258030 [info ] [Thread-1 (]: 11 of 13 OK created sql table model main.the_most_popular_customer ............. [[32mOK[0m in 0.22s]
[0m22:22:43.259451 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m22:22:43.260201 [debug] [Thread-1 (]: Began running node model.assignment_4.locations_qw
[0m22:22:43.261176 [info ] [Thread-1 (]: 12 of 13 START sql table model main.locations_qw ............................... [RUN]
[0m22:22:43.262072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.the_most_popular_customer, now model.assignment_4.locations_qw)
[0m22:22:43.262736 [debug] [Thread-1 (]: Began compiling node model.assignment_4.locations_qw
[0m22:22:43.267384 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.locations_qw"
[0m22:22:43.269076 [debug] [Thread-1 (]: Began executing node model.assignment_4.locations_qw
[0m22:22:43.274412 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.locations_qw"
[0m22:22:43.276254 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:22:43.276998 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: BEGIN
[0m22:22:43.277577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:43.293859 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:22:43.294607 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:22:43.295257 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:22:43.297515 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:22:43.298390 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:22:43.299175 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: ROLLBACK
[0m22:22:43.312114 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.locations_qw'
[0m22:22:43.312975 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: Close
[0m22:22:43.323814 [debug] [Thread-1 (]: Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:22:43.324770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199B3FE690>]}
[0m22:22:43.325843 [error] [Thread-1 (]: 12 of 13 ERROR creating sql table model main.locations_qw ...................... [[31mERROR[0m in 0.06s]
[0m22:22:43.327099 [debug] [Thread-1 (]: Finished running node model.assignment_4.locations_qw
[0m22:22:43.327862 [debug] [Thread-1 (]: Began running node model.assignment_4.orders_qw
[0m22:22:43.329494 [info ] [Thread-1 (]: 13 of 13 START sql table model main.orders_qw .................................. [RUN]
[0m22:22:43.330446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.locations_qw, now model.assignment_4.orders_qw)
[0m22:22:43.331121 [debug] [Thread-1 (]: Began compiling node model.assignment_4.orders_qw
[0m22:22:43.342866 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.orders_qw"
[0m22:22:43.344679 [debug] [Thread-1 (]: Began executing node model.assignment_4.orders_qw
[0m22:22:43.350091 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.orders_qw"
[0m22:22:43.351869 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:22:43.352646 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: BEGIN
[0m22:22:43.353262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:43.370327 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:22:43.371091 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:22:43.371757 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."orders_qw__dbt_tmp"
  
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    order_priority,
    quantity,
    discount,
    sales,
    profit,
    market,
    region,
    weeknum,
    year
FROM "assignment_4"."main"."stg_orders"
ORDER BY order_date ASC
LIMIT 5
    );
  
  
[0m22:22:43.399425 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m22:22:43.404162 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:22:43.404854 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
alter table "assignment_4"."main"."orders_qw__dbt_tmp" rename to "orders_qw"
[0m22:22:43.406126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:22:43.408801 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: COMMIT
[0m22:22:43.409494 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:22:43.410076 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: COMMIT
[0m22:22:43.415707 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:22:43.420261 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:22:43.420969 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
drop table if exists "assignment_4"."main"."orders_qw__dbt_backup" cascade
[0m22:22:43.422079 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:22:43.424542 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: Close
[0m22:22:43.454158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2d01e1-b44f-4e6c-a83f-dc292ad7e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199702E1B0>]}
[0m22:22:43.455326 [info ] [Thread-1 (]: 13 of 13 OK created sql table model main.orders_qw ............................. [[32mOK[0m in 0.12s]
[0m22:22:43.456528 [debug] [Thread-1 (]: Finished running node model.assignment_4.orders_qw
[0m22:22:43.458724 [debug] [MainThread]: Using duckdb connection "master"
[0m22:22:43.459340 [debug] [MainThread]: On master: BEGIN
[0m22:22:43.459807 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:22:43.478280 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m22:22:43.479177 [debug] [MainThread]: On master: COMMIT
[0m22:22:43.479860 [debug] [MainThread]: Using duckdb connection "master"
[0m22:22:43.480414 [debug] [MainThread]: On master: COMMIT
[0m22:22:43.481384 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:22:43.482114 [debug] [MainThread]: On master: Close
[0m22:22:43.486934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:43.487765 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m22:22:43.488452 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m22:22:43.488953 [debug] [MainThread]: Connection 'model.assignment_4.orders_qw' was properly closed.
[0m22:22:43.489781 [info ] [MainThread]: 
[0m22:22:43.490673 [info ] [MainThread]: Finished running 5 seeds, 5 view models, 3 table models in 0 hours 0 minutes and 10.94 seconds (10.94s).
[0m22:22:43.497045 [debug] [MainThread]: Command end result
[0m22:22:43.554606 [info ] [MainThread]: 
[0m22:22:43.555422 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:22:43.555988 [info ] [MainThread]: 
[0m22:22:43.556728 [error] [MainThread]:   Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:22:43.557524 [info ] [MainThread]: 
[0m22:22:43.558129 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m22:22:43.559747 [debug] [MainThread]: Command `dbt build` failed at 22:22:43.559497 after 12.73 seconds
[0m22:22:43.560396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021994E17710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219921433B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199B007B30>]}
[0m22:22:43.561000 [debug] [MainThread]: Flushing usage events
[0m22:22:54.284906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186A7FF0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186A4AF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186D2407D0>]}


============================== 22:22:54.291346 | 912ed837-b431-4e91-bac8-a1522f84d9f2 ==============================
[0m22:22:54.291346 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:22:54.292331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:22:54.682694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186D5D8510>]}
[0m22:22:54.781531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186D217F00>]}
[0m22:22:54.789310 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:22:54.805031 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:22:55.053232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:22:55.053897 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:22:55.122674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186D44C950>]}
[0m22:22:55.314167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186D1A3B60>]}
[0m22:22:55.315116 [info ] [MainThread]: Found 5 seeds, 8 models, 421 macros
[0m22:22:55.319490 [info ] [MainThread]: 
[0m22:22:55.320511 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:22:55.330444 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:22:55.500026 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:22:55.500770 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:22:55.501322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:55.522836 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m22:22:55.525218 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:22:55.530115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:22:55.531058 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:22:55.542573 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:22:55.543254 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:22:55.543774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:22:55.561423 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m22:22:55.563754 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:22:55.564335 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:22:55.565164 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:22:55.565686 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:22:55.566172 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:22:55.567098 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:22:55.568622 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:22:55.569146 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:22:55.569642 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:22:55.570498 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:22:55.571040 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:22:55.578255 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:22:55.587784 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:22:55.588444 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:22:55.588940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:55.605385 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m22:22:55.606049 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:22:55.606588 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:22:55.682346 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m22:22:55.685037 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:22:55.687726 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:22:55.688347 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:22:55.697889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186E8B2190>]}
[0m22:22:55.698732 [debug] [MainThread]: Using duckdb connection "master"
[0m22:22:55.699253 [debug] [MainThread]: On master: BEGIN
[0m22:22:55.699721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:22:55.719382 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m22:22:55.720036 [debug] [MainThread]: On master: COMMIT
[0m22:22:55.720541 [debug] [MainThread]: Using duckdb connection "master"
[0m22:22:55.721016 [debug] [MainThread]: On master: COMMIT
[0m22:22:55.721905 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:22:55.722442 [debug] [MainThread]: On master: Close
[0m22:22:55.726544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:22:55.727263 [info ] [MainThread]: 
[0m22:22:55.772518 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m22:22:55.773703 [info ] [Thread-1 (]: 1 of 13 START seed file main.customers ......................................... [RUN]
[0m22:22:55.774689 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m22:22:55.775313 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m22:22:55.775988 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m22:22:56.229445 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:22:56.230247 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m22:22:56.230862 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:22:56.248139 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:22:56.248911 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:22:56.249533 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m22:22:56.251842 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:22:56.274907 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:22:56.275686 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:22:56.355757 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m22:22:56.368220 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m22:22:56.399407 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:22:56.400255 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:22:56.401015 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:22:56.447324 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m22:22:56.450553 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m22:22:56.570980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186ECF9980>]}
[0m22:22:56.572087 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file main.customers ..................................... [[32mINSERT 51290[0m in 0.79s]
[0m22:22:56.573588 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m22:22:56.574764 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m22:22:56.576122 [info ] [Thread-1 (]: 2 of 13 START seed file main.locations ......................................... [RUN]
[0m22:22:56.577357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m22:22:56.578020 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m22:22:56.578633 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m22:22:57.149456 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:22:57.150201 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m22:22:57.150784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:57.167908 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:22:57.169050 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:22:57.169926 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m22:22:57.172357 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:22:57.174703 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:22:57.175387 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:22:57.304072 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m22:22:57.305447 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m22:22:57.310710 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:22:57.311489 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:22:57.312130 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:22:57.421034 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m22:22:57.423697 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m22:22:57.665147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186E9B9310>]}
[0m22:22:57.666342 [info ] [Thread-1 (]: 2 of 13 OK loaded seed file main.locations ..................................... [[32mINSERT 51290[0m in 1.09s]
[0m22:22:57.667500 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m22:22:57.668220 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m22:22:57.669205 [info ] [Thread-1 (]: 3 of 13 START seed file main.orders ............................................ [RUN]
[0m22:22:57.670298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m22:22:57.671368 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m22:22:57.672088 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m22:23:01.557840 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:23:01.558588 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m22:23:01.559165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:01.576145 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:23:01.576922 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:23:01.577539 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m22:23:01.579928 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:23:01.582164 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:23:01.582836 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:23:02.012908 [debug] [Thread-1 (]: SQL status: OK in 0.429 seconds
[0m22:23:02.014115 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m22:23:02.018053 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:23:02.018795 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:23:02.019383 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:23:02.153982 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m22:23:02.155481 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m22:23:02.481070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186E888F70>]}
[0m22:23:02.482057 [info ] [Thread-1 (]: 3 of 13 OK loaded seed file main.orders ........................................ [[32mINSERT 51290[0m in 4.81s]
[0m22:23:02.483167 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m22:23:02.484006 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m22:23:02.485087 [info ] [Thread-1 (]: 4 of 13 START seed file main.products .......................................... [RUN]
[0m22:23:02.486132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m22:23:02.486829 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m22:23:02.487433 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m22:23:03.152546 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:23:03.153288 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m22:23:03.153872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:03.170236 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:23:03.171303 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:23:03.172163 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m22:23:03.174477 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:23:03.176762 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:23:03.177443 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:23:03.284760 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m22:23:03.285970 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m22:23:03.290903 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:23:03.291791 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:23:03.292415 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:23:03.386160 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m22:23:03.387824 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m22:23:03.598609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186D353930>]}
[0m22:23:03.599615 [info ] [Thread-1 (]: 4 of 13 OK loaded seed file main.products ...................................... [[32mINSERT 51290[0m in 1.11s]
[0m22:23:03.600725 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m22:23:03.601430 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m22:23:03.602389 [info ] [Thread-1 (]: 5 of 13 START seed file main.shipping .......................................... [RUN]
[0m22:23:03.603413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m22:23:03.604118 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m22:23:03.604737 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m22:23:04.690458 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:23:04.691215 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m22:23:04.691843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:04.708433 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:23:04.709186 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:23:04.709789 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m22:23:04.711894 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:04.714674 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:23:04.715384 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:23:05.024456 [debug] [Thread-1 (]: SQL status: OK in 0.308 seconds
[0m22:23:05.025676 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m22:23:05.029927 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:23:05.030660 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:23:05.031253 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:23:05.112388 [debug] [Thread-1 (]: SQL status: OK in 0.080 seconds
[0m22:23:05.113862 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m22:23:05.289954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021875BF95D0>]}
[0m22:23:05.290940 [info ] [Thread-1 (]: 5 of 13 OK loaded seed file main.shipping ...................................... [[32mINSERT 51290[0m in 1.69s]
[0m22:23:05.292100 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m22:23:05.292850 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m22:23:05.293784 [info ] [Thread-1 (]: 6 of 13 START sql view model main.stg_customers ................................ [RUN]
[0m22:23:05.294689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m22:23:05.295366 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m22:23:05.309230 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m22:23:05.311084 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m22:23:05.367471 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m22:23:05.369412 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:23:05.370252 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m22:23:05.370875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:05.388414 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:23:05.389519 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:23:05.390273 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m22:23:05.391857 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.403858 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:23:05.404683 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m22:23:05.406045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.410818 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:23:05.411575 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:23:05.412795 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.419448 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:23:05.420223 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:23:05.420842 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:23:05.463265 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m22:23:05.472307 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:23:05.473049 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m22:23:05.477962 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:23:05.480677 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m22:23:05.503710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186C0F0A60>]}
[0m22:23:05.505480 [info ] [Thread-1 (]: 6 of 13 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.21s]
[0m22:23:05.507087 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m22:23:05.508304 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_locations
[0m22:23:05.509623 [info ] [Thread-1 (]: 7 of 13 START sql view model main.stg_locations ................................ [RUN]
[0m22:23:05.510858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_locations)
[0m22:23:05.511735 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_locations
[0m22:23:05.516740 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_locations"
[0m22:23:05.518518 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_locations
[0m22:23:05.524550 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_locations"
[0m22:23:05.526469 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:23:05.527211 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: BEGIN
[0m22:23:05.527785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:05.545086 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:23:05.545869 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:23:05.546534 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */

  
  create view "assignment_4"."main"."stg_locations__dbt_tmp" as (
    SELECT
    DISTINCT
    TRIM("City") AS city,
    TRIM("State") AS state,
    TRIM("Region") AS region,
    TRIM("Country") AS country,
    "Order.ID" AS order_id
FROM "assignment_4"."main"."locations"
  );

[0m22:23:05.547969 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.552765 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:23:05.553475 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations" rename to "stg_locations__dbt_backup"
[0m22:23:05.554763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.560763 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:23:05.561630 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m22:23:05.562832 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.566039 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:23:05.567070 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:23:05.567744 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:23:05.573549 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:23:05.577542 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:23:05.578235 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
drop view if exists "assignment_4"."main"."stg_locations__dbt_backup" cascade
[0m22:23:05.582330 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:23:05.584851 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: Close
[0m22:23:05.606521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186ED7C5F0>]}
[0m22:23:05.607675 [info ] [Thread-1 (]: 7 of 13 OK created sql view model main.stg_locations ........................... [[32mOK[0m in 0.10s]
[0m22:23:05.608797 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_locations
[0m22:23:05.609539 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m22:23:05.610480 [info ] [Thread-1 (]: 8 of 13 START sql view model main.stg_orders ................................... [RUN]
[0m22:23:05.611547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_locations, now model.assignment_4.stg_orders)
[0m22:23:05.612448 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m22:23:05.616602 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m22:23:05.618405 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m22:23:05.624577 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m22:23:05.626498 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:23:05.627257 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m22:23:05.627844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:05.644493 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:23:05.645239 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:23:05.645877 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m22:23:05.647378 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.652600 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:23:05.653336 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m22:23:05.654553 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.659764 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:23:05.660483 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:23:05.661667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.664434 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:23:05.665200 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:23:05.665909 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:23:05.671264 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:23:05.675111 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:23:05.675801 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m22:23:05.679997 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:23:05.682621 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m22:23:05.704743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021873F67C50>]}
[0m22:23:05.705891 [info ] [Thread-1 (]: 8 of 13 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.09s]
[0m22:23:05.707135 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m22:23:05.708109 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m22:23:05.709206 [info ] [Thread-1 (]: 9 of 13 START sql view model main.stg_products ................................. [RUN]
[0m22:23:05.710545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m22:23:05.711490 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m22:23:05.716331 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m22:23:05.718348 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m22:23:05.732363 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m22:23:05.734736 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:23:05.735628 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m22:23:05.736330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:05.756110 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m22:23:05.756866 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:23:05.757492 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:23:05.758933 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.764097 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:23:05.764893 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m22:23:05.766123 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.770845 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:23:05.771702 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m22:23:05.773156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.775967 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:23:05.776677 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:23:05.777266 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:23:05.782162 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:23:05.787152 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:23:05.788025 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m22:23:05.792120 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:23:05.794721 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m22:23:05.816875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186ED7C590>]}
[0m22:23:05.818013 [info ] [Thread-1 (]: 9 of 13 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.11s]
[0m22:23:05.819129 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m22:23:05.819837 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m22:23:05.820777 [info ] [Thread-1 (]: 10 of 13 START sql view model main.stg_shipping ................................ [RUN]
[0m22:23:05.821653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m22:23:05.822474 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m22:23:05.826608 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m22:23:05.828406 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m22:23:05.834427 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m22:23:05.836294 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:23:05.837333 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m22:23:05.838230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:05.854722 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:23:05.855494 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:23:05.856138 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:23:05.857495 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.863073 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:23:05.863805 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m22:23:05.865088 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.869741 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:23:05.870595 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m22:23:05.871846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:05.874458 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:23:05.875151 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:23:05.875760 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:23:05.881380 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:23:05.885327 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:23:05.886064 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m22:23:05.890038 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:23:05.893008 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m22:23:05.913937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021873F67D10>]}
[0m22:23:05.915087 [info ] [Thread-1 (]: 10 of 13 OK created sql view model main.stg_shipping ........................... [[32mOK[0m in 0.09s]
[0m22:23:05.917725 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m22:23:05.919859 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m22:23:05.921217 [info ] [Thread-1 (]: 11 of 13 START sql table model main.the_most_popular_customer .................. [RUN]
[0m22:23:05.922212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_shipping, now model.assignment_4.the_most_popular_customer)
[0m22:23:05.923220 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m22:23:05.930314 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m22:23:05.932370 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m22:23:05.972357 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m22:23:05.974287 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:23:05.975052 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m22:23:05.975636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:05.992893 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:23:05.993636 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:23:05.994286 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC
LIMIT 1
    );
  
  
[0m22:23:06.043207 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m22:23:06.048531 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:23:06.049286 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer" rename to "the_most_popular_customer__dbt_backup"
[0m22:23:06.050545 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:06.055270 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:23:06.055984 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer__dbt_tmp" rename to "the_most_popular_customer"
[0m22:23:06.057153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:06.066222 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:23:06.066961 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:23:06.067558 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:23:06.108854 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m22:23:06.113010 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:23:06.113716 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
drop table if exists "assignment_4"."main"."the_most_popular_customer__dbt_backup" cascade
[0m22:23:06.117675 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:23:06.120785 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m22:23:06.145461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021873F67950>]}
[0m22:23:06.146620 [info ] [Thread-1 (]: 11 of 13 OK created sql table model main.the_most_popular_customer ............. [[32mOK[0m in 0.22s]
[0m22:23:06.147743 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m22:23:06.148456 [debug] [Thread-1 (]: Began running node model.assignment_4.locations_qw
[0m22:23:06.149540 [info ] [Thread-1 (]: 12 of 13 START sql table model main.locations_qw ............................... [RUN]
[0m22:23:06.150701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.the_most_popular_customer, now model.assignment_4.locations_qw)
[0m22:23:06.151544 [debug] [Thread-1 (]: Began compiling node model.assignment_4.locations_qw
[0m22:23:06.157365 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.locations_qw"
[0m22:23:06.159010 [debug] [Thread-1 (]: Began executing node model.assignment_4.locations_qw
[0m22:23:06.164278 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.locations_qw"
[0m22:23:06.165986 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:23:06.166716 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: BEGIN
[0m22:23:06.167293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:06.183918 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:23:06.184660 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:23:06.185306 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:23:06.187441 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:23:06.188213 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:23:06.188977 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: ROLLBACK
[0m22:23:06.201637 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.locations_qw'
[0m22:23:06.202446 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: Close
[0m22:23:06.212954 [debug] [Thread-1 (]: Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:23:06.213845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021874873DD0>]}
[0m22:23:06.214900 [error] [Thread-1 (]: 12 of 13 ERROR creating sql table model main.locations_qw ...................... [[31mERROR[0m in 0.06s]
[0m22:23:06.216180 [debug] [Thread-1 (]: Finished running node model.assignment_4.locations_qw
[0m22:23:06.216885 [debug] [Thread-1 (]: Began running node model.assignment_4.orders_qw
[0m22:23:06.218495 [info ] [Thread-1 (]: 13 of 13 START sql table model main.orders_qw .................................. [RUN]
[0m22:23:06.219613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.locations_qw, now model.assignment_4.orders_qw)
[0m22:23:06.220247 [debug] [Thread-1 (]: Began compiling node model.assignment_4.orders_qw
[0m22:23:06.224489 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.orders_qw"
[0m22:23:06.226120 [debug] [Thread-1 (]: Began executing node model.assignment_4.orders_qw
[0m22:23:06.232312 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.orders_qw"
[0m22:23:06.234098 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:23:06.234856 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: BEGIN
[0m22:23:06.235477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:06.251761 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:23:06.252511 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:23:06.253140 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."orders_qw__dbt_tmp"
  
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    order_priority,
    quantity,
    discount,
    sales,
    profit,
    market,
    region,
    weeknum,
    year
FROM "assignment_4"."main"."stg_orders"
ORDER BY order_date ASC
LIMIT 5
    );
  
  
[0m22:23:06.281020 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m22:23:06.285638 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:23:06.286337 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
alter table "assignment_4"."main"."orders_qw" rename to "orders_qw__dbt_backup"
[0m22:23:06.288033 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:06.293205 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:23:06.293923 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
alter table "assignment_4"."main"."orders_qw__dbt_tmp" rename to "orders_qw"
[0m22:23:06.295126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:23:06.297984 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: COMMIT
[0m22:23:06.298965 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:23:06.299670 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: COMMIT
[0m22:23:06.341023 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m22:23:06.345278 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:23:06.346082 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
drop table if exists "assignment_4"."main"."orders_qw__dbt_backup" cascade
[0m22:23:06.350521 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:23:06.354685 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: Close
[0m22:23:06.401572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912ed837-b431-4e91-bac8-a1522f84d9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186ED7C050>]}
[0m22:23:06.402879 [info ] [Thread-1 (]: 13 of 13 OK created sql table model main.orders_qw ............................. [[32mOK[0m in 0.18s]
[0m22:23:06.405492 [debug] [Thread-1 (]: Finished running node model.assignment_4.orders_qw
[0m22:23:06.407978 [debug] [MainThread]: Using duckdb connection "master"
[0m22:23:06.408627 [debug] [MainThread]: On master: BEGIN
[0m22:23:06.409170 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:23:06.427040 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m22:23:06.427745 [debug] [MainThread]: On master: COMMIT
[0m22:23:06.428262 [debug] [MainThread]: Using duckdb connection "master"
[0m22:23:06.428792 [debug] [MainThread]: On master: COMMIT
[0m22:23:06.429665 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:23:06.430236 [debug] [MainThread]: On master: Close
[0m22:23:06.433833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:06.434442 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m22:23:06.434900 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m22:23:06.435334 [debug] [MainThread]: Connection 'model.assignment_4.orders_qw' was properly closed.
[0m22:23:06.436022 [info ] [MainThread]: 
[0m22:23:06.436616 [info ] [MainThread]: Finished running 5 seeds, 5 view models, 3 table models in 0 hours 0 minutes and 11.12 seconds (11.12s).
[0m22:23:06.441817 [debug] [MainThread]: Command end result
[0m22:23:06.498732 [info ] [MainThread]: 
[0m22:23:06.499562 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:23:06.500140 [info ] [MainThread]: 
[0m22:23:06.501139 [error] [MainThread]:   Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:23:06.501928 [info ] [MainThread]: 
[0m22:23:06.502708 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m22:23:06.504512 [debug] [MainThread]: Command `dbt build` failed at 22:23:06.504181 after 12.40 seconds
[0m22:23:06.505449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186C16AAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186AD5A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186D495310>]}
[0m22:23:06.506342 [debug] [MainThread]: Flushing usage events
[0m22:24:19.551577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695B33EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695DDA8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695DDA8410>]}


============================== 22:24:19.557887 | 25cc135f-b4df-4032-8355-bbe095daba91 ==============================
[0m22:24:19.557887 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:24:19.559281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select orders_qw', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:24:19.949395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25cc135f-b4df-4032-8355-bbe095daba91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695F180510>]}
[0m22:24:20.045749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25cc135f-b4df-4032-8355-bbe095daba91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695DD57F00>]}
[0m22:24:20.052936 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:24:20.071515 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:24:20.327180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:24:20.327829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:24:20.393272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25cc135f-b4df-4032-8355-bbe095daba91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695DF8C950>]}
[0m22:24:20.559055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25cc135f-b4df-4032-8355-bbe095daba91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695F2C0AA0>]}
[0m22:24:20.560401 [info ] [MainThread]: Found 5 seeds, 8 models, 421 macros
[0m22:24:20.561311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25cc135f-b4df-4032-8355-bbe095daba91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695DFECE50>]}
[0m22:24:20.564024 [info ] [MainThread]: 
[0m22:24:20.565326 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:24:20.566945 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:24:20.730811 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:24:20.731499 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:24:20.732133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:20.752796 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m22:24:20.755125 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:24:20.760112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:24:20.761032 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:24:20.772316 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:24:20.772989 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:24:20.773493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:20.790950 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:24:20.793295 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:24:20.793876 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:24:20.794726 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:24:20.795250 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:24:20.795755 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:24:20.796662 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:24:20.798186 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:24:20.798734 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:24:20.799220 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:24:20.800042 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:24:20.800597 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:24:20.814264 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:24:20.823697 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:24:20.824340 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:24:20.824830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:20.841428 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m22:24:20.842092 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:24:20.842661 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:24:20.914323 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m22:24:20.953972 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:24:20.956522 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:24:20.957130 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:24:20.966411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25cc135f-b4df-4032-8355-bbe095daba91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695F5632B0>]}
[0m22:24:20.967215 [debug] [MainThread]: Using duckdb connection "master"
[0m22:24:20.967838 [debug] [MainThread]: On master: BEGIN
[0m22:24:20.968317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:20.985365 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m22:24:20.986035 [debug] [MainThread]: On master: COMMIT
[0m22:24:20.986533 [debug] [MainThread]: Using duckdb connection "master"
[0m22:24:20.987015 [debug] [MainThread]: On master: COMMIT
[0m22:24:20.987804 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:24:20.988345 [debug] [MainThread]: On master: Close
[0m22:24:20.992644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:24:20.993724 [info ] [MainThread]: 
[0m22:24:20.999617 [debug] [Thread-1 (]: Began running node model.assignment_4.orders_qw
[0m22:24:21.000677 [info ] [Thread-1 (]: 1 of 1 START sql table model main.orders_qw .................................... [RUN]
[0m22:24:21.001978 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.orders_qw'
[0m22:24:21.002900 [debug] [Thread-1 (]: Began compiling node model.assignment_4.orders_qw
[0m22:24:21.017916 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.orders_qw"
[0m22:24:21.019713 [debug] [Thread-1 (]: Began executing node model.assignment_4.orders_qw
[0m22:24:21.100831 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.orders_qw"
[0m22:24:21.102913 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:24:21.103959 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: BEGIN
[0m22:24:21.104638 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:24:21.121729 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:24:21.122532 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:24:21.123213 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."orders_qw__dbt_tmp"
  
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    order_priority,
    quantity,
    discount,
    sales,
    profit,
    market,
    region,
    weeknum,
    year
FROM "assignment_4"."main"."stg_orders"
ORDER BY order_date ASC
LIMIT 5
    );
  
  
[0m22:24:21.157073 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m22:24:21.169296 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:24:21.170118 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
alter table "assignment_4"."main"."orders_qw" rename to "orders_qw__dbt_backup"
[0m22:24:21.171478 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:24:21.176787 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:24:21.177606 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
alter table "assignment_4"."main"."orders_qw__dbt_tmp" rename to "orders_qw"
[0m22:24:21.179179 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:24:21.224524 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: COMMIT
[0m22:24:21.225337 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:24:21.225991 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: COMMIT
[0m22:24:21.268626 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m22:24:21.278896 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:24:21.279696 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
drop table if exists "assignment_4"."main"."orders_qw__dbt_backup" cascade
[0m22:24:21.284252 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:24:21.288673 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: Close
[0m22:24:21.321487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25cc135f-b4df-4032-8355-bbe095daba91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695F5C1550>]}
[0m22:24:21.322879 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.orders_qw ............................... [[32mOK[0m in 0.32s]
[0m22:24:21.324440 [debug] [Thread-1 (]: Finished running node model.assignment_4.orders_qw
[0m22:24:21.326524 [debug] [MainThread]: Using duckdb connection "master"
[0m22:24:21.327167 [debug] [MainThread]: On master: BEGIN
[0m22:24:21.327683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:24:21.347188 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m22:24:21.347888 [debug] [MainThread]: On master: COMMIT
[0m22:24:21.348420 [debug] [MainThread]: Using duckdb connection "master"
[0m22:24:21.348942 [debug] [MainThread]: On master: COMMIT
[0m22:24:21.349778 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:24:21.350347 [debug] [MainThread]: On master: Close
[0m22:24:21.354489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:21.355137 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m22:24:21.355614 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m22:24:21.356076 [debug] [MainThread]: Connection 'model.assignment_4.orders_qw' was properly closed.
[0m22:24:21.356727 [info ] [MainThread]: 
[0m22:24:21.357592 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m22:24:21.359151 [debug] [MainThread]: Command end result
[0m22:24:21.416302 [info ] [MainThread]: 
[0m22:24:21.417581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:24:21.418828 [info ] [MainThread]: 
[0m22:24:21.419968 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:24:21.421913 [debug] [MainThread]: Command `dbt run` succeeded at 22:24:21.421640 after 2.16 seconds
[0m22:24:21.422588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695F3CF330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695F773A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695F773B10>]}
[0m22:24:21.423215 [debug] [MainThread]: Flushing usage events
[0m22:32:14.309835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCAC33F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCABFEF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCAED807D0>]}


============================== 22:32:14.316427 | b47a077c-049a-49ca-8f44-c88e7e8be00a ==============================
[0m22:32:14.316427 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:32:14.317448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:32:14.710139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB0118510>]}
[0m22:32:14.808881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCAED5BF00>]}
[0m22:32:14.816228 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:32:14.832034 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:32:15.084000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:32:15.084924 [debug] [MainThread]: Partial parsing: added file: assignment_4://models\marts\products_qw.sql
[0m22:32:15.482535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCAEF8C750>]}
[0m22:32:15.667940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCAECE3B60>]}
[0m22:32:15.668834 [info ] [MainThread]: Found 5 seeds, 9 models, 421 macros
[0m22:32:15.673504 [info ] [MainThread]: 
[0m22:32:15.674597 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:32:15.684572 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:32:15.849809 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:32:15.850515 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:32:15.851042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:15.871471 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m22:32:15.873810 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:32:15.879037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:32:15.879943 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:32:15.891811 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:32:15.892512 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:32:15.893024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:32:15.910301 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:32:15.912669 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:32:15.913259 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:32:15.914189 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:32:15.914720 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:32:15.915326 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:32:15.916519 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:32:15.918071 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:32:15.918652 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:32:15.919168 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:32:15.920027 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:32:15.920578 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:32:15.927488 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:32:15.937051 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:32:15.937748 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:32:15.938241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:15.955123 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:32:15.955798 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:32:15.956330 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:32:16.026625 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m22:32:16.029400 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:32:16.032101 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:32:16.032784 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:32:16.042800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB05A7BD0>]}
[0m22:32:16.043630 [debug] [MainThread]: Using duckdb connection "master"
[0m22:32:16.044146 [debug] [MainThread]: On master: BEGIN
[0m22:32:16.044624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:32:16.061473 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m22:32:16.062146 [debug] [MainThread]: On master: COMMIT
[0m22:32:16.062654 [debug] [MainThread]: Using duckdb connection "master"
[0m22:32:16.063131 [debug] [MainThread]: On master: COMMIT
[0m22:32:16.063933 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:32:16.064504 [debug] [MainThread]: On master: Close
[0m22:32:16.068463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:32:16.069215 [info ] [MainThread]: 
[0m22:32:16.073998 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m22:32:16.076098 [info ] [Thread-1 (]: 1 of 14 START seed file main.customers ......................................... [RUN]
[0m22:32:16.077092 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m22:32:16.077723 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m22:32:16.078328 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m22:32:16.504896 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:32:16.505642 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m22:32:16.506222 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:32:16.523704 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:32:16.524559 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:32:16.525195 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m22:32:16.527639 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:32:16.549832 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:32:16.550650 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:32:16.644472 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m22:32:16.654852 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m22:32:16.683885 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:32:16.684652 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:32:16.685245 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:32:16.764985 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m22:32:16.768177 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m22:32:16.860936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB07E72B0>]}
[0m22:32:16.861951 [info ] [Thread-1 (]: 1 of 14 OK loaded seed file main.customers ..................................... [[32mINSERT 51290[0m in 0.78s]
[0m22:32:16.863188 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m22:32:16.863936 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m22:32:16.864936 [info ] [Thread-1 (]: 2 of 14 START seed file main.locations ......................................... [RUN]
[0m22:32:16.865925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m22:32:16.866607 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m22:32:16.867229 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m22:32:17.437882 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:32:17.438626 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m22:32:17.439360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:17.457029 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:32:17.457776 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:32:17.458383 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m22:32:17.461227 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:32:17.463491 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:32:17.464396 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:32:17.588909 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m22:32:17.590148 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m22:32:17.594271 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:32:17.595036 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:32:17.595703 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:32:17.699929 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m22:32:17.701526 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m22:32:17.886663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB02C93D0>]}
[0m22:32:17.887715 [info ] [Thread-1 (]: 2 of 14 OK loaded seed file main.locations ..................................... [[32mINSERT 51290[0m in 1.02s]
[0m22:32:17.888861 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m22:32:17.889569 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m22:32:17.890573 [info ] [Thread-1 (]: 3 of 14 START seed file main.orders ............................................ [RUN]
[0m22:32:17.891759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m22:32:17.892494 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m22:32:17.893138 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m22:32:21.807039 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:32:21.807794 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m22:32:21.808377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:21.824757 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:32:21.825705 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:32:21.826600 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m22:32:21.829322 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:32:21.831603 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:32:21.832276 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:32:22.273830 [debug] [Thread-1 (]: SQL status: OK in 0.441 seconds
[0m22:32:22.275045 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m22:32:22.278505 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:32:22.279249 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:32:22.279891 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:32:22.421851 [debug] [Thread-1 (]: SQL status: OK in 0.141 seconds
[0m22:32:22.423780 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m22:32:22.674635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB04E5230>]}
[0m22:32:22.675614 [info ] [Thread-1 (]: 3 of 14 OK loaded seed file main.orders ........................................ [[32mINSERT 51290[0m in 4.78s]
[0m22:32:22.676863 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m22:32:22.677569 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m22:32:22.678562 [info ] [Thread-1 (]: 4 of 14 START seed file main.products .......................................... [RUN]
[0m22:32:22.679676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m22:32:22.680405 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m22:32:22.681009 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m22:32:23.328726 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:32:23.329466 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m22:32:23.330162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:23.347349 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:32:23.348290 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:32:23.348893 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m22:32:23.351362 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:32:23.353611 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:32:23.354268 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:32:23.456469 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m22:32:23.457683 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m22:32:23.461303 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:32:23.462048 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:32:23.462657 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:32:23.557082 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m22:32:23.558810 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m22:32:23.690621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB00E5630>]}
[0m22:32:23.691605 [info ] [Thread-1 (]: 4 of 14 OK loaded seed file main.products ...................................... [[32mINSERT 51290[0m in 1.01s]
[0m22:32:23.692733 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m22:32:23.693459 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m22:32:23.694480 [info ] [Thread-1 (]: 5 of 14 START seed file main.shipping .......................................... [RUN]
[0m22:32:23.695470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m22:32:23.696107 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m22:32:23.696708 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m22:32:24.834698 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:32:24.835677 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m22:32:24.836342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:24.853584 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:32:24.854340 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:32:24.855024 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m22:32:24.857479 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:32:24.860389 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:32:24.861063 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:32:25.209943 [debug] [Thread-1 (]: SQL status: OK in 0.348 seconds
[0m22:32:25.211162 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m22:32:25.214827 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:32:25.215623 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:32:25.216218 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:32:25.306045 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m22:32:25.307492 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m22:32:25.419823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB6C01AD0>]}
[0m22:32:25.420864 [info ] [Thread-1 (]: 5 of 14 OK loaded seed file main.shipping ...................................... [[32mINSERT 51290[0m in 1.72s]
[0m22:32:25.421989 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m22:32:25.422704 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m22:32:25.423659 [info ] [Thread-1 (]: 6 of 14 START sql view model main.stg_customers ................................ [RUN]
[0m22:32:25.424515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m22:32:25.425133 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m22:32:25.438680 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m22:32:25.440525 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m22:32:25.497876 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m22:32:25.499683 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:32:25.500485 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m22:32:25.501094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:25.518519 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:32:25.519327 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:32:25.519961 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m22:32:25.521411 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:25.533803 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:32:25.534662 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m22:32:25.535939 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:25.540599 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:32:25.541372 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:32:25.542570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:25.549234 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:32:25.550016 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:32:25.550614 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:32:25.593631 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m22:32:25.602475 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:32:25.603306 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m22:32:25.607795 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:32:25.610368 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m22:32:25.632711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB030BF50>]}
[0m22:32:25.634174 [info ] [Thread-1 (]: 6 of 14 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.21s]
[0m22:32:25.635500 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m22:32:25.636646 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_locations
[0m22:32:25.637996 [info ] [Thread-1 (]: 7 of 14 START sql view model main.stg_locations ................................ [RUN]
[0m22:32:25.639262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_locations)
[0m22:32:25.640154 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_locations
[0m22:32:25.645841 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_locations"
[0m22:32:25.647859 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_locations
[0m22:32:25.653501 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_locations"
[0m22:32:25.655247 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:32:25.655999 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: BEGIN
[0m22:32:25.656587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:25.673970 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:32:25.674718 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:32:25.675340 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */

  
  create view "assignment_4"."main"."stg_locations__dbt_tmp" as (
    SELECT
    DISTINCT
    TRIM("City") AS city,
    TRIM("State") AS state,
    TRIM("Region") AS region,
    TRIM("Country") AS country,
    "Order.ID" AS order_id
FROM "assignment_4"."main"."locations"
  );

[0m22:32:25.676791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:25.681770 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:32:25.682563 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations" rename to "stg_locations__dbt_backup"
[0m22:32:25.683735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:25.689078 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:32:25.689813 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m22:32:25.690986 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:25.693689 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:32:25.694386 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:32:25.694977 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:32:25.700443 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:32:25.704655 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:32:25.705345 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
drop view if exists "assignment_4"."main"."stg_locations__dbt_backup" cascade
[0m22:32:25.709737 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:32:25.712385 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: Close
[0m22:32:25.737205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB2B36150>]}
[0m22:32:25.738344 [info ] [Thread-1 (]: 7 of 14 OK created sql view model main.stg_locations ........................... [[32mOK[0m in 0.10s]
[0m22:32:25.739452 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_locations
[0m22:32:25.740146 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m22:32:25.741226 [info ] [Thread-1 (]: 8 of 14 START sql view model main.stg_orders ................................... [RUN]
[0m22:32:25.742462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_locations, now model.assignment_4.stg_orders)
[0m22:32:25.743194 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m22:32:25.747497 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m22:32:25.749534 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m22:32:25.755716 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m22:32:25.757540 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:32:25.758291 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m22:32:25.758871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:25.776797 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:32:25.777552 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:32:25.778189 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m22:32:25.779699 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:25.784685 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:32:25.785401 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m22:32:25.786594 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:25.791935 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:32:25.792675 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:32:25.793843 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:25.796476 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:32:25.797272 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:32:25.797871 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:32:25.803750 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:32:25.808000 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:32:25.808730 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m22:32:25.813017 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:32:25.815716 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m22:32:25.836653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB09F8A10>]}
[0m22:32:25.837879 [info ] [Thread-1 (]: 8 of 14 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.09s]
[0m22:32:25.839344 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m22:32:25.840449 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m22:32:25.841626 [info ] [Thread-1 (]: 9 of 14 START sql view model main.stg_products ................................. [RUN]
[0m22:32:25.842859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m22:32:25.843735 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m22:32:25.848354 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m22:32:25.850691 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m22:32:25.858836 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m22:32:25.861126 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:32:25.862250 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m22:32:25.863260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:25.883656 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m22:32:25.884518 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:32:25.885146 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:32:25.886681 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:25.891712 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:32:25.892450 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m22:32:25.893673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:25.899123 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:32:25.899902 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m22:32:25.901107 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:25.903814 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:32:25.904534 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:32:25.905118 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:32:25.910114 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:32:25.915000 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:32:25.915760 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m22:32:25.919744 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:32:25.922239 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m22:32:25.943718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB09F8B30>]}
[0m22:32:25.944861 [info ] [Thread-1 (]: 9 of 14 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.10s]
[0m22:32:25.945985 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m22:32:25.946793 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m22:32:25.947928 [info ] [Thread-1 (]: 10 of 14 START sql view model main.stg_shipping ................................ [RUN]
[0m22:32:25.948924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m22:32:25.949600 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m22:32:25.953733 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m22:32:25.955569 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m22:32:25.961387 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m22:32:25.963246 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:32:25.964271 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m22:32:25.965139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:25.982420 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:32:25.983203 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:32:25.983831 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:32:25.985178 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:25.990793 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:32:25.991542 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m22:32:25.992745 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:25.997399 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:32:25.998108 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m22:32:25.999324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:26.001966 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:32:26.002631 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:32:26.003225 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:32:26.008334 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:32:26.012499 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:32:26.013216 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m22:32:26.017677 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:32:26.021071 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m22:32:26.042347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB09F8C50>]}
[0m22:32:26.043546 [info ] [Thread-1 (]: 10 of 14 OK created sql view model main.stg_shipping ........................... [[32mOK[0m in 0.09s]
[0m22:32:26.045151 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m22:32:26.046293 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m22:32:26.047601 [info ] [Thread-1 (]: 11 of 14 START sql table model main.the_most_popular_customer .................. [RUN]
[0m22:32:26.048625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_shipping, now model.assignment_4.the_most_popular_customer)
[0m22:32:26.049580 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m22:32:26.054983 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m22:32:26.057395 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m22:32:26.102577 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m22:32:26.104669 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:32:26.105667 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m22:32:26.106459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:26.124474 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:32:26.125402 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:32:26.126156 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC
LIMIT 1
    );
  
  
[0m22:32:26.174936 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m22:32:26.180410 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:32:26.181168 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer" rename to "the_most_popular_customer__dbt_backup"
[0m22:32:26.182500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:26.187124 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:32:26.187884 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer__dbt_tmp" rename to "the_most_popular_customer"
[0m22:32:26.189126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:26.198138 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:32:26.198865 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:32:26.199497 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:32:26.241994 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m22:32:26.245751 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:32:26.246443 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
drop table if exists "assignment_4"."main"."the_most_popular_customer__dbt_backup" cascade
[0m22:32:26.250434 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:32:26.254380 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m22:32:26.282891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB09F86B0>]}
[0m22:32:26.284686 [info ] [Thread-1 (]: 11 of 14 OK created sql table model main.the_most_popular_customer ............. [[32mOK[0m in 0.23s]
[0m22:32:26.286117 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m22:32:26.286949 [debug] [Thread-1 (]: Began running node model.assignment_4.locations_qw
[0m22:32:26.287926 [info ] [Thread-1 (]: 12 of 14 START sql table model main.locations_qw ............................... [RUN]
[0m22:32:26.288922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.the_most_popular_customer, now model.assignment_4.locations_qw)
[0m22:32:26.289633 [debug] [Thread-1 (]: Began compiling node model.assignment_4.locations_qw
[0m22:32:26.294457 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.locations_qw"
[0m22:32:26.296298 [debug] [Thread-1 (]: Began executing node model.assignment_4.locations_qw
[0m22:32:26.302709 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.locations_qw"
[0m22:32:26.304752 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:32:26.305757 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: BEGIN
[0m22:32:26.306384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:26.324566 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:32:26.325457 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:32:26.326197 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:32:26.328551 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:32:26.329383 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:32:26.330229 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: ROLLBACK
[0m22:32:26.343565 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.locations_qw'
[0m22:32:26.344340 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: Close
[0m22:32:26.355194 [debug] [Thread-1 (]: Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:32:26.356125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB6E2AAB0>]}
[0m22:32:26.357127 [error] [Thread-1 (]: 12 of 14 ERROR creating sql table model main.locations_qw ...................... [[31mERROR[0m in 0.07s]
[0m22:32:26.358303 [debug] [Thread-1 (]: Finished running node model.assignment_4.locations_qw
[0m22:32:26.359005 [debug] [Thread-1 (]: Began running node model.assignment_4.orders_qw
[0m22:32:26.360725 [info ] [Thread-1 (]: 13 of 14 START sql table model main.orders_qw .................................. [RUN]
[0m22:32:26.361897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.locations_qw, now model.assignment_4.orders_qw)
[0m22:32:26.362840 [debug] [Thread-1 (]: Began compiling node model.assignment_4.orders_qw
[0m22:32:26.373233 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.orders_qw"
[0m22:32:26.374865 [debug] [Thread-1 (]: Began executing node model.assignment_4.orders_qw
[0m22:32:26.380112 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.orders_qw"
[0m22:32:26.381972 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:32:26.382829 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: BEGIN
[0m22:32:26.383419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:26.400936 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:32:26.401676 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:32:26.402305 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."orders_qw__dbt_tmp"
  
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    order_priority,
    quantity,
    discount,
    sales,
    profit,
    market,
    region,
    weeknum,
    year
FROM "assignment_4"."main"."stg_orders"
ORDER BY order_date ASC
LIMIT 5
    );
  
  
[0m22:32:26.427151 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m22:32:26.431932 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:32:26.432674 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
alter table "assignment_4"."main"."orders_qw" rename to "orders_qw__dbt_backup"
[0m22:32:26.433944 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:26.439300 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:32:26.440032 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
alter table "assignment_4"."main"."orders_qw__dbt_tmp" rename to "orders_qw"
[0m22:32:26.441244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:32:26.444750 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: COMMIT
[0m22:32:26.445474 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:32:26.446067 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: COMMIT
[0m22:32:26.470275 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m22:32:26.474135 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:32:26.474855 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
drop table if exists "assignment_4"."main"."orders_qw__dbt_backup" cascade
[0m22:32:26.480444 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:32:26.483205 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: Close
[0m22:32:26.522258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB09F8650>]}
[0m22:32:26.523907 [info ] [Thread-1 (]: 13 of 14 OK created sql table model main.orders_qw ............................. [[32mOK[0m in 0.16s]
[0m22:32:26.526133 [debug] [Thread-1 (]: Finished running node model.assignment_4.orders_qw
[0m22:32:26.527124 [debug] [Thread-1 (]: Began running node model.assignment_4.products_qw
[0m22:32:26.528134 [info ] [Thread-1 (]: 14 of 14 START sql table model main.products_qw ................................ [RUN]
[0m22:32:26.529033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.orders_qw, now model.assignment_4.products_qw)
[0m22:32:26.529676 [debug] [Thread-1 (]: Began compiling node model.assignment_4.products_qw
[0m22:32:26.535235 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.products_qw"
[0m22:32:26.537067 [debug] [Thread-1 (]: Began executing node model.assignment_4.products_qw
[0m22:32:26.543585 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.products_qw"
[0m22:32:26.545515 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:32:26.546530 [debug] [Thread-1 (]: On model.assignment_4.products_qw: BEGIN
[0m22:32:26.547641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:26.564926 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:32:26.565674 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:32:26.566296 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."products_qw__dbt_tmp"
  
    as (
      SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    TRIM("Category") AS category,
    TRIM("Sub.Category") AS sub_category
FROM "assignment_4"."main"."stg_products"
WHERE TRIM("Category") = 'Office Supplies'
    );
  
  
[0m22:32:26.568076 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."products_qw__dbt_tmp"
  
    as (
      SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    TRIM("Category") AS category,
    TRIM("Sub.Category") AS sub_category
FROM "assignment_4"."main"."stg_products"
WHERE TRIM("Category") = 'Office Supplies'
    );
  
  
[0m22:32:26.568767 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:32:26.569587 [debug] [Thread-1 (]: On model.assignment_4.products_qw: ROLLBACK
[0m22:32:26.578102 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.products_qw'
[0m22:32:26.578814 [debug] [Thread-1 (]: On model.assignment_4.products_qw: Close
[0m22:32:26.590070 [debug] [Thread-1 (]: Runtime Error in model products_qw (models\marts\products_qw.sql)
  Binder Error: Referenced column "Product.ID" not found in FROM clause!
  Candidate bindings: "stg_products.product_id", "stg_products.product_name", "stg_products.sub_category"
  LINE 12:     "Product.ID" AS product_id,
               ^
[0m22:32:26.590917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47a077c-049a-49ca-8f44-c88e7e8be00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB09F8650>]}
[0m22:32:26.591908 [error] [Thread-1 (]: 14 of 14 ERROR creating sql table model main.products_qw ....................... [[31mERROR[0m in 0.06s]
[0m22:32:26.593017 [debug] [Thread-1 (]: Finished running node model.assignment_4.products_qw
[0m22:32:26.595368 [debug] [MainThread]: Using duckdb connection "master"
[0m22:32:26.596009 [debug] [MainThread]: On master: BEGIN
[0m22:32:26.596583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:32:26.612686 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m22:32:26.613357 [debug] [MainThread]: On master: COMMIT
[0m22:32:26.613871 [debug] [MainThread]: Using duckdb connection "master"
[0m22:32:26.614361 [debug] [MainThread]: On master: COMMIT
[0m22:32:26.615257 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:32:26.615908 [debug] [MainThread]: On master: Close
[0m22:32:26.619492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:32:26.620101 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m22:32:26.620547 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m22:32:26.620968 [debug] [MainThread]: Connection 'model.assignment_4.products_qw' was properly closed.
[0m22:32:26.621647 [info ] [MainThread]: 
[0m22:32:26.622237 [info ] [MainThread]: Finished running 5 seeds, 5 view models, 4 table models in 0 hours 0 minutes and 10.95 seconds (10.95s).
[0m22:32:26.627739 [debug] [MainThread]: Command end result
[0m22:32:26.683257 [info ] [MainThread]: 
[0m22:32:26.684119 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:32:26.684683 [info ] [MainThread]: 
[0m22:32:26.685421 [error] [MainThread]:   Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:32:26.686096 [info ] [MainThread]: 
[0m22:32:26.686766 [error] [MainThread]:   Runtime Error in model products_qw (models\marts\products_qw.sql)
  Binder Error: Referenced column "Product.ID" not found in FROM clause!
  Candidate bindings: "stg_products.product_id", "stg_products.product_name", "stg_products.sub_category"
  LINE 12:     "Product.ID" AS product_id,
               ^
[0m22:32:26.687379 [info ] [MainThread]: 
[0m22:32:26.687942 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=2 SKIP=0 TOTAL=14
[0m22:32:26.689559 [debug] [MainThread]: Command `dbt build` failed at 22:32:26.689323 after 12.68 seconds
[0m22:32:26.690245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB032CE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCAB326CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB6B07CB0>]}
[0m22:32:26.690875 [debug] [MainThread]: Flushing usage events
[0m22:34:01.417964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1C99F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1C64F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1F3E07D0>]}


============================== 22:34:01.424423 | 6523e9e7-3821-4a5c-b2b1-c74ec344d807 ==============================
[0m22:34:01.424423 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:34:01.425407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:34:01.820055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE207B8510>]}
[0m22:34:01.917691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1F3B7F00>]}
[0m22:34:01.925253 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:34:01.940761 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:34:02.195715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:34:02.196864 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\marts\products_qw.sql
[0m22:34:02.598169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1F5ECE50>]}
[0m22:34:02.782545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1F343B60>]}
[0m22:34:02.783392 [info ] [MainThread]: Found 5 seeds, 9 models, 421 macros
[0m22:34:02.788008 [info ] [MainThread]: 
[0m22:34:02.789031 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:34:02.799441 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:34:02.967728 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:34:02.968520 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:34:02.969092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:02.993728 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m22:34:02.996038 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:34:03.000617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:34:03.001749 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:34:03.013336 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:34:03.014110 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:34:03.014644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:03.031974 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:34:03.034435 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:34:03.035065 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:34:03.035963 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:34:03.036495 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:34:03.036987 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:34:03.037885 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:34:03.039508 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:34:03.040094 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:34:03.040586 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:34:03.041468 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:34:03.042029 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:34:03.049543 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:34:03.059464 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:34:03.060108 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:34:03.060595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:03.077424 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:34:03.078081 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:34:03.078873 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:34:03.152795 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m22:34:03.155690 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:34:03.158446 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:34:03.159108 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:34:03.168743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE20C4BBD0>]}
[0m22:34:03.169537 [debug] [MainThread]: Using duckdb connection "master"
[0m22:34:03.170074 [debug] [MainThread]: On master: BEGIN
[0m22:34:03.170543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:34:03.186746 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m22:34:03.187417 [debug] [MainThread]: On master: COMMIT
[0m22:34:03.187926 [debug] [MainThread]: Using duckdb connection "master"
[0m22:34:03.188407 [debug] [MainThread]: On master: COMMIT
[0m22:34:03.189195 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:34:03.189909 [debug] [MainThread]: On master: Close
[0m22:34:03.195635 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:34:03.196372 [info ] [MainThread]: 
[0m22:34:03.201135 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m22:34:03.203248 [info ] [Thread-1 (]: 1 of 14 START seed file main.customers ......................................... [RUN]
[0m22:34:03.204245 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m22:34:03.204881 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m22:34:03.205494 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m22:34:03.621012 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:34:03.621771 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m22:34:03.622366 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:34:03.639828 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:34:03.640599 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:34:03.641206 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m22:34:03.643444 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:34:03.665414 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:34:03.666193 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:34:03.743589 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m22:34:03.754311 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m22:34:03.783328 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:34:03.784090 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:34:03.784734 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:34:03.864567 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m22:34:03.868832 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m22:34:03.977209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE20E832B0>]}
[0m22:34:03.978189 [info ] [Thread-1 (]: 1 of 14 OK loaded seed file main.customers ..................................... [[32mINSERT 51290[0m in 0.77s]
[0m22:34:03.979785 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m22:34:03.980869 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m22:34:03.982154 [info ] [Thread-1 (]: 2 of 14 START seed file main.locations ......................................... [RUN]
[0m22:34:03.983362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m22:34:03.984054 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m22:34:03.984712 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m22:34:04.542795 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:34:04.543556 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m22:34:04.544137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:04.561095 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:34:04.561865 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:34:04.562535 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m22:34:04.565114 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:34:04.567464 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:34:04.568150 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:34:04.685534 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m22:34:04.686783 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m22:34:04.690906 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:34:04.691657 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:34:04.692253 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:34:04.794384 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m22:34:04.796127 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m22:34:05.021442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE209450D0>]}
[0m22:34:05.022498 [info ] [Thread-1 (]: 2 of 14 OK loaded seed file main.locations ..................................... [[32mINSERT 51290[0m in 1.04s]
[0m22:34:05.023656 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m22:34:05.024363 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m22:34:05.025352 [info ] [Thread-1 (]: 3 of 14 START seed file main.orders ............................................ [RUN]
[0m22:34:05.026445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m22:34:05.027398 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m22:34:05.028163 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m22:34:08.959863 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:34:08.960663 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m22:34:08.961472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:08.979267 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:34:08.980021 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:34:08.980612 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m22:34:08.983294 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:34:08.985589 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:34:08.986394 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:34:09.434319 [debug] [Thread-1 (]: SQL status: OK in 0.447 seconds
[0m22:34:09.435525 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m22:34:09.439751 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:34:09.440598 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:34:09.441242 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:34:09.576555 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m22:34:09.578018 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m22:34:09.893877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE20B85230>]}
[0m22:34:09.894923 [info ] [Thread-1 (]: 3 of 14 OK loaded seed file main.orders ........................................ [[32mINSERT 51290[0m in 4.87s]
[0m22:34:09.896031 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m22:34:09.896727 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m22:34:09.897687 [info ] [Thread-1 (]: 4 of 14 START seed file main.products .......................................... [RUN]
[0m22:34:09.899034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m22:34:09.899963 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m22:34:09.900696 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m22:34:10.570854 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:34:10.571600 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m22:34:10.572176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:10.589309 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:34:10.590066 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:34:10.590669 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m22:34:10.592822 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:34:10.595123 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:34:10.595801 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:34:10.709541 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m22:34:10.710814 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m22:34:10.714400 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:34:10.715132 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:34:10.715846 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:34:10.809990 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m22:34:10.811452 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m22:34:11.012942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE20785630>]}
[0m22:34:11.013918 [info ] [Thread-1 (]: 4 of 14 OK loaded seed file main.products ...................................... [[32mINSERT 51290[0m in 1.11s]
[0m22:34:11.015224 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m22:34:11.016034 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m22:34:11.017194 [info ] [Thread-1 (]: 5 of 14 START seed file main.shipping .......................................... [RUN]
[0m22:34:11.018416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m22:34:11.019210 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m22:34:11.019904 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m22:34:12.164999 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:34:12.165932 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m22:34:12.166681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:12.184758 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:34:12.185568 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:34:12.186191 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m22:34:12.188703 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:34:12.191750 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:34:12.192694 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:34:12.519988 [debug] [Thread-1 (]: SQL status: OK in 0.326 seconds
[0m22:34:12.521241 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m22:34:12.524810 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:34:12.525594 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:34:12.526239 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:34:12.612470 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m22:34:12.613925 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m22:34:12.770549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE27255AD0>]}
[0m22:34:12.771543 [info ] [Thread-1 (]: 5 of 14 OK loaded seed file main.shipping ...................................... [[32mINSERT 51290[0m in 1.75s]
[0m22:34:12.772655 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m22:34:12.773563 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m22:34:12.774518 [info ] [Thread-1 (]: 6 of 14 START sql view model main.stg_customers ................................ [RUN]
[0m22:34:12.775380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m22:34:12.776055 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m22:34:12.789781 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m22:34:12.791696 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m22:34:12.853492 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m22:34:12.855466 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:34:12.856228 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m22:34:12.856804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:12.875063 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:34:12.876110 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:34:12.876822 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m22:34:12.878323 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:12.889995 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:34:12.890833 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m22:34:12.892169 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:12.897416 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:34:12.898155 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:34:12.899353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:12.906189 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:34:12.906916 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:34:12.907507 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:34:12.950235 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m22:34:12.960182 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:34:12.961059 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m22:34:12.965186 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:34:12.967672 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m22:34:12.993241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE20CF8130>]}
[0m22:34:12.994415 [info ] [Thread-1 (]: 6 of 14 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.22s]
[0m22:34:12.995550 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m22:34:12.996262 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_locations
[0m22:34:12.997232 [info ] [Thread-1 (]: 7 of 14 START sql view model main.stg_locations ................................ [RUN]
[0m22:34:12.998370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_locations)
[0m22:34:12.999044 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_locations
[0m22:34:13.004722 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_locations"
[0m22:34:13.006611 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_locations
[0m22:34:13.012070 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_locations"
[0m22:34:13.013818 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:34:13.014580 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: BEGIN
[0m22:34:13.015153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:13.032450 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:34:13.033409 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:34:13.034121 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */

  
  create view "assignment_4"."main"."stg_locations__dbt_tmp" as (
    SELECT
    DISTINCT
    TRIM("City") AS city,
    TRIM("State") AS state,
    TRIM("Region") AS region,
    TRIM("Country") AS country,
    "Order.ID" AS order_id
FROM "assignment_4"."main"."locations"
  );

[0m22:34:13.035618 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.041212 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:34:13.041988 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations" rename to "stg_locations__dbt_backup"
[0m22:34:13.043200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.048532 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:34:13.049256 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m22:34:13.050483 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.053084 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:34:13.053740 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:34:13.054323 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:34:13.059571 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:34:13.063823 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:34:13.064519 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
drop view if exists "assignment_4"."main"."stg_locations__dbt_backup" cascade
[0m22:34:13.068303 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:34:13.071045 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: Close
[0m22:34:13.098378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2089DDF0>]}
[0m22:34:13.099552 [info ] [Thread-1 (]: 7 of 14 OK created sql view model main.stg_locations ........................... [[32mOK[0m in 0.10s]
[0m22:34:13.100691 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_locations
[0m22:34:13.101406 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m22:34:13.102362 [info ] [Thread-1 (]: 8 of 14 START sql view model main.stg_orders ................................... [RUN]
[0m22:34:13.103447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_locations, now model.assignment_4.stg_orders)
[0m22:34:13.104195 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m22:34:13.108414 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m22:34:13.110124 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m22:34:13.116113 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m22:34:13.117909 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:34:13.118754 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m22:34:13.119410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:13.136461 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:34:13.137206 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:34:13.137851 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m22:34:13.139325 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.144089 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:34:13.144794 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m22:34:13.146019 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.151355 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:34:13.152078 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:34:13.153217 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.155793 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:34:13.156445 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:34:13.157027 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:34:13.162728 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:34:13.166839 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:34:13.167653 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m22:34:13.171673 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:34:13.174159 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m22:34:13.194717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE21098830>]}
[0m22:34:13.195883 [info ] [Thread-1 (]: 8 of 14 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.09s]
[0m22:34:13.197219 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m22:34:13.198281 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m22:34:13.200009 [info ] [Thread-1 (]: 9 of 14 START sql view model main.stg_products ................................. [RUN]
[0m22:34:13.201423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m22:34:13.202190 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m22:34:13.206816 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m22:34:13.208551 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m22:34:13.217135 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m22:34:13.219156 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:34:13.220020 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m22:34:13.220773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:13.238603 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:34:13.239384 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:34:13.240022 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:34:13.241387 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.246494 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:34:13.247489 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m22:34:13.248887 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.254221 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:34:13.254988 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m22:34:13.256124 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:34:13.258711 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:34:13.259359 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:34:13.259960 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:34:13.265605 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:34:13.270486 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:34:13.271232 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m22:34:13.275484 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:34:13.278311 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m22:34:13.300220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE21098950>]}
[0m22:34:13.301362 [info ] [Thread-1 (]: 9 of 14 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.10s]
[0m22:34:13.302536 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m22:34:13.303274 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m22:34:13.304234 [info ] [Thread-1 (]: 10 of 14 START sql view model main.stg_shipping ................................ [RUN]
[0m22:34:13.305261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m22:34:13.305946 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m22:34:13.310307 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m22:34:13.311956 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m22:34:13.317424 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m22:34:13.319141 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:34:13.319900 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m22:34:13.320528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:13.337873 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:34:13.338641 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:34:13.339602 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:34:13.341087 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.346709 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:34:13.347554 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m22:34:13.348846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.353750 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:34:13.354485 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m22:34:13.355886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.358525 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:34:13.359190 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:34:13.359771 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:34:13.365244 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:34:13.369481 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:34:13.370219 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m22:34:13.374218 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:34:13.377480 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m22:34:13.398916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE21098A70>]}
[0m22:34:13.400193 [info ] [Thread-1 (]: 10 of 14 OK created sql view model main.stg_shipping ........................... [[32mOK[0m in 0.09s]
[0m22:34:13.401792 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m22:34:13.402799 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m22:34:13.403930 [info ] [Thread-1 (]: 11 of 14 START sql table model main.the_most_popular_customer .................. [RUN]
[0m22:34:13.404972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_shipping, now model.assignment_4.the_most_popular_customer)
[0m22:34:13.405769 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m22:34:13.411915 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m22:34:13.414158 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m22:34:13.457272 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m22:34:13.459170 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:34:13.460014 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m22:34:13.460646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:13.478297 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:34:13.479068 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:34:13.479722 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC
LIMIT 1
    );
  
  
[0m22:34:13.530941 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m22:34:13.536459 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:34:13.537230 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer" rename to "the_most_popular_customer__dbt_backup"
[0m22:34:13.538567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.543272 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:34:13.543965 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer__dbt_tmp" rename to "the_most_popular_customer"
[0m22:34:13.545234 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.554501 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:34:13.555258 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:34:13.555857 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:34:13.598772 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m22:34:13.603044 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:34:13.603869 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
drop table if exists "assignment_4"."main"."the_most_popular_customer__dbt_backup" cascade
[0m22:34:13.608084 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:34:13.611926 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m22:34:13.638063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2311A3F0>]}
[0m22:34:13.639262 [info ] [Thread-1 (]: 11 of 14 OK created sql table model main.the_most_popular_customer ............. [[32mOK[0m in 0.23s]
[0m22:34:13.640525 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m22:34:13.641249 [debug] [Thread-1 (]: Began running node model.assignment_4.locations_qw
[0m22:34:13.642173 [info ] [Thread-1 (]: 12 of 14 START sql table model main.locations_qw ............................... [RUN]
[0m22:34:13.643073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.the_most_popular_customer, now model.assignment_4.locations_qw)
[0m22:34:13.643736 [debug] [Thread-1 (]: Began compiling node model.assignment_4.locations_qw
[0m22:34:13.648403 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.locations_qw"
[0m22:34:13.650268 [debug] [Thread-1 (]: Began executing node model.assignment_4.locations_qw
[0m22:34:13.655838 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.locations_qw"
[0m22:34:13.657625 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:34:13.658354 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: BEGIN
[0m22:34:13.658915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:13.676216 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:34:13.676950 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:34:13.677592 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:34:13.679923 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:34:13.680683 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:34:13.681469 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: ROLLBACK
[0m22:34:13.694281 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.locations_qw'
[0m22:34:13.695006 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: Close
[0m22:34:13.706322 [debug] [Thread-1 (]: Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:34:13.707224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2747E870>]}
[0m22:34:13.708223 [error] [Thread-1 (]: 12 of 14 ERROR creating sql table model main.locations_qw ...................... [[31mERROR[0m in 0.06s]
[0m22:34:13.709378 [debug] [Thread-1 (]: Finished running node model.assignment_4.locations_qw
[0m22:34:13.710074 [debug] [Thread-1 (]: Began running node model.assignment_4.orders_qw
[0m22:34:13.711544 [info ] [Thread-1 (]: 13 of 14 START sql table model main.orders_qw .................................. [RUN]
[0m22:34:13.712361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.locations_qw, now model.assignment_4.orders_qw)
[0m22:34:13.712983 [debug] [Thread-1 (]: Began compiling node model.assignment_4.orders_qw
[0m22:34:13.722871 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.orders_qw"
[0m22:34:13.724552 [debug] [Thread-1 (]: Began executing node model.assignment_4.orders_qw
[0m22:34:13.729731 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.orders_qw"
[0m22:34:13.731482 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:34:13.732221 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: BEGIN
[0m22:34:13.732801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:13.749472 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:34:13.750220 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:34:13.750840 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."orders_qw__dbt_tmp"
  
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    order_priority,
    quantity,
    discount,
    sales,
    profit,
    market,
    region,
    weeknum,
    year
FROM "assignment_4"."main"."stg_orders"
ORDER BY order_date ASC
LIMIT 5
    );
  
  
[0m22:34:13.776423 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m22:34:13.781062 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:34:13.781779 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
alter table "assignment_4"."main"."orders_qw" rename to "orders_qw__dbt_backup"
[0m22:34:13.783486 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.788957 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:34:13.789729 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
alter table "assignment_4"."main"."orders_qw__dbt_tmp" rename to "orders_qw"
[0m22:34:13.790990 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:13.793792 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: COMMIT
[0m22:34:13.794434 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:34:13.795027 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: COMMIT
[0m22:34:13.838071 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m22:34:13.841842 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:34:13.842558 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
drop table if exists "assignment_4"."main"."orders_qw__dbt_backup" cascade
[0m22:34:13.848102 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:34:13.852863 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: Close
[0m22:34:13.896929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE20750350>]}
[0m22:34:13.898278 [info ] [Thread-1 (]: 13 of 14 OK created sql table model main.orders_qw ............................. [[32mOK[0m in 0.18s]
[0m22:34:13.899707 [debug] [Thread-1 (]: Finished running node model.assignment_4.orders_qw
[0m22:34:13.900942 [debug] [Thread-1 (]: Began running node model.assignment_4.products_qw
[0m22:34:13.902164 [info ] [Thread-1 (]: 14 of 14 START sql table model main.products_qw ................................ [RUN]
[0m22:34:13.903018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.orders_qw, now model.assignment_4.products_qw)
[0m22:34:13.903635 [debug] [Thread-1 (]: Began compiling node model.assignment_4.products_qw
[0m22:34:13.907860 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.products_qw"
[0m22:34:13.909731 [debug] [Thread-1 (]: Began executing node model.assignment_4.products_qw
[0m22:34:13.915736 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.products_qw"
[0m22:34:13.917796 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:34:13.918559 [debug] [Thread-1 (]: On model.assignment_4.products_qw: BEGIN
[0m22:34:13.919141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:13.935862 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:34:13.936609 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:34:13.937231 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."products_qw__dbt_tmp"
  
    as (
      SELECT
    "product_id" AS product_id,
    "product_name" AS product_name,
    "category" AS category,
    "sub_category" AS sub_category
FROM "assignment_4"."main"."stg_products"
WHERE "category" = 'Office Supplies'
    );
  
  
[0m22:34:13.994608 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m22:34:13.999424 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:34:14.000182 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */
alter table "assignment_4"."main"."products_qw__dbt_tmp" rename to "products_qw"
[0m22:34:14.001425 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:34:14.004162 [debug] [Thread-1 (]: On model.assignment_4.products_qw: COMMIT
[0m22:34:14.005121 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:34:14.006049 [debug] [Thread-1 (]: On model.assignment_4.products_qw: COMMIT
[0m22:34:14.036573 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m22:34:14.041231 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:34:14.041960 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */
drop table if exists "assignment_4"."main"."products_qw__dbt_backup" cascade
[0m22:34:14.043058 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:34:14.045447 [debug] [Thread-1 (]: On model.assignment_4.products_qw: Close
[0m22:34:14.127208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6523e9e7-3821-4a5c-b2b1-c74ec344d807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE20750350>]}
[0m22:34:14.128950 [info ] [Thread-1 (]: 14 of 14 OK created sql table model main.products_qw ........................... [[32mOK[0m in 0.22s]
[0m22:34:14.130644 [debug] [Thread-1 (]: Finished running node model.assignment_4.products_qw
[0m22:34:14.132729 [debug] [MainThread]: Using duckdb connection "master"
[0m22:34:14.133599 [debug] [MainThread]: On master: BEGIN
[0m22:34:14.134179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:34:14.151397 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m22:34:14.152128 [debug] [MainThread]: On master: COMMIT
[0m22:34:14.152626 [debug] [MainThread]: Using duckdb connection "master"
[0m22:34:14.153102 [debug] [MainThread]: On master: COMMIT
[0m22:34:14.153915 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:34:14.154460 [debug] [MainThread]: On master: Close
[0m22:34:14.157956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:14.158560 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m22:34:14.159008 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m22:34:14.159429 [debug] [MainThread]: Connection 'model.assignment_4.products_qw' was properly closed.
[0m22:34:14.160674 [info ] [MainThread]: 
[0m22:34:14.161308 [info ] [MainThread]: Finished running 5 seeds, 5 view models, 4 table models in 0 hours 0 minutes and 11.37 seconds (11.37s).
[0m22:34:14.166967 [debug] [MainThread]: Command end result
[0m22:34:14.221866 [info ] [MainThread]: 
[0m22:34:14.222680 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:34:14.223673 [info ] [MainThread]: 
[0m22:34:14.224889 [error] [MainThread]:   Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:34:14.225842 [info ] [MainThread]: 
[0m22:34:14.226454 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m22:34:14.228074 [debug] [MainThread]: Command `dbt build` failed at 22:34:14.227839 after 13.07 seconds
[0m22:34:14.228731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE20F8B650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1E1377D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2718BB30>]}
[0m22:34:14.229336 [debug] [MainThread]: Flushing usage events
[0m22:35:01.749063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5889CEE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C58B428550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C58B428410>]}


============================== 22:35:01.755529 | 30d05826-951f-4636-bf6d-18d1ec93ed96 ==============================
[0m22:35:01.755529 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:35:01.756933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select products_qw', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:35:02.146189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30d05826-951f-4636-bf6d-18d1ec93ed96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C58B7A4510>]}
[0m22:35:02.248541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30d05826-951f-4636-bf6d-18d1ec93ed96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C58B3D7F00>]}
[0m22:35:02.255768 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:35:02.271543 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:35:02.519809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:35:02.520446 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:35:02.587272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30d05826-951f-4636-bf6d-18d1ec93ed96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C58B60C950>]}
[0m22:35:02.755893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30d05826-951f-4636-bf6d-18d1ec93ed96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C58C964AA0>]}
[0m22:35:02.756765 [info ] [MainThread]: Found 5 seeds, 9 models, 421 macros
[0m22:35:02.757637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30d05826-951f-4636-bf6d-18d1ec93ed96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C58B66CE50>]}
[0m22:35:02.760684 [info ] [MainThread]: 
[0m22:35:02.762116 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:35:02.764041 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:35:02.923395 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:35:02.924202 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:35:02.924743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:02.945596 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m22:35:02.947919 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:35:02.952240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:35:02.953160 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:35:02.964604 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:35:02.965283 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:35:02.965797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:35:02.983040 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:35:02.985383 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:35:02.985959 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:35:02.986817 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:35:02.987333 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:35:02.987829 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:35:02.988729 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:35:02.990234 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:35:02.991087 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:35:02.991703 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:35:02.992580 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:35:02.993120 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:35:03.006765 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:35:03.016526 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:35:03.017174 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:35:03.017669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:03.034483 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:35:03.035144 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:35:03.035675 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:35:03.135947 [debug] [ThreadPool]: SQL status: OK in 0.100 seconds
[0m22:35:03.154231 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:35:03.156955 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:35:03.157603 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:35:03.167589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30d05826-951f-4636-bf6d-18d1ec93ed96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C58CB67040>]}
[0m22:35:03.168522 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:03.169055 [debug] [MainThread]: On master: BEGIN
[0m22:35:03.169525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:35:03.186889 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m22:35:03.187565 [debug] [MainThread]: On master: COMMIT
[0m22:35:03.188062 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:03.188546 [debug] [MainThread]: On master: COMMIT
[0m22:35:03.189338 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:35:03.189871 [debug] [MainThread]: On master: Close
[0m22:35:03.194038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:35:03.195119 [info ] [MainThread]: 
[0m22:35:03.201357 [debug] [Thread-1 (]: Began running node model.assignment_4.products_qw
[0m22:35:03.202884 [info ] [Thread-1 (]: 1 of 1 START sql table model main.products_qw .................................. [RUN]
[0m22:35:03.204380 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.products_qw'
[0m22:35:03.205136 [debug] [Thread-1 (]: Began compiling node model.assignment_4.products_qw
[0m22:35:03.219102 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.products_qw"
[0m22:35:03.221522 [debug] [Thread-1 (]: Began executing node model.assignment_4.products_qw
[0m22:35:03.288380 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.products_qw"
[0m22:35:03.290306 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:35:03.291072 [debug] [Thread-1 (]: On model.assignment_4.products_qw: BEGIN
[0m22:35:03.291652 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:35:03.308594 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:35:03.309336 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:35:03.309974 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."products_qw__dbt_tmp"
  
    as (
      SELECT
    "product_id" AS product_id,
    "product_name" AS product_name,
    "category" AS category,
    "sub_category" AS sub_category
FROM "assignment_4"."main"."stg_products"
WHERE "category" = 'Office Supplies'
    );
  
  
[0m22:35:03.362199 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m22:35:03.372901 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:35:03.373656 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */
alter table "assignment_4"."main"."products_qw" rename to "products_qw__dbt_backup"
[0m22:35:03.374930 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:35:03.380068 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:35:03.380777 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */
alter table "assignment_4"."main"."products_qw__dbt_tmp" rename to "products_qw"
[0m22:35:03.381987 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:35:03.418099 [debug] [Thread-1 (]: On model.assignment_4.products_qw: COMMIT
[0m22:35:03.418847 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:35:03.419443 [debug] [Thread-1 (]: On model.assignment_4.products_qw: COMMIT
[0m22:35:03.479643 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m22:35:03.487999 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:35:03.488733 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */
drop table if exists "assignment_4"."main"."products_qw__dbt_backup" cascade
[0m22:35:03.493262 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:35:03.497504 [debug] [Thread-1 (]: On model.assignment_4.products_qw: Close
[0m22:35:03.577658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30d05826-951f-4636-bf6d-18d1ec93ed96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C58CBC5910>]}
[0m22:35:03.578814 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.products_qw ............................. [[32mOK[0m in 0.37s]
[0m22:35:03.580289 [debug] [Thread-1 (]: Finished running node model.assignment_4.products_qw
[0m22:35:03.582398 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:03.583012 [debug] [MainThread]: On master: BEGIN
[0m22:35:03.583490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:35:03.602603 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m22:35:03.603308 [debug] [MainThread]: On master: COMMIT
[0m22:35:03.603822 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:03.604305 [debug] [MainThread]: On master: COMMIT
[0m22:35:03.605153 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:35:03.605697 [debug] [MainThread]: On master: Close
[0m22:35:03.609722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:03.610572 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m22:35:03.611258 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m22:35:03.611728 [debug] [MainThread]: Connection 'model.assignment_4.products_qw' was properly closed.
[0m22:35:03.612317 [info ] [MainThread]: 
[0m22:35:03.613272 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m22:35:03.614885 [debug] [MainThread]: Command end result
[0m22:35:03.672302 [info ] [MainThread]: 
[0m22:35:03.673657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:35:03.674705 [info ] [MainThread]: 
[0m22:35:03.675579 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:35:03.677659 [debug] [MainThread]: Command `dbt run` succeeded at 22:35:03.677313 after 2.14 seconds
[0m22:35:03.678351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C58C9CD700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C58CD77A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C58CD77B10>]}
[0m22:35:03.678955 [debug] [MainThread]: Flushing usage events
[0m22:39:41.463017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C18E8B30E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C18E55F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1912F07D0>]}


============================== 22:39:41.469657 | fa3f49f6-35b1-4350-b37a-e4858b87a154 ==============================
[0m22:39:41.469657 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:39:41.470802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:39:41.870378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa3f49f6-35b1-4350-b37a-e4858b87a154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19267C510>]}
[0m22:39:41.986552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa3f49f6-35b1-4350-b37a-e4858b87a154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1912C7F00>]}
[0m22:39:41.996012 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:39:42.013206 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:39:42.282736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:39:42.283671 [debug] [MainThread]: Partial parsing: added file: assignment_4://models\marts\shipping_qw.sql
[0m22:39:42.717278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa3f49f6-35b1-4350-b37a-e4858b87a154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1914FCE50>]}
[0m22:39:42.909296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa3f49f6-35b1-4350-b37a-e4858b87a154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C191253B60>]}
[0m22:39:42.910265 [info ] [MainThread]: Found 5 seeds, 10 models, 421 macros
[0m22:39:42.914765 [info ] [MainThread]: 
[0m22:39:42.915788 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:39:42.927296 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:39:43.186850 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:39:43.187572 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:39:43.188549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:43.214685 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m22:39:43.217496 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:39:43.223870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:39:43.225081 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:39:43.238800 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:39:43.239524 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:39:43.240174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:39:43.261271 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m22:39:43.264699 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:39:43.265643 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:39:43.266947 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:39:43.267845 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:39:43.268825 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:39:43.270310 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:39:43.272818 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:39:43.273847 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:39:43.274735 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:39:43.275850 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:39:43.276505 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:39:43.284892 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:39:43.295728 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:39:43.296426 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:39:43.296975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:43.315610 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m22:39:43.316317 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:39:43.316854 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:39:43.398344 [debug] [ThreadPool]: SQL status: OK in 0.081 seconds
[0m22:39:43.401303 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:39:43.403864 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:39:43.404491 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:39:43.415683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa3f49f6-35b1-4350-b37a-e4858b87a154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C192AA8D70>]}
[0m22:39:43.416536 [debug] [MainThread]: Using duckdb connection "master"
[0m22:39:43.417061 [debug] [MainThread]: On master: BEGIN
[0m22:39:43.417545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:39:43.435022 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m22:39:43.435737 [debug] [MainThread]: On master: COMMIT
[0m22:39:43.436300 [debug] [MainThread]: Using duckdb connection "master"
[0m22:39:43.436825 [debug] [MainThread]: On master: COMMIT
[0m22:39:43.437701 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:39:43.438240 [debug] [MainThread]: On master: Close
[0m22:39:43.442686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:39:43.443504 [info ] [MainThread]: 
[0m22:39:43.449503 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m22:39:43.450584 [info ] [Thread-1 (]: 1 of 15 START seed file main.customers ......................................... [RUN]
[0m22:39:43.451644 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m22:39:43.452289 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m22:39:43.452908 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m22:39:43.890500 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:39:43.891250 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m22:39:43.891834 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:39:43.909049 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:39:43.909897 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:39:43.910522 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m22:39:43.913524 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:39:43.937272 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:39:43.938156 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:39:44.035164 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m22:39:44.048393 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m22:39:52.489069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6993F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C695DF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6C3807D0>]}


============================== 22:39:52.495397 | 21575c5a-7138-44da-acbd-70710a82695f ==============================
[0m22:39:52.495397 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:39:52.496365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:39:52.887854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6C738510>]}
[0m22:39:52.985163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6C357F00>]}
[0m22:39:52.992487 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:39:53.007335 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:39:53.263357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:39:53.264390 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\marts\shipping_qw.sql
[0m22:39:53.668866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6C58D050>]}
[0m22:39:53.854184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6C2E3B60>]}
[0m22:39:53.855057 [info ] [MainThread]: Found 5 seeds, 10 models, 421 macros
[0m22:39:53.859643 [info ] [MainThread]: 
[0m22:39:53.860679 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:39:53.871589 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:39:54.036519 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:39:54.037217 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:39:54.037740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:54.059233 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m22:39:54.061648 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:39:54.066699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:39:54.067658 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:39:54.079596 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:39:54.080282 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:39:54.080805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:39:54.101089 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m22:39:54.103578 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:39:54.104225 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:39:54.105324 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:39:54.106202 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:39:54.106913 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:39:54.108015 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:39:54.110232 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:39:54.110777 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:39:54.111275 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:39:54.112169 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:39:54.112725 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:39:54.120003 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:39:54.130569 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:39:54.131404 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:39:54.132137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:54.149894 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m22:39:54.150679 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:39:54.151254 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:39:54.225303 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m22:39:54.228133 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:39:54.230651 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:39:54.231379 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:39:54.241742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6DB78C90>]}
[0m22:39:54.242591 [debug] [MainThread]: Using duckdb connection "master"
[0m22:39:54.243121 [debug] [MainThread]: On master: BEGIN
[0m22:39:54.243592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:39:54.260925 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m22:39:54.261590 [debug] [MainThread]: On master: COMMIT
[0m22:39:54.262165 [debug] [MainThread]: Using duckdb connection "master"
[0m22:39:54.262679 [debug] [MainThread]: On master: COMMIT
[0m22:39:54.263507 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:39:54.264051 [debug] [MainThread]: On master: Close
[0m22:39:54.268079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:39:54.268807 [info ] [MainThread]: 
[0m22:39:54.274702 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m22:39:54.275746 [info ] [Thread-1 (]: 1 of 15 START seed file main.customers ......................................... [RUN]
[0m22:39:54.276712 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m22:39:54.277326 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m22:39:54.277941 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m22:39:54.703218 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:39:54.704086 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m22:39:54.704746 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:39:54.722071 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:39:54.722848 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:39:54.723479 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m22:39:54.726179 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:39:54.750103 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:39:54.750942 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:39:54.828071 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m22:39:54.838725 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m22:39:54.868622 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:39:54.869416 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:39:54.870028 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:39:54.950538 [debug] [Thread-1 (]: SQL status: OK in 0.080 seconds
[0m22:39:54.953628 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m22:39:55.052375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6DE33110>]}
[0m22:39:55.053361 [info ] [Thread-1 (]: 1 of 15 OK loaded seed file main.customers ..................................... [[32mINSERT 51290[0m in 0.77s]
[0m22:39:55.054740 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m22:39:55.055657 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m22:39:55.056761 [info ] [Thread-1 (]: 2 of 15 START seed file main.locations ......................................... [RUN]
[0m22:39:55.057854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m22:39:55.058515 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m22:39:55.059215 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m22:39:55.622549 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:39:55.623611 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m22:39:55.624392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:55.641085 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:39:55.641839 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:39:55.642457 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m22:39:55.645238 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:39:55.647616 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:39:55.648449 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:39:55.767506 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m22:39:55.768754 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m22:39:55.773048 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:39:55.773784 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:39:55.774484 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:39:55.897588 [debug] [Thread-1 (]: SQL status: OK in 0.122 seconds
[0m22:39:55.899099 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m22:39:56.084077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6D8FD0D0>]}
[0m22:39:56.085057 [info ] [Thread-1 (]: 2 of 15 OK loaded seed file main.locations ..................................... [[32mINSERT 51290[0m in 1.03s]
[0m22:39:56.086187 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m22:39:56.086898 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m22:39:56.087895 [info ] [Thread-1 (]: 3 of 15 START seed file main.orders ............................................ [RUN]
[0m22:39:56.089007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m22:39:56.090405 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m22:39:56.091725 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m22:39:59.962148 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:39:59.962967 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m22:39:59.963590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:59.980100 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:39:59.980847 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:39:59.981448 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m22:39:59.983626 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:39:59.985824 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:39:59.986473 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:40:00.435955 [debug] [Thread-1 (]: SQL status: OK in 0.449 seconds
[0m22:40:00.437183 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m22:40:00.441727 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:40:00.442488 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:40:00.443080 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:40:00.580538 [debug] [Thread-1 (]: SQL status: OK in 0.137 seconds
[0m22:40:00.582015 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m22:40:00.833649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6DB39230>]}
[0m22:40:00.834631 [info ] [Thread-1 (]: 3 of 15 OK loaded seed file main.orders ........................................ [[32mINSERT 51290[0m in 4.74s]
[0m22:40:00.835866 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m22:40:00.836735 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m22:40:00.837741 [info ] [Thread-1 (]: 4 of 15 START seed file main.products .......................................... [RUN]
[0m22:40:00.838747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m22:40:00.839421 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m22:40:00.840043 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m22:40:01.503126 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:40:01.503896 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m22:40:01.504480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:01.521125 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:40:01.521935 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:40:01.522569 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m22:40:01.525424 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:40:01.527718 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:40:01.528388 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:40:01.631123 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m22:40:01.632383 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m22:40:01.636545 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:40:01.637322 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:40:01.638024 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:40:01.735974 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m22:40:01.737548 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m22:40:01.871372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6C705630>]}
[0m22:40:01.872361 [info ] [Thread-1 (]: 4 of 15 OK loaded seed file main.products ...................................... [[32mINSERT 51290[0m in 1.03s]
[0m22:40:01.873647 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m22:40:01.874449 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m22:40:01.875718 [info ] [Thread-1 (]: 5 of 15 START seed file main.shipping .......................................... [RUN]
[0m22:40:01.876664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m22:40:01.877285 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m22:40:01.877880 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m22:40:02.975410 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:40:02.976165 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m22:40:02.976754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:02.994502 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:40:02.995264 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:40:02.995869 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m22:40:02.999011 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:40:03.001449 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:40:03.002276 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:40:03.339561 [debug] [Thread-1 (]: SQL status: OK in 0.337 seconds
[0m22:40:03.340797 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m22:40:03.344350 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:40:03.345111 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:40:03.345704 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:40:03.392380 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m22:40:03.394278 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m22:40:03.501473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7422A250>]}
[0m22:40:03.502460 [info ] [Thread-1 (]: 5 of 15 OK loaded seed file main.shipping ...................................... [[32mINSERT 51290[0m in 1.62s]
[0m22:40:03.503620 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m22:40:03.504402 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m22:40:03.505366 [info ] [Thread-1 (]: 6 of 15 START sql view model main.stg_customers ................................ [RUN]
[0m22:40:03.506207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m22:40:03.507023 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m22:40:03.521269 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m22:40:03.523251 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m22:40:03.580300 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m22:40:03.582108 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:40:03.582878 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m22:40:03.583466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:03.600297 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:40:03.601062 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:40:03.601697 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m22:40:03.603379 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:03.615160 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:40:03.615994 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m22:40:03.617301 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:03.622326 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:40:03.623057 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:40:03.624230 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:03.630566 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:40:03.631293 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:40:03.631894 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:40:03.673475 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m22:40:03.682492 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:40:03.683263 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m22:40:03.687417 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:40:03.690024 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m22:40:03.713478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6D954360>]}
[0m22:40:03.715066 [info ] [Thread-1 (]: 6 of 15 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.21s]
[0m22:40:03.716684 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m22:40:03.717947 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_locations
[0m22:40:03.719325 [info ] [Thread-1 (]: 7 of 15 START sql view model main.stg_locations ................................ [RUN]
[0m22:40:03.721054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_locations)
[0m22:40:03.722363 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_locations
[0m22:40:03.728571 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_locations"
[0m22:40:03.730345 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_locations
[0m22:40:03.735716 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_locations"
[0m22:40:03.737935 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:40:03.739110 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: BEGIN
[0m22:40:03.739851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:03.756943 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:40:03.757702 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:40:03.758329 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */

  
  create view "assignment_4"."main"."stg_locations__dbt_tmp" as (
    SELECT
    DISTINCT
    TRIM("City") AS city,
    TRIM("State") AS state,
    TRIM("Region") AS region,
    TRIM("Country") AS country,
    "Order.ID" AS order_id
FROM "assignment_4"."main"."locations"
  );

[0m22:40:03.759814 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:03.765322 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:40:03.766070 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations" rename to "stg_locations__dbt_backup"
[0m22:40:03.767265 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:03.772794 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:40:03.773533 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m22:40:03.774697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:03.777817 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:40:03.778740 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:40:03.779338 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:40:03.784731 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:40:03.788564 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:40:03.789273 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
drop view if exists "assignment_4"."main"."stg_locations__dbt_backup" cascade
[0m22:40:03.793646 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:40:03.796177 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: Close
[0m22:40:03.817948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6E04CBF0>]}
[0m22:40:03.819164 [info ] [Thread-1 (]: 7 of 15 OK created sql view model main.stg_locations ........................... [[32mOK[0m in 0.10s]
[0m22:40:03.820307 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_locations
[0m22:40:03.821029 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m22:40:03.821974 [info ] [Thread-1 (]: 8 of 15 START sql view model main.stg_orders ................................... [RUN]
[0m22:40:03.823106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_locations, now model.assignment_4.stg_orders)
[0m22:40:03.824045 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m22:40:03.828356 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m22:40:03.830197 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m22:40:03.836202 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m22:40:03.838131 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:40:03.839033 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m22:40:03.839706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:03.856959 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:40:03.857720 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:40:03.858364 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m22:40:03.859861 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:03.864571 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:40:03.865278 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m22:40:03.866469 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:03.871879 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:40:03.872619 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:40:03.873841 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:03.876417 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:40:03.877073 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:40:03.877657 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:40:03.883835 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:40:03.887951 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:40:03.888680 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m22:40:03.892643 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:40:03.895260 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m22:40:03.916795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6E04CD10>]}
[0m22:40:03.917947 [info ] [Thread-1 (]: 8 of 15 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.09s]
[0m22:40:03.919345 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m22:40:03.920237 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m22:40:03.921724 [info ] [Thread-1 (]: 9 of 15 START sql view model main.stg_products ................................. [RUN]
[0m22:40:03.922811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m22:40:03.923563 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m22:40:03.928308 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m22:40:03.931103 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m22:40:03.939218 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m22:40:03.941677 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:40:03.942811 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m22:40:03.943925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:03.964097 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m22:40:03.964874 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:40:03.965521 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:40:03.966828 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:03.972495 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:40:03.973267 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m22:40:03.974450 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:03.979097 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:40:03.979794 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m22:40:03.980952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:03.983702 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:40:03.984424 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:40:03.985010 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:40:03.990130 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:40:03.994705 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:40:03.995420 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m22:40:03.999952 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:40:04.003024 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m22:40:04.024853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6E04CE30>]}
[0m22:40:04.026046 [info ] [Thread-1 (]: 9 of 15 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.10s]
[0m22:40:04.027189 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m22:40:04.027921 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m22:40:04.028932 [info ] [Thread-1 (]: 10 of 15 START sql view model main.stg_shipping ................................ [RUN]
[0m22:40:04.030025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m22:40:04.030712 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m22:40:04.034800 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m22:40:04.036489 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m22:40:04.041966 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m22:40:04.043709 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:40:04.044527 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m22:40:04.045264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:04.062472 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:40:04.063221 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:40:04.063851 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:40:04.065177 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:04.070693 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:40:04.071437 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m22:40:04.072625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:04.077295 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:40:04.078227 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m22:40:04.079574 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:04.082524 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:40:04.083182 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:40:04.083768 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:40:04.089344 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:40:04.093606 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:40:04.094934 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m22:40:04.100158 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:40:04.104499 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m22:40:04.125653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6E04CF50>]}
[0m22:40:04.126939 [info ] [Thread-1 (]: 10 of 15 OK created sql view model main.stg_shipping ........................... [[32mOK[0m in 0.10s]
[0m22:40:04.128277 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m22:40:04.129106 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m22:40:04.130191 [info ] [Thread-1 (]: 11 of 15 START sql table model main.the_most_popular_customer .................. [RUN]
[0m22:40:04.131329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_shipping, now model.assignment_4.the_most_popular_customer)
[0m22:40:04.132025 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m22:40:04.136678 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m22:40:04.138656 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m22:40:04.177498 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m22:40:04.179301 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:40:04.180056 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m22:40:04.180681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:04.198343 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:40:04.199109 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:40:04.199763 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC
LIMIT 1
    );
  
  
[0m22:40:04.244733 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m22:40:04.250056 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:40:04.250797 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer" rename to "the_most_popular_customer__dbt_backup"
[0m22:40:04.252095 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:04.256755 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:40:04.257480 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer__dbt_tmp" rename to "the_most_popular_customer"
[0m22:40:04.258741 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:04.267923 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:40:04.268688 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:40:04.269330 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:40:04.309662 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m22:40:04.313367 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:40:04.314056 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
drop table if exists "assignment_4"."main"."the_most_popular_customer__dbt_backup" cascade
[0m22:40:04.317751 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:40:04.321386 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m22:40:04.347344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6E04CA10>]}
[0m22:40:04.348518 [info ] [Thread-1 (]: 11 of 15 OK created sql table model main.the_most_popular_customer ............. [[32mOK[0m in 0.22s]
[0m22:40:04.349636 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m22:40:04.350383 [debug] [Thread-1 (]: Began running node model.assignment_4.locations_qw
[0m22:40:04.351305 [info ] [Thread-1 (]: 12 of 15 START sql table model main.locations_qw ............................... [RUN]
[0m22:40:04.352188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.the_most_popular_customer, now model.assignment_4.locations_qw)
[0m22:40:04.352829 [debug] [Thread-1 (]: Began compiling node model.assignment_4.locations_qw
[0m22:40:04.357770 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.locations_qw"
[0m22:40:04.359429 [debug] [Thread-1 (]: Began executing node model.assignment_4.locations_qw
[0m22:40:04.364862 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.locations_qw"
[0m22:40:04.366604 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:40:04.367348 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: BEGIN
[0m22:40:04.367924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:04.384788 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:40:04.385538 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:40:04.386297 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:40:04.388635 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:40:04.389455 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:40:04.390303 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: ROLLBACK
[0m22:40:04.403244 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.locations_qw'
[0m22:40:04.404044 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: Close
[0m22:40:04.415354 [debug] [Thread-1 (]: Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:40:04.416254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7444D730>]}
[0m22:40:04.417285 [error] [Thread-1 (]: 12 of 15 ERROR creating sql table model main.locations_qw ...................... [[31mERROR[0m in 0.06s]
[0m22:40:04.418459 [debug] [Thread-1 (]: Finished running node model.assignment_4.locations_qw
[0m22:40:04.419167 [debug] [Thread-1 (]: Began running node model.assignment_4.orders_qw
[0m22:40:04.420737 [info ] [Thread-1 (]: 13 of 15 START sql table model main.orders_qw .................................. [RUN]
[0m22:40:04.421644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.locations_qw, now model.assignment_4.orders_qw)
[0m22:40:04.422380 [debug] [Thread-1 (]: Began compiling node model.assignment_4.orders_qw
[0m22:40:04.432590 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.orders_qw"
[0m22:40:04.434376 [debug] [Thread-1 (]: Began executing node model.assignment_4.orders_qw
[0m22:40:04.439621 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.orders_qw"
[0m22:40:04.441477 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:40:04.442303 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: BEGIN
[0m22:40:04.442904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:04.460337 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:40:04.461077 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:40:04.461709 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."orders_qw__dbt_tmp"
  
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    order_priority,
    quantity,
    discount,
    sales,
    profit,
    market,
    region,
    weeknum,
    year
FROM "assignment_4"."main"."stg_orders"
ORDER BY order_date ASC
LIMIT 5
    );
  
  
[0m22:40:04.482504 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m22:40:04.487115 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:40:04.487855 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
alter table "assignment_4"."main"."orders_qw" rename to "orders_qw__dbt_backup"
[0m22:40:04.489253 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:04.494687 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:40:04.495419 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
alter table "assignment_4"."main"."orders_qw__dbt_tmp" rename to "orders_qw"
[0m22:40:04.496700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:04.499511 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: COMMIT
[0m22:40:04.500197 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:40:04.500779 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: COMMIT
[0m22:40:04.505616 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:40:04.509401 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:40:04.510096 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
drop table if exists "assignment_4"."main"."orders_qw__dbt_backup" cascade
[0m22:40:04.514288 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:40:04.517097 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: Close
[0m22:40:04.547015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6E04CFB0>]}
[0m22:40:04.548150 [info ] [Thread-1 (]: 13 of 15 OK created sql table model main.orders_qw ............................. [[32mOK[0m in 0.13s]
[0m22:40:04.549247 [debug] [Thread-1 (]: Finished running node model.assignment_4.orders_qw
[0m22:40:04.549935 [debug] [Thread-1 (]: Began running node model.assignment_4.products_qw
[0m22:40:04.550893 [info ] [Thread-1 (]: 14 of 15 START sql table model main.products_qw ................................ [RUN]
[0m22:40:04.551792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.orders_qw, now model.assignment_4.products_qw)
[0m22:40:04.552455 [debug] [Thread-1 (]: Began compiling node model.assignment_4.products_qw
[0m22:40:04.557023 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.products_qw"
[0m22:40:04.558963 [debug] [Thread-1 (]: Began executing node model.assignment_4.products_qw
[0m22:40:04.566104 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.products_qw"
[0m22:40:04.568245 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:40:04.569184 [debug] [Thread-1 (]: On model.assignment_4.products_qw: BEGIN
[0m22:40:04.569986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:04.593995 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m22:40:04.595061 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:40:04.596200 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."products_qw__dbt_tmp"
  
    as (
      SELECT
    "product_id" AS product_id,
    "product_name" AS product_name,
    "category" AS category,
    "sub_category" AS sub_category
FROM "assignment_4"."main"."stg_products"
WHERE "category" = 'Office Supplies'
    );
  
  
[0m22:40:04.658068 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m22:40:04.662732 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:40:04.663462 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */
alter table "assignment_4"."main"."products_qw" rename to "products_qw__dbt_backup"
[0m22:40:04.664756 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:04.669389 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:40:04.670108 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */
alter table "assignment_4"."main"."products_qw__dbt_tmp" rename to "products_qw"
[0m22:40:04.671389 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:40:04.675237 [debug] [Thread-1 (]: On model.assignment_4.products_qw: COMMIT
[0m22:40:04.675979 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:40:04.676570 [debug] [Thread-1 (]: On model.assignment_4.products_qw: COMMIT
[0m22:40:04.730676 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m22:40:04.734627 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:40:04.735386 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */
drop table if exists "assignment_4"."main"."products_qw__dbt_backup" cascade
[0m22:40:04.739396 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:40:04.742466 [debug] [Thread-1 (]: On model.assignment_4.products_qw: Close
[0m22:40:04.822487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6E04CFB0>]}
[0m22:40:04.823679 [info ] [Thread-1 (]: 14 of 15 OK created sql table model main.products_qw ........................... [[32mOK[0m in 0.27s]
[0m22:40:04.824789 [debug] [Thread-1 (]: Finished running node model.assignment_4.products_qw
[0m22:40:04.825563 [debug] [Thread-1 (]: Began running node model.assignment_4.shipping_qw
[0m22:40:04.826473 [info ] [Thread-1 (]: 15 of 15 START sql table model main.shipping_qw ................................ [RUN]
[0m22:40:04.827260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.products_qw, now model.assignment_4.shipping_qw)
[0m22:40:04.827857 [debug] [Thread-1 (]: Began compiling node model.assignment_4.shipping_qw
[0m22:40:04.832139 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.shipping_qw"
[0m22:40:04.834057 [debug] [Thread-1 (]: Began executing node model.assignment_4.shipping_qw
[0m22:40:04.840798 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.shipping_qw"
[0m22:40:04.842769 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.shipping_qw"
[0m22:40:04.843561 [debug] [Thread-1 (]: On model.assignment_4.shipping_qw: BEGIN
[0m22:40:04.844185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:04.862760 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:40:04.863503 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.shipping_qw"
[0m22:40:04.864125 [debug] [Thread-1 (]: On model.assignment_4.shipping_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.shipping_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."shipping_qw__dbt_tmp"
  
    as (
      SELECT
    "Order.ID",
    "Ship.Date",
    "Ship.Mode",
    "Shipping.Cost"
FROM "assignment_4"."main"."stg_shipping"
ORDER BY "Shipping.Cost" DESC
LIMIT 5
    );
  
  
[0m22:40:04.865968 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.shipping_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."shipping_qw__dbt_tmp"
  
    as (
      SELECT
    "Order.ID",
    "Ship.Date",
    "Ship.Mode",
    "Shipping.Cost"
FROM "assignment_4"."main"."stg_shipping"
ORDER BY "Shipping.Cost" DESC
LIMIT 5
    );
  
  
[0m22:40:04.866731 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:40:04.867572 [debug] [Thread-1 (]: On model.assignment_4.shipping_qw: ROLLBACK
[0m22:40:04.875953 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.shipping_qw'
[0m22:40:04.876655 [debug] [Thread-1 (]: On model.assignment_4.shipping_qw: Close
[0m22:40:04.887921 [debug] [Thread-1 (]: Runtime Error in model shipping_qw (models\marts\shipping_qw.sql)
  Binder Error: Referenced column "Order.ID" not found in FROM clause!
  Candidate bindings: "stg_shipping.category"
  LINE 12:     "Order.ID",
               ^
[0m22:40:04.888814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21575c5a-7138-44da-acbd-70710a82695f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7444EC30>]}
[0m22:40:04.889806 [error] [Thread-1 (]: 15 of 15 ERROR creating sql table model main.shipping_qw ....................... [[31mERROR[0m in 0.06s]
[0m22:40:04.890943 [debug] [Thread-1 (]: Finished running node model.assignment_4.shipping_qw
[0m22:40:04.892990 [debug] [MainThread]: Using duckdb connection "master"
[0m22:40:04.893682 [debug] [MainThread]: On master: BEGIN
[0m22:40:04.894155 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:04.911903 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m22:40:04.912562 [debug] [MainThread]: On master: COMMIT
[0m22:40:04.913057 [debug] [MainThread]: Using duckdb connection "master"
[0m22:40:04.913532 [debug] [MainThread]: On master: COMMIT
[0m22:40:04.914327 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:40:04.914858 [debug] [MainThread]: On master: Close
[0m22:40:04.918497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:04.919287 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m22:40:04.919825 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m22:40:04.920357 [debug] [MainThread]: Connection 'model.assignment_4.shipping_qw' was properly closed.
[0m22:40:04.921505 [info ] [MainThread]: 
[0m22:40:04.922130 [info ] [MainThread]: Finished running 5 seeds, 5 view models, 5 table models in 0 hours 0 minutes and 11.06 seconds (11.06s).
[0m22:40:04.929126 [debug] [MainThread]: Command end result
[0m22:40:04.986754 [info ] [MainThread]: 
[0m22:40:04.987788 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:40:04.988576 [info ] [MainThread]: 
[0m22:40:04.989723 [error] [MainThread]:   Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:40:04.990771 [info ] [MainThread]: 
[0m22:40:04.991509 [error] [MainThread]:   Runtime Error in model shipping_qw (models\marts\shipping_qw.sql)
  Binder Error: Referenced column "Order.ID" not found in FROM clause!
  Candidate bindings: "stg_shipping.category"
  LINE 12:     "Order.ID",
               ^
[0m22:40:04.992099 [info ] [MainThread]: 
[0m22:40:04.992688 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=2 SKIP=0 TOTAL=15
[0m22:40:04.994295 [debug] [MainThread]: Command `dbt build` failed at 22:40:04.994061 after 12.69 seconds
[0m22:40:04.995178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6D834710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C697D5A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7406FEF0>]}
[0m22:40:04.996017 [debug] [MainThread]: Flushing usage events
[0m22:41:07.552982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910B04F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910ACEF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910DA907D0>]}


============================== 22:41:07.559584 | 5d54db21-be93-49f0-9af3-c053b6803978 ==============================
[0m22:41:07.559584 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:41:07.560612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:41:07.951922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910DE2C510>]}
[0m22:41:08.052849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910DA67F00>]}
[0m22:41:08.060111 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:41:08.075386 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:41:08.337753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:41:08.338897 [debug] [MainThread]: Partial parsing: updated file: assignment_4://models\marts\shipping_qw.sql
[0m22:41:08.741500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910DC9D050>]}
[0m22:41:08.923665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910D9F3B60>]}
[0m22:41:08.924577 [info ] [MainThread]: Found 5 seeds, 10 models, 421 macros
[0m22:41:08.929399 [info ] [MainThread]: 
[0m22:41:08.930463 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:41:08.940673 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:41:09.121007 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:41:09.121712 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:41:09.122241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:09.143512 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m22:41:09.145903 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:41:09.150492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:41:09.151404 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:41:09.162844 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:41:09.163556 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:41:09.164221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:09.181402 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:41:09.183781 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:41:09.184362 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:41:09.185220 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:41:09.185744 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:41:09.186233 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:41:09.187103 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:41:09.188730 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:41:09.189255 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:41:09.189759 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:41:09.190553 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:41:09.191095 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:41:09.198842 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:41:09.208383 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:41:09.209043 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:41:09.209523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:09.225946 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m22:41:09.226618 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:41:09.227262 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:41:09.296313 [debug] [ThreadPool]: SQL status: OK in 0.068 seconds
[0m22:41:09.299079 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:41:09.301744 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:41:09.302372 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:41:09.312364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910F239C50>]}
[0m22:41:09.313184 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:09.313707 [debug] [MainThread]: On master: BEGIN
[0m22:41:09.314175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:41:09.332166 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m22:41:09.332850 [debug] [MainThread]: On master: COMMIT
[0m22:41:09.333356 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:09.333839 [debug] [MainThread]: On master: COMMIT
[0m22:41:09.334605 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:41:09.335141 [debug] [MainThread]: On master: Close
[0m22:41:09.339252 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:41:09.339971 [info ] [MainThread]: 
[0m22:41:09.345857 [debug] [Thread-1 (]: Began running node seed.assignment_4.customers
[0m22:41:09.347044 [info ] [Thread-1 (]: 1 of 15 START seed file main.customers ......................................... [RUN]
[0m22:41:09.348027 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.assignment_4.customers'
[0m22:41:09.348666 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.customers
[0m22:41:09.349296 [debug] [Thread-1 (]: Began executing node seed.assignment_4.customers
[0m22:41:09.772925 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:41:09.773684 [debug] [Thread-1 (]: On seed.assignment_4.customers: BEGIN
[0m22:41:09.774265 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:41:09.791126 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:41:09.791898 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:41:09.792509 [debug] [Thread-1 (]: On seed.assignment_4.customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.customers"} */
truncate table "assignment_4"."main"."customers"
[0m22:41:09.794954 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:41:09.816751 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:41:09.817516 [debug] [Thread-1 (]: On seed.assignment_4.customers: 
          COPY "assignment_4"."main"."customers" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:41:09.895300 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m22:41:09.906468 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.customers"
[0m22:41:09.937109 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:41:09.937871 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.customers"
[0m22:41:09.938465 [debug] [Thread-1 (]: On seed.assignment_4.customers: COMMIT
[0m22:41:09.989220 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m22:41:09.992278 [debug] [Thread-1 (]: On seed.assignment_4.customers: Close
[0m22:41:10.107863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910F4F3040>]}
[0m22:41:10.108857 [info ] [Thread-1 (]: 1 of 15 OK loaded seed file main.customers ..................................... [[32mINSERT 51290[0m in 0.76s]
[0m22:41:10.110153 [debug] [Thread-1 (]: Finished running node seed.assignment_4.customers
[0m22:41:10.110932 [debug] [Thread-1 (]: Began running node seed.assignment_4.locations
[0m22:41:10.112004 [info ] [Thread-1 (]: 2 of 15 START seed file main.locations ......................................... [RUN]
[0m22:41:10.113311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.customers, now seed.assignment_4.locations)
[0m22:41:10.114317 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.locations
[0m22:41:10.115045 [debug] [Thread-1 (]: Began executing node seed.assignment_4.locations
[0m22:41:10.662748 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:41:10.663499 [debug] [Thread-1 (]: On seed.assignment_4.locations: BEGIN
[0m22:41:10.664090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:10.681483 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:41:10.682233 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:41:10.682839 [debug] [Thread-1 (]: On seed.assignment_4.locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.locations"} */
truncate table "assignment_4"."main"."locations"
[0m22:41:10.685077 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:41:10.687428 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:41:10.688135 [debug] [Thread-1 (]: On seed.assignment_4.locations: 
          COPY "assignment_4"."main"."locations" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\locations.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:41:10.808597 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m22:41:10.809872 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.locations"
[0m22:41:10.813519 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:41:10.814340 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.locations"
[0m22:41:10.815017 [debug] [Thread-1 (]: On seed.assignment_4.locations: COMMIT
[0m22:41:10.919028 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m22:41:10.920599 [debug] [Thread-1 (]: On seed.assignment_4.locations: Close
[0m22:41:11.150589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910EF993D0>]}
[0m22:41:11.151759 [info ] [Thread-1 (]: 2 of 15 OK loaded seed file main.locations ..................................... [[32mINSERT 51290[0m in 1.04s]
[0m22:41:11.152912 [debug] [Thread-1 (]: Finished running node seed.assignment_4.locations
[0m22:41:11.153610 [debug] [Thread-1 (]: Began running node seed.assignment_4.orders
[0m22:41:11.154559 [info ] [Thread-1 (]: 3 of 15 START seed file main.orders ............................................ [RUN]
[0m22:41:11.155663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.locations, now seed.assignment_4.orders)
[0m22:41:11.156342 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.orders
[0m22:41:11.156951 [debug] [Thread-1 (]: Began executing node seed.assignment_4.orders
[0m22:41:15.037412 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:41:15.038193 [debug] [Thread-1 (]: On seed.assignment_4.orders: BEGIN
[0m22:41:15.038813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:15.055913 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:41:15.056665 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:41:15.057273 [debug] [Thread-1 (]: On seed.assignment_4.orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.orders"} */
truncate table "assignment_4"."main"."orders"
[0m22:41:15.059345 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:15.061769 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:41:15.062482 [debug] [Thread-1 (]: On seed.assignment_4.orders: 
          COPY "assignment_4"."main"."orders" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:41:15.502008 [debug] [Thread-1 (]: SQL status: OK in 0.439 seconds
[0m22:41:15.503243 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.orders"
[0m22:41:15.507373 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:41:15.508112 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.orders"
[0m22:41:15.508701 [debug] [Thread-1 (]: On seed.assignment_4.orders: COMMIT
[0m22:41:15.647476 [debug] [Thread-1 (]: SQL status: OK in 0.138 seconds
[0m22:41:15.649193 [debug] [Thread-1 (]: On seed.assignment_4.orders: Close
[0m22:41:15.964785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910F1F9230>]}
[0m22:41:15.965796 [info ] [Thread-1 (]: 3 of 15 OK loaded seed file main.orders ........................................ [[32mINSERT 51290[0m in 4.81s]
[0m22:41:15.966917 [debug] [Thread-1 (]: Finished running node seed.assignment_4.orders
[0m22:41:15.967669 [debug] [Thread-1 (]: Began running node seed.assignment_4.products
[0m22:41:15.968705 [info ] [Thread-1 (]: 4 of 15 START seed file main.products .......................................... [RUN]
[0m22:41:15.969849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.orders, now seed.assignment_4.products)
[0m22:41:15.970532 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.products
[0m22:41:15.971149 [debug] [Thread-1 (]: Began executing node seed.assignment_4.products
[0m22:41:16.624973 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:41:16.625727 [debug] [Thread-1 (]: On seed.assignment_4.products: BEGIN
[0m22:41:16.626342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:16.644038 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:41:16.644945 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:41:16.645565 [debug] [Thread-1 (]: On seed.assignment_4.products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.products"} */
truncate table "assignment_4"."main"."products"
[0m22:41:16.648182 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:41:16.650503 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:41:16.651170 [debug] [Thread-1 (]: On seed.assignment_4.products: 
          COPY "assignment_4"."main"."products" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:41:16.753903 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m22:41:16.755531 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.products"
[0m22:41:16.759356 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:41:16.760193 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.products"
[0m22:41:16.760818 [debug] [Thread-1 (]: On seed.assignment_4.products: COMMIT
[0m22:41:16.856482 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m22:41:16.858180 [debug] [Thread-1 (]: On seed.assignment_4.products: Close
[0m22:41:17.072519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910DE19630>]}
[0m22:41:17.073499 [info ] [Thread-1 (]: 4 of 15 OK loaded seed file main.products ...................................... [[32mINSERT 51290[0m in 1.10s]
[0m22:41:17.074598 [debug] [Thread-1 (]: Finished running node seed.assignment_4.products
[0m22:41:17.075298 [debug] [Thread-1 (]: Began running node seed.assignment_4.shipping
[0m22:41:17.076277 [info ] [Thread-1 (]: 5 of 15 START seed file main.shipping .......................................... [RUN]
[0m22:41:17.077369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.products, now seed.assignment_4.shipping)
[0m22:41:17.078067 [debug] [Thread-1 (]: Began compiling node seed.assignment_4.shipping
[0m22:41:17.078679 [debug] [Thread-1 (]: Began executing node seed.assignment_4.shipping
[0m22:41:18.173638 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:41:18.174394 [debug] [Thread-1 (]: On seed.assignment_4.shipping: BEGIN
[0m22:41:18.174983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:18.192148 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:41:18.192899 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:41:18.193505 [debug] [Thread-1 (]: On seed.assignment_4.shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "seed.assignment_4.shipping"} */
truncate table "assignment_4"."main"."shipping"
[0m22:41:18.195702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:18.197987 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:41:18.198658 [debug] [Thread-1 (]: On seed.assignment_4.shipping: 
          COPY "assignment_4"."main"."shipping" FROM 'C:\Users\acer\PycharmProjects\pythonProject3\seeds\shipping.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:41:18.505601 [debug] [Thread-1 (]: SQL status: OK in 0.306 seconds
[0m22:41:18.506887 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.assignment_4.shipping"
[0m22:41:18.510498 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:41:18.511223 [debug] [Thread-1 (]: Using duckdb connection "seed.assignment_4.shipping"
[0m22:41:18.511818 [debug] [Thread-1 (]: On seed.assignment_4.shipping: COMMIT
[0m22:41:18.594411 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m22:41:18.595985 [debug] [Thread-1 (]: On seed.assignment_4.shipping: Close
[0m22:41:18.774465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291159EA2D0>]}
[0m22:41:18.775451 [info ] [Thread-1 (]: 5 of 15 OK loaded seed file main.shipping ...................................... [[32mINSERT 51290[0m in 1.70s]
[0m22:41:18.776556 [debug] [Thread-1 (]: Finished running node seed.assignment_4.shipping
[0m22:41:18.777452 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_customers
[0m22:41:18.778474 [info ] [Thread-1 (]: 6 of 15 START sql view model main.stg_customers ................................ [RUN]
[0m22:41:18.779504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.assignment_4.shipping, now model.assignment_4.stg_customers)
[0m22:41:18.780210 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_customers
[0m22:41:18.793883 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_customers"
[0m22:41:18.795999 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_customers
[0m22:41:18.858353 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_customers"
[0m22:41:18.860409 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:41:18.861238 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: BEGIN
[0m22:41:18.861836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:18.881753 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m22:41:18.882515 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:41:18.883150 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */

  
  create view "assignment_4"."main"."stg_customers__dbt_tmp" as (
    SELECT
        DISTINCT "Customer.ID" AS customer_id,
        TRIM("Customer.Name") AS customer_name,
        TRIM(LOWER("Segment")) AS segment
FROM "assignment_4"."main"."customers"
  );

[0m22:41:18.884542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:18.897093 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:41:18.897874 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m22:41:18.899110 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:18.903909 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:41:18.904618 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
alter view "assignment_4"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:41:18.905979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:18.913438 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:41:18.914179 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:41:18.914776 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: COMMIT
[0m22:41:18.957489 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m22:41:18.966562 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_customers"
[0m22:41:18.967335 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_customers"} */
drop view if exists "assignment_4"."main"."stg_customers__dbt_backup" cascade
[0m22:41:18.971538 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:41:18.974130 [debug] [Thread-1 (]: On model.assignment_4.stg_customers: Close
[0m22:41:18.997119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910F36C830>]}
[0m22:41:18.998292 [info ] [Thread-1 (]: 6 of 15 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.22s]
[0m22:41:18.999422 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_customers
[0m22:41:19.000155 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_locations
[0m22:41:19.001128 [info ] [Thread-1 (]: 7 of 15 START sql view model main.stg_locations ................................ [RUN]
[0m22:41:19.002223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_customers, now model.assignment_4.stg_locations)
[0m22:41:19.003022 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_locations
[0m22:41:19.008430 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_locations"
[0m22:41:19.010154 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_locations
[0m22:41:19.015961 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_locations"
[0m22:41:19.017723 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:41:19.018486 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: BEGIN
[0m22:41:19.019071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:19.036324 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:41:19.037191 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:41:19.037821 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */

  
  create view "assignment_4"."main"."stg_locations__dbt_tmp" as (
    SELECT
    DISTINCT
    TRIM("City") AS city,
    TRIM("State") AS state,
    TRIM("Region") AS region,
    TRIM("Country") AS country,
    "Order.ID" AS order_id
FROM "assignment_4"."main"."locations"
  );

[0m22:41:19.039318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:19.044232 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:41:19.044975 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations" rename to "stg_locations__dbt_backup"
[0m22:41:19.046266 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:19.051684 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:41:19.052429 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
alter view "assignment_4"."main"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m22:41:19.053611 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:19.056303 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:41:19.056966 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:41:19.057559 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: COMMIT
[0m22:41:19.062536 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:41:19.066684 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_locations"
[0m22:41:19.067424 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_locations"} */
drop view if exists "assignment_4"."main"."stg_locations__dbt_backup" cascade
[0m22:41:19.071486 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:41:19.074475 [debug] [Thread-1 (]: On model.assignment_4.stg_locations: Close
[0m22:41:19.097466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002911172A6F0>]}
[0m22:41:19.098761 [info ] [Thread-1 (]: 7 of 15 OK created sql view model main.stg_locations ........................... [[32mOK[0m in 0.10s]
[0m22:41:19.099937 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_locations
[0m22:41:19.100657 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_orders
[0m22:41:19.101621 [info ] [Thread-1 (]: 8 of 15 START sql view model main.stg_orders ................................... [RUN]
[0m22:41:19.102865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_locations, now model.assignment_4.stg_orders)
[0m22:41:19.103727 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_orders
[0m22:41:19.108023 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_orders"
[0m22:41:19.109943 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_orders
[0m22:41:19.116126 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_orders"
[0m22:41:19.117853 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:41:19.118615 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: BEGIN
[0m22:41:19.119335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:19.136224 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:41:19.136968 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:41:19.137612 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */

  
  create view "assignment_4"."main"."stg_orders__dbt_tmp" as (
    SELECT
    "Order.ID" AS order_id,
    "Customer.ID" AS customer_id,
    "Product.ID" AS product_id,
    CAST("Order.Date" AS DATE) AS order_date,
    "Order.Priority" AS order_priority,
    CAST("Quantity" AS INTEGER) AS quantity,
    CAST("Discount" AS FLOAT) AS discount,
    CAST("Sales" AS FLOAT) AS sales,
    CAST("Profit" AS FLOAT) AS profit,
    "Market" AS market,
    "Market2" AS region,
    CAST("weeknum" AS INTEGER) AS weeknum,
    CAST("Year" AS INTEGER) AS year
FROM "assignment_4"."main"."orders"
  );

[0m22:41:19.139043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:19.143963 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:41:19.144709 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m22:41:19.145916 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:19.151213 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:41:19.151945 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
alter view "assignment_4"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:41:19.153069 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:41:19.155711 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:41:19.156359 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:41:19.156941 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: COMMIT
[0m22:41:19.162426 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:41:19.166587 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_orders"
[0m22:41:19.167273 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_orders"} */
drop view if exists "assignment_4"."main"."stg_orders__dbt_backup" cascade
[0m22:41:19.171312 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:41:19.173985 [debug] [Thread-1 (]: On model.assignment_4.stg_orders: Close
[0m22:41:19.196031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910F70CE90>]}
[0m22:41:19.197198 [info ] [Thread-1 (]: 8 of 15 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.09s]
[0m22:41:19.198322 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_orders
[0m22:41:19.199035 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_products
[0m22:41:19.199875 [info ] [Thread-1 (]: 9 of 15 START sql view model main.stg_products ................................. [RUN]
[0m22:41:19.200974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_orders, now model.assignment_4.stg_products)
[0m22:41:19.201956 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_products
[0m22:41:19.206572 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_products"
[0m22:41:19.208431 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_products
[0m22:41:19.215420 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_products"
[0m22:41:19.217507 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:41:19.218303 [debug] [Thread-1 (]: On model.assignment_4.stg_products: BEGIN
[0m22:41:19.218991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:19.236967 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:41:19.237712 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:41:19.238329 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */

  
  create view "assignment_4"."main"."stg_products__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:41:19.239678 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:19.244834 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:41:19.245760 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m22:41:19.247002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:19.251871 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:41:19.252607 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
alter view "assignment_4"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m22:41:19.253776 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:19.256423 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:41:19.257088 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:41:19.257760 [debug] [Thread-1 (]: On model.assignment_4.stg_products: COMMIT
[0m22:41:19.262494 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:41:19.267161 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_products"
[0m22:41:19.267867 [debug] [Thread-1 (]: On model.assignment_4.stg_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_products"} */
drop view if exists "assignment_4"."main"."stg_products__dbt_backup" cascade
[0m22:41:19.271418 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:41:19.274308 [debug] [Thread-1 (]: On model.assignment_4.stg_products: Close
[0m22:41:19.294916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910F70CFB0>]}
[0m22:41:19.296073 [info ] [Thread-1 (]: 9 of 15 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.09s]
[0m22:41:19.297209 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_products
[0m22:41:19.297924 [debug] [Thread-1 (]: Began running node model.assignment_4.stg_shipping
[0m22:41:19.298859 [info ] [Thread-1 (]: 10 of 15 START sql view model main.stg_shipping ................................ [RUN]
[0m22:41:19.299808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_products, now model.assignment_4.stg_shipping)
[0m22:41:19.300463 [debug] [Thread-1 (]: Began compiling node model.assignment_4.stg_shipping
[0m22:41:19.304480 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.stg_shipping"
[0m22:41:19.306321 [debug] [Thread-1 (]: Began executing node model.assignment_4.stg_shipping
[0m22:41:19.311822 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.stg_shipping"
[0m22:41:19.313472 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:41:19.314223 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: BEGIN
[0m22:41:19.314868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:19.331404 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:41:19.332139 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:41:19.332752 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */

  
  create view "assignment_4"."main"."stg_shipping__dbt_tmp" as (
    SELECT
    "Product.ID" AS product_id,
    TRIM("Product.Name") AS product_name,
    "Category" AS category,
    "Sub.Category" AS sub_category
FROM "assignment_4"."main"."products"
  );

[0m22:41:19.334045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:19.339802 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:41:19.340539 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping" rename to "stg_shipping__dbt_backup"
[0m22:41:19.341669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:19.346350 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:41:19.347059 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
alter view "assignment_4"."main"."stg_shipping__dbt_tmp" rename to "stg_shipping"
[0m22:41:19.348206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:41:19.350864 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:41:19.351524 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:41:19.352104 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: COMMIT
[0m22:41:19.357032 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:41:19.361174 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.stg_shipping"
[0m22:41:19.361854 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.stg_shipping"} */
drop view if exists "assignment_4"."main"."stg_shipping__dbt_backup" cascade
[0m22:41:19.365419 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:41:19.368890 [debug] [Thread-1 (]: On model.assignment_4.stg_shipping: Close
[0m22:41:19.390234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910F70D0D0>]}
[0m22:41:19.391357 [info ] [Thread-1 (]: 10 of 15 OK created sql view model main.stg_shipping ........................... [[32mOK[0m in 0.09s]
[0m22:41:19.392440 [debug] [Thread-1 (]: Finished running node model.assignment_4.stg_shipping
[0m22:41:19.393147 [debug] [Thread-1 (]: Began running node model.assignment_4.the_most_popular_customer
[0m22:41:19.394094 [info ] [Thread-1 (]: 11 of 15 START sql table model main.the_most_popular_customer .................. [RUN]
[0m22:41:19.395023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.stg_shipping, now model.assignment_4.the_most_popular_customer)
[0m22:41:19.395678 [debug] [Thread-1 (]: Began compiling node model.assignment_4.the_most_popular_customer
[0m22:41:19.400259 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.the_most_popular_customer"
[0m22:41:19.401998 [debug] [Thread-1 (]: Began executing node model.assignment_4.the_most_popular_customer
[0m22:41:19.447670 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.the_most_popular_customer"
[0m22:41:19.449844 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:41:19.450695 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: BEGIN
[0m22:41:19.451798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:19.470768 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m22:41:19.471525 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:41:19.472172 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */

  
    
    

    create  table
      "assignment_4"."main"."the_most_popular_customer__dbt_tmp"
  
    as (
      WITH order_counts AS (
    SELECT
        sc.customer_id,
        sc.customer_name,
        COUNT(o."Order.ID") AS order_count
    FROM "assignment_4"."main"."stg_customers" AS sc
    JOIN "assignment_4"."main"."orders" AS o ON sc.customer_id = o."Customer.ID"
    GROUP BY
        sc.customer_id,
        sc.customer_name
)

SELECT
    customer_id,
    customer_name,
    order_count
FROM order_counts
ORDER BY order_count DESC
LIMIT 1
    );
  
  
[0m22:41:19.523909 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m22:41:19.529388 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:41:19.530209 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer" rename to "the_most_popular_customer__dbt_backup"
[0m22:41:19.531524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:19.536226 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:41:19.536939 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
alter table "assignment_4"."main"."the_most_popular_customer__dbt_tmp" rename to "the_most_popular_customer"
[0m22:41:19.538130 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:19.547528 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:41:19.548281 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:41:19.548886 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: COMMIT
[0m22:41:19.593062 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m22:41:19.596872 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.the_most_popular_customer"
[0m22:41:19.597584 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.the_most_popular_customer"} */
drop table if exists "assignment_4"."main"."the_most_popular_customer__dbt_backup" cascade
[0m22:41:19.601578 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:41:19.605169 [debug] [Thread-1 (]: On model.assignment_4.the_most_popular_customer: Close
[0m22:41:19.632125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910F70CB30>]}
[0m22:41:19.633329 [info ] [Thread-1 (]: 11 of 15 OK created sql table model main.the_most_popular_customer ............. [[32mOK[0m in 0.24s]
[0m22:41:19.634501 [debug] [Thread-1 (]: Finished running node model.assignment_4.the_most_popular_customer
[0m22:41:19.635210 [debug] [Thread-1 (]: Began running node model.assignment_4.locations_qw
[0m22:41:19.636129 [info ] [Thread-1 (]: 12 of 15 START sql table model main.locations_qw ............................... [RUN]
[0m22:41:19.636963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.the_most_popular_customer, now model.assignment_4.locations_qw)
[0m22:41:19.637592 [debug] [Thread-1 (]: Began compiling node model.assignment_4.locations_qw
[0m22:41:19.642431 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.locations_qw"
[0m22:41:19.644126 [debug] [Thread-1 (]: Began executing node model.assignment_4.locations_qw
[0m22:41:19.649436 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.locations_qw"
[0m22:41:19.651221 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:41:19.651999 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: BEGIN
[0m22:41:19.652577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:19.670128 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:41:19.671152 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.locations_qw"
[0m22:41:19.672111 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:41:19.674575 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."locations_qw__dbt_tmp"
  
    as (
      SELECT
    TRIM(s."City") AS city,
    TRIM(s."State") AS state,
    TRIM(s."Region") AS region,
    TRIM(s."Country") AS country,
    COUNT(o."Order.ID") AS order_count
FROM "assignment_4"."main"."stg_locations" AS s
LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
WHERE
    TRIM(s."City") = 'Los Angeles' AND
    TRIM(s."State") = 'California' AND
    TRIM(s."Region") = 'West' AND
    TRIM(s."Country") = 'United States'
GROUP BY
    s."City",
    s."State",
    s."Region",
    s."Country"
ORDER BY
    order_count DESC
    );
  
  
[0m22:41:19.675413 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:41:19.676360 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: ROLLBACK
[0m22:41:19.690282 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.locations_qw'
[0m22:41:19.691025 [debug] [Thread-1 (]: On model.assignment_4.locations_qw: Close
[0m22:41:19.702335 [debug] [Thread-1 (]: Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:41:19.703259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002911565D4F0>]}
[0m22:41:19.704269 [error] [Thread-1 (]: 12 of 15 ERROR creating sql table model main.locations_qw ...................... [[31mERROR[0m in 0.07s]
[0m22:41:19.705433 [debug] [Thread-1 (]: Finished running node model.assignment_4.locations_qw
[0m22:41:19.706131 [debug] [Thread-1 (]: Began running node model.assignment_4.orders_qw
[0m22:41:19.707641 [info ] [Thread-1 (]: 13 of 15 START sql table model main.orders_qw .................................. [RUN]
[0m22:41:19.708520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.locations_qw, now model.assignment_4.orders_qw)
[0m22:41:19.709162 [debug] [Thread-1 (]: Began compiling node model.assignment_4.orders_qw
[0m22:41:19.718859 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.orders_qw"
[0m22:41:19.720521 [debug] [Thread-1 (]: Began executing node model.assignment_4.orders_qw
[0m22:41:19.725770 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.orders_qw"
[0m22:41:19.727523 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:41:19.728273 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: BEGIN
[0m22:41:19.728844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:19.746003 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:41:19.746742 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:41:19.747373 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."orders_qw__dbt_tmp"
  
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    order_priority,
    quantity,
    discount,
    sales,
    profit,
    market,
    region,
    weeknum,
    year
FROM "assignment_4"."main"."stg_orders"
ORDER BY order_date ASC
LIMIT 5
    );
  
  
[0m22:41:19.772933 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m22:41:19.777533 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:41:19.778235 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
alter table "assignment_4"."main"."orders_qw" rename to "orders_qw__dbt_backup"
[0m22:41:19.779842 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:19.786098 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:41:19.786891 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
alter table "assignment_4"."main"."orders_qw__dbt_tmp" rename to "orders_qw"
[0m22:41:19.788396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:19.791512 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: COMMIT
[0m22:41:19.792257 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:41:19.792910 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: COMMIT
[0m22:41:19.834540 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m22:41:19.838599 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.orders_qw"
[0m22:41:19.839288 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.orders_qw"} */
drop table if exists "assignment_4"."main"."orders_qw__dbt_backup" cascade
[0m22:41:19.846490 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:41:19.850235 [debug] [Thread-1 (]: On model.assignment_4.orders_qw: Close
[0m22:41:19.894908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910F70C6B0>]}
[0m22:41:19.896304 [info ] [Thread-1 (]: 13 of 15 OK created sql table model main.orders_qw ............................. [[32mOK[0m in 0.19s]
[0m22:41:19.897449 [debug] [Thread-1 (]: Finished running node model.assignment_4.orders_qw
[0m22:41:19.898363 [debug] [Thread-1 (]: Began running node model.assignment_4.products_qw
[0m22:41:19.899289 [info ] [Thread-1 (]: 14 of 15 START sql table model main.products_qw ................................ [RUN]
[0m22:41:19.900202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.orders_qw, now model.assignment_4.products_qw)
[0m22:41:19.900864 [debug] [Thread-1 (]: Began compiling node model.assignment_4.products_qw
[0m22:41:19.905061 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.products_qw"
[0m22:41:19.906899 [debug] [Thread-1 (]: Began executing node model.assignment_4.products_qw
[0m22:41:19.913605 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.products_qw"
[0m22:41:19.915509 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:41:19.916279 [debug] [Thread-1 (]: On model.assignment_4.products_qw: BEGIN
[0m22:41:19.916902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:19.933921 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:41:19.934660 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:41:19.935281 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."products_qw__dbt_tmp"
  
    as (
      SELECT
    "product_id" AS product_id,
    "product_name" AS product_name,
    "category" AS category,
    "sub_category" AS sub_category
FROM "assignment_4"."main"."stg_products"
WHERE "category" = 'Office Supplies'
    );
  
  
[0m22:41:19.989261 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m22:41:19.993900 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:41:19.994667 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */
alter table "assignment_4"."main"."products_qw" rename to "products_qw__dbt_backup"
[0m22:41:19.995956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:20.000592 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:41:20.001290 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */
alter table "assignment_4"."main"."products_qw__dbt_tmp" rename to "products_qw"
[0m22:41:20.002492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:41:20.006215 [debug] [Thread-1 (]: On model.assignment_4.products_qw: COMMIT
[0m22:41:20.006925 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:41:20.007513 [debug] [Thread-1 (]: On model.assignment_4.products_qw: COMMIT
[0m22:41:20.063712 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m22:41:20.068004 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.products_qw"
[0m22:41:20.068796 [debug] [Thread-1 (]: On model.assignment_4.products_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.products_qw"} */
drop table if exists "assignment_4"."main"."products_qw__dbt_backup" cascade
[0m22:41:20.072725 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:41:20.075384 [debug] [Thread-1 (]: On model.assignment_4.products_qw: Close
[0m22:41:20.155279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029115758D10>]}
[0m22:41:20.156495 [info ] [Thread-1 (]: 14 of 15 OK created sql table model main.products_qw ........................... [[32mOK[0m in 0.26s]
[0m22:41:20.157608 [debug] [Thread-1 (]: Finished running node model.assignment_4.products_qw
[0m22:41:20.158300 [debug] [Thread-1 (]: Began running node model.assignment_4.shipping_qw
[0m22:41:20.159234 [info ] [Thread-1 (]: 15 of 15 START sql table model main.shipping_qw ................................ [RUN]
[0m22:41:20.160066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment_4.products_qw, now model.assignment_4.shipping_qw)
[0m22:41:20.160760 [debug] [Thread-1 (]: Began compiling node model.assignment_4.shipping_qw
[0m22:41:20.165411 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.shipping_qw"
[0m22:41:20.167194 [debug] [Thread-1 (]: Began executing node model.assignment_4.shipping_qw
[0m22:41:20.173235 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.shipping_qw"
[0m22:41:20.175131 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.shipping_qw"
[0m22:41:20.175888 [debug] [Thread-1 (]: On model.assignment_4.shipping_qw: BEGIN
[0m22:41:20.176473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:20.193576 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:41:20.194318 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.shipping_qw"
[0m22:41:20.194967 [debug] [Thread-1 (]: On model.assignment_4.shipping_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.shipping_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."shipping_qw__dbt_tmp"
  
    as (
      SELECT
    o."Order.ID",
    s."Ship.Date",
    s."Ship.Mode",
    s."Shipping.Cost"
FROM "assignment_4"."main"."stg_shipping" AS s
LEFT JOIN "assignment_4"."main"."stg_orders" AS o ON s."Order.ID" = o."Order.ID"
ORDER BY s."Shipping.Cost" DESC
LIMIT 5
    );
  
  
[0m22:41:20.196956 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.shipping_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."shipping_qw__dbt_tmp"
  
    as (
      SELECT
    o."Order.ID",
    s."Ship.Date",
    s."Ship.Mode",
    s."Shipping.Cost"
FROM "assignment_4"."main"."stg_shipping" AS s
LEFT JOIN "assignment_4"."main"."stg_orders" AS o ON s."Order.ID" = o."Order.ID"
ORDER BY s."Shipping.Cost" DESC
LIMIT 5
    );
  
  
[0m22:41:20.197671 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:41:20.198423 [debug] [Thread-1 (]: On model.assignment_4.shipping_qw: ROLLBACK
[0m22:41:20.206913 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.shipping_qw'
[0m22:41:20.207637 [debug] [Thread-1 (]: On model.assignment_4.shipping_qw: Close
[0m22:41:20.218286 [debug] [Thread-1 (]: Runtime Error in model shipping_qw (models\marts\shipping_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 17: ...t", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.shipping_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."shipping_qw__dbt_tmp"
    
      as (
        SELECT
      o."Order.ID",
      s."Ship.Date",
      s."Ship.Mode",
      s."Shipping.Cost"
  FROM "assignment_4"."main"."stg_shipping" AS s
  LEFT JOIN "assignment_4"."main"."stg_orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:41:20.219168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d54db21-be93-49f0-9af3-c053b6803978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910F70C6B0>]}
[0m22:41:20.220167 [error] [Thread-1 (]: 15 of 15 ERROR creating sql table model main.shipping_qw ....................... [[31mERROR[0m in 0.06s]
[0m22:41:20.221424 [debug] [Thread-1 (]: Finished running node model.assignment_4.shipping_qw
[0m22:41:20.223658 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:20.224295 [debug] [MainThread]: On master: BEGIN
[0m22:41:20.225067 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:41:20.241966 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m22:41:20.242665 [debug] [MainThread]: On master: COMMIT
[0m22:41:20.243169 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:20.243654 [debug] [MainThread]: On master: COMMIT
[0m22:41:20.244535 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:41:20.245084 [debug] [MainThread]: On master: Close
[0m22:41:20.248599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:20.249198 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m22:41:20.249672 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m22:41:20.250095 [debug] [MainThread]: Connection 'model.assignment_4.shipping_qw' was properly closed.
[0m22:41:20.250793 [info ] [MainThread]: 
[0m22:41:20.251387 [info ] [MainThread]: Finished running 5 seeds, 5 view models, 5 table models in 0 hours 0 minutes and 11.32 seconds (11.32s).
[0m22:41:20.257315 [debug] [MainThread]: Command end result
[0m22:41:20.313397 [info ] [MainThread]: 
[0m22:41:20.314213 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:41:20.314789 [info ] [MainThread]: 
[0m22:41:20.315528 [error] [MainThread]:   Runtime Error in model locations_qw (models\marts\locations_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 18: ... "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.locations_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."locations_qw__dbt_tmp"
    
      as (
        SELECT
      TRIM(s."City") AS city,
      TRIM(s."State") AS state,
      TRIM(s."Region") AS region,
      TRIM(s."Country") AS country,
      COUNT(o."Order.ID") AS order_count
  FROM "assignment_4"."main"."stg_locations" AS s
  LEFT JOIN "assignment_4"."main"."orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:41:20.316176 [info ] [MainThread]: 
[0m22:41:20.316886 [error] [MainThread]:   Runtime Error in model shipping_qw (models\marts\shipping_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 17: ...t", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.shipping_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."shipping_qw__dbt_tmp"
    
      as (
        SELECT
      o."Order.ID",
      s."Ship.Date",
      s."Ship.Mode",
      s."Shipping.Cost"
  FROM "assignment_4"."main"."stg_shipping" AS s
  LEFT JOIN "assignment_4"."main"."stg_orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:41:20.317537 [info ] [MainThread]: 
[0m22:41:20.318111 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=2 SKIP=0 TOTAL=15
[0m22:41:20.320216 [debug] [MainThread]: Command `dbt build` failed at 22:41:20.319800 after 12.97 seconds
[0m22:41:20.320960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910EE9DEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910AFF6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910DCE6FF0>]}
[0m22:41:20.321573 [debug] [MainThread]: Flushing usage events
[0m22:41:46.630277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D293C4EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2966A8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2966A8410>]}


============================== 22:41:46.636719 | d41a1fdd-868c-4b9e-b975-8bda11f27d85 ==============================
[0m22:41:46.636719 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:41:46.638123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\acer\\PycharmProjects\\pythonProject3\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select shipping_qw', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:41:47.022737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd41a1fdd-868c-4b9e-b975-8bda11f27d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D297AB0510>]}
[0m22:41:47.124493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd41a1fdd-868c-4b9e-b975-8bda11f27d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D296657F00>]}
[0m22:41:47.131837 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:41:47.148527 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:41:47.395510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:41:47.396150 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:41:47.463923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd41a1fdd-868c-4b9e-b975-8bda11f27d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D29688C950>]}
[0m22:41:47.632430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd41a1fdd-868c-4b9e-b975-8bda11f27d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D297CA0410>]}
[0m22:41:47.633370 [info ] [MainThread]: Found 5 seeds, 10 models, 421 macros
[0m22:41:47.634272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd41a1fdd-868c-4b9e-b975-8bda11f27d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2968ECE50>]}
[0m22:41:47.637323 [info ] [MainThread]: 
[0m22:41:47.638629 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:41:47.640259 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4'
[0m22:41:47.802516 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4"
[0m22:41:47.803207 [debug] [ThreadPool]: On list_assignment_4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"assignment_4"'
    
  
  
[0m22:41:47.803727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:47.825179 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m22:41:47.827503 [debug] [ThreadPool]: On list_assignment_4: Close
[0m22:41:47.832029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_assignment_4, now create_assignment_4_main)
[0m22:41:47.833452 [debug] [ThreadPool]: Creating schema "database: "assignment_4"
schema: "main"
"
[0m22:41:47.845097 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:41:47.845764 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='assignment_4'
        and type='sqlite'
    
  
[0m22:41:47.846272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:47.863435 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:41:47.866583 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:41:47.867177 [debug] [ThreadPool]: On create_assignment_4_main: BEGIN
[0m22:41:47.868058 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:41:47.868585 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:41:47.869075 [debug] [ThreadPool]: On create_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "create_assignment_4_main"} */

    
    
        create schema if not exists "assignment_4"."main"
    
[0m22:41:47.869983 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:41:47.871487 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:41:47.872024 [debug] [ThreadPool]: Using duckdb connection "create_assignment_4_main"
[0m22:41:47.872506 [debug] [ThreadPool]: On create_assignment_4_main: COMMIT
[0m22:41:47.873320 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:41:47.873869 [debug] [ThreadPool]: On create_assignment_4_main: Close
[0m22:41:47.887553 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_assignment_4_main'
[0m22:41:47.897642 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:41:47.898299 [debug] [ThreadPool]: On list_assignment_4_main: BEGIN
[0m22:41:47.898780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:47.915348 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m22:41:47.916006 [debug] [ThreadPool]: Using duckdb connection "list_assignment_4_main"
[0m22:41:47.916535 [debug] [ThreadPool]: On list_assignment_4_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "connection_name": "list_assignment_4_main"} */
select
      'assignment_4' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'assignment_4'
  
[0m22:41:47.990225 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m22:41:47.993198 [debug] [ThreadPool]: On list_assignment_4_main: ROLLBACK
[0m22:41:47.995725 [debug] [ThreadPool]: Failed to rollback 'list_assignment_4_main'
[0m22:41:47.996324 [debug] [ThreadPool]: On list_assignment_4_main: Close
[0m22:41:48.005532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd41a1fdd-868c-4b9e-b975-8bda11f27d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D297E9B2B0>]}
[0m22:41:48.006312 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.006814 [debug] [MainThread]: On master: BEGIN
[0m22:41:48.007286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:41:48.024034 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m22:41:48.024700 [debug] [MainThread]: On master: COMMIT
[0m22:41:48.025196 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.025675 [debug] [MainThread]: On master: COMMIT
[0m22:41:48.026444 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:41:48.026988 [debug] [MainThread]: On master: Close
[0m22:41:48.030884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:41:48.031851 [info ] [MainThread]: 
[0m22:41:48.037646 [debug] [Thread-1 (]: Began running node model.assignment_4.shipping_qw
[0m22:41:48.038609 [info ] [Thread-1 (]: 1 of 1 START sql table model main.shipping_qw .................................. [RUN]
[0m22:41:48.039815 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment_4.shipping_qw'
[0m22:41:48.040468 [debug] [Thread-1 (]: Began compiling node model.assignment_4.shipping_qw
[0m22:41:48.056532 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment_4.shipping_qw"
[0m22:41:48.059454 [debug] [Thread-1 (]: Began executing node model.assignment_4.shipping_qw
[0m22:41:48.130690 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment_4.shipping_qw"
[0m22:41:48.132702 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.shipping_qw"
[0m22:41:48.133700 [debug] [Thread-1 (]: On model.assignment_4.shipping_qw: BEGIN
[0m22:41:48.134481 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:41:48.151409 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:41:48.152152 [debug] [Thread-1 (]: Using duckdb connection "model.assignment_4.shipping_qw"
[0m22:41:48.152778 [debug] [Thread-1 (]: On model.assignment_4.shipping_qw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.shipping_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."shipping_qw__dbt_tmp"
  
    as (
      SELECT
    o."Order.ID",
    s."Ship.Date",
    s."Ship.Mode",
    s."Shipping.Cost"
FROM "assignment_4"."main"."stg_shipping" AS s
LEFT JOIN "assignment_4"."main"."stg_orders" AS o ON s."Order.ID" = o."Order.ID"
ORDER BY s."Shipping.Cost" DESC
LIMIT 5
    );
  
  
[0m22:41:48.154902 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.shipping_qw"} */

  
    
    

    create  table
      "assignment_4"."main"."shipping_qw__dbt_tmp"
  
    as (
      SELECT
    o."Order.ID",
    s."Ship.Date",
    s."Ship.Mode",
    s."Shipping.Cost"
FROM "assignment_4"."main"."stg_shipping" AS s
LEFT JOIN "assignment_4"."main"."stg_orders" AS o ON s."Order.ID" = o."Order.ID"
ORDER BY s."Shipping.Cost" DESC
LIMIT 5
    );
  
  
[0m22:41:48.155613 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:41:48.156377 [debug] [Thread-1 (]: On model.assignment_4.shipping_qw: ROLLBACK
[0m22:41:48.169891 [debug] [Thread-1 (]: Failed to rollback 'model.assignment_4.shipping_qw'
[0m22:41:48.170636 [debug] [Thread-1 (]: On model.assignment_4.shipping_qw: Close
[0m22:41:48.182696 [debug] [Thread-1 (]: Runtime Error in model shipping_qw (models\marts\shipping_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 17: ...t", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.shipping_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."shipping_qw__dbt_tmp"
    
      as (
        SELECT
      o."Order.ID",
      s."Ship.Date",
      s."Ship.Mode",
      s."Shipping.Cost"
  FROM "assignment_4"."main"."stg_shipping" AS s
  LEFT JOIN "assignment_4"."main"."stg_orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:41:48.185192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd41a1fdd-868c-4b9e-b975-8bda11f27d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D297EF50D0>]}
[0m22:41:48.186282 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.shipping_qw ......................... [[31mERROR[0m in 0.14s]
[0m22:41:48.188279 [debug] [Thread-1 (]: Finished running node model.assignment_4.shipping_qw
[0m22:41:48.191664 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.192510 [debug] [MainThread]: On master: BEGIN
[0m22:41:48.192999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:41:48.209415 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m22:41:48.210864 [debug] [MainThread]: On master: COMMIT
[0m22:41:48.211737 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.212521 [debug] [MainThread]: On master: COMMIT
[0m22:41:48.213919 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:41:48.214883 [debug] [MainThread]: On master: Close
[0m22:41:48.218798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:48.219432 [debug] [MainThread]: Connection 'create_assignment_4_main' was properly closed.
[0m22:41:48.219898 [debug] [MainThread]: Connection 'list_assignment_4_main' was properly closed.
[0m22:41:48.220336 [debug] [MainThread]: Connection 'model.assignment_4.shipping_qw' was properly closed.
[0m22:41:48.220889 [info ] [MainThread]: 
[0m22:41:48.221835 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m22:41:48.223746 [debug] [MainThread]: Command end result
[0m22:41:48.278659 [info ] [MainThread]: 
[0m22:41:48.280345 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:41:48.281566 [info ] [MainThread]: 
[0m22:41:48.282661 [error] [MainThread]:   Runtime Error in model shipping_qw (models\marts\shipping_qw.sql)
  Binder Error: Values list "s" does not have a column named "Order.ID"
  LINE 17: ...t", "dbt_version": "1.8.0", "profile_name": "assignment_4", "target_name": "dev", "node_id": "model.assignment_4.shipping_qw"} */
  
    
      
      
  
      create  table
        "assignment_4"."main"."shipping_qw__dbt_tmp"
    
      as (
        SELECT
      o."Order.ID",
      s."Ship.Date",
      s."Ship.Mode",
      s."Shipping.Cost"
  FROM "assignment_4"."main"."stg_shipping" AS s
  LEFT JOIN "assignment_4"."main"."stg_orders" AS o ON s."Order.ID" = o."Order.ID"
                                                     ^
[0m22:41:48.283864 [info ] [MainThread]: 
[0m22:41:48.284745 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:41:48.286712 [debug] [MainThread]: Command `dbt run` failed at 22:41:48.286431 after 1.85 seconds
[0m22:41:48.287385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D297CFF280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D297FA6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D298000FF0>]}
[0m22:41:48.288011 [debug] [MainThread]: Flushing usage events
